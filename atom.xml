<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Ctrl + Cmd]]></title>
  <link href="http://goooseman.ru/atom.xml" rel="self"/>
  <link href="http://goooseman.ru/"/>
  <updated>2014-03-05T19:39:57+04:00</updated>
  <id>http://goooseman.ru/</id>
  <author>
    <name><![CDATA[goooseman]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Это ж гениально!]]></title>
    <link href="http://goooseman.ru/2014/03/05/eto-zh-ghienialno/"/>
    <updated>2014-03-05T19:34:00+04:00</updated>
    <id>http://goooseman.ru/2014/03/05/eto-zh-ghienialno</id>
    <content type="html"><![CDATA[<iframe src="http://goooseman.ru//player.vimeo.com/video/88073857" width="500" height="333" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>


<p>Блять, это же гениально! Клип из айфоновских смайликов Emoji!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deploy приложения на RoR 4 с помощью Capistrano 3]]></title>
    <link href="http://goooseman.ru/2014/03/05/deploy-prilozhieniia-na-ror-4-s-pomoshchiu-capistrano-3/"/>
    <updated>2014-03-05T13:57:00+04:00</updated>
    <id>http://goooseman.ru/2014/03/05/deploy-prilozhieniia-na-ror-4-s-pomoshchiu-capistrano-3</id>
    <content type="html"><![CDATA[<p class="text-muted" markdown='1'>
    Кросспост <a href="http://habrahabr.ru/post/213269/">моей записи на хабре</a>
</p>


<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/0a6/3aa/2f6/0a63aa2f640920d345e0d82d27fe3466.jpg" title="Capistrano" alt="Capistrano"></p>

<p>Представьте: Вы — веб-разработчик, который только недавно освоил Ruby on
Rails. И тут Ваш первый проект подходит к стадии, когда его нужно
выложить в интернет.
Вы, конечно, можете залить его на Heroku, но тамошние цены немного
кусаются. Остается только купить VPS, настроить его и выложить проект
туда.
«Что может быть проще? Найду какой-нибудь гайд, да следаю всё по нему» —
подумаете Вы. Вот только гайдов, которые не просто выкладывают команды,
но и объясняющие, что эти команды делают, — единицы, да и те используют
уже устаревшую вторую версию Capistrano.</p>

<p>Поэтому я решил написать свой гайд, в котором постараюсь подробно
рассмотреть:</p>

<ul>
<li>Первичную настройку сервера</li>
<li>Установку и настройку nginx (с модулем PageSpeed), postgresql, redis</li>
<li>Установку rvm, rails</li>
<li>Настройку гема foreman для управления процессами Вашего приложения</li>
<li>Настройку сервера Unicorn</li>
<li>Настройку гема Capistrano (v3.1) для автоматизации деплоя</li>
</ul>


<p>Я надеюсь, что этот гайд будет полезен не только новичкам, но и
разработчикам со стажем.</p>

<!--more-->


<h4>Первичная настройка сервера</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/2d0/6b4/21c/2d06b421c7b265808e7d2c24f4624065.jpg" title="Первичная настройка сервера" alt="Первичная настройка сервера"></p>

<p>Вы купили свой первый VPS, установили ОС (я использую ubuntu 12.04 LTS и
все команды буду выкладывать именно под неё), зашли по SSH. Что делать
дальше?</p>

<p>Первым делом сменим пароль для пользователя root коммандой <code>passwd</code></p>

<p>Создадим нового пользователя: <code>adduser deployer</code></p>

<p>Разрешим ему пользоваться коммандой sudo: <code>visudo</code></p>

<p>и дописываем: <code>deployer ALL=(ALL:ALL) ALL</code></p>

<p>Изменим настройки ssh сервера (запретим логин под root, доступ по
доменному имени и разрешим логин только под нашим новым пользователем).
Добавляем в файл &lsquo;/etc/ssh/sshd_config&rsquo;:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PermitRootLogin no UseDNS no AllowUsers deployer</span></code></pre></td></tr></table></div></figure>


<p>Перезапустим ssh сервер коммандой: <code>reload ssh</code></p>

<p>Чтобы не вводить каждый раз пароль при подключении по ssh, нам надо
скопировать ssh ключ с Вашей машины на сервер. Самый простой способ
сделать это — выполнить на локальной машине <code>ssh-copy-id deployer@123.123.123.123</code></p>

<p>(На маке требуется установка ssh-copy-id, сделать можно через brew, на
Windows не знаю автоматизированного средства для копирования ключей, но
в интернете есть много интересного на эту тему).</p>

<p>Так же, пока уж мы под рутом, можно создать SWAP файл, если у Вас мало
RAM. Делается это так: <code>dd if=/dev/zero of=/swapfile bs=1024 count=512k mkswap /swapfile swapon /swapfile</code></p>

<p>Далее в файле &lsquo;/etc/fstab&rsquo; добавляем строчку: <code>/swapfile none swap sw 0 0</code></p>

<p>И далее выполняем: <code>echo 0 &gt; /proc/sys/vm/swappiness sudo chown root:root /swapfile sudo chmod 0600 /swapfile</code></p>

<p>Можно перезагрузиться и проверить наличие SWAP файла коммандой <code>swapon -s</code></p>

<h4>Установка и настройка nginx</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/541/7a6/785/5417a67857580be18180dbb0d30a1384.png" title="nginx" alt="nginx"></p>

<p>На этот раз логинемся под нашим новым пользователем коммандой <code>ssh deployer@123.123.123.123</code> (на локальном компьютере).</p>

<p>Лично я использую модуль PageSpeed, поэтому nginx собираю сам. Но
сначала нам надо обновить репозитории, обновить систему, и скачать
необходимые для успешной сборки пакеты:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get dist-upgrade
</span><span class='line'>sudo apt-get install build-essential zlib1g-dev libpcre3 libpcre3-dev unzip
</span></code></pre></td></tr></table></div></figure>


<p>Теперь собираем:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget https://github.com/pagespeed/ngx_pagespeed/archive/v1.7.30.1-beta.zip
</span><span class='line'>unzip v1.7.30.1-beta.zip
</span><span class='line'><span class="nb">cd </span>ngx_pagespeed-1.7.30.1-beta
</span><span class='line'>wget https://dl.google.com/dl/page-speed/psol/1.7.30.1.tar.gz
</span><span class='line'>tar -xzvf 1.7.30.1.tar.gz
</span><span class='line'>wget http://nginx.org/download/nginx-1.4.4.tar.gz
</span><span class='line'>tar -xzvf nginx-1.4.4.tar.gz
</span><span class='line'><span class="nb">cd </span>nginx-1.4.4
</span><span class='line'>./configure --add-module<span class="o">=</span><span class="nv">$HOME</span>/ngx_pagespeed-1.7.30.1-beta
</span><span class='line'>make
</span><span class='line'>sudo checkinstall
</span></code></pre></td></tr></table></div></figure>


<p>Для управления nginx напишем <a href="http://upstart.ubuntu.com/">upstart</a>
скрипт. Создаём файл &lsquo;/etc/init/nginx.conf&rsquo; со следующим содержимым:</p>

<figure class='code'><figcaption><span>etc/init/nginx.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>description <span class="s2">&quot;nginx http daemon&quot;</span>
</span><span class='line'>author <span class="s2">&quot;George Shammas &lt;georgyo@gmail.com&gt;&quot;</span>
</span><span class='line'>
</span><span class='line'>start on <span class="o">(</span>filesystem and net-device-up <span class="nv">IFACE</span><span class="o">=</span>lo<span class="o">)</span>
</span><span class='line'>stop on runlevel <span class="o">[</span>!2345<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>env <span class="nv">DAEMON</span><span class="o">=</span>/usr/local/nginx/sbin/nginx
</span><span class='line'>env <span class="nv">PID</span><span class="o">=</span>/var/run/nginx.pid
</span><span class='line'>
</span><span class='line'>expect fork
</span><span class='line'>respawn
</span><span class='line'>respawn limit 10 5
</span><span class='line'><span class="c">#oom never</span>
</span><span class='line'>
</span><span class='line'>pre-start script
</span><span class='line'>        <span class="nv">$DAEMON</span> -t
</span><span class='line'>        <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span>
</span><span class='line'>                <span class="k">then </span><span class="nb">exit</span> <span class="nv">$?</span>
</span><span class='line'>        <span class="k">fi</span>
</span><span class='line'>end script
</span><span class='line'>
</span><span class='line'><span class="nb">exec</span> <span class="nv">$DAEMON</span>
</span></code></pre></td></tr></table></div></figure>


<p>Теперь вы можете выполнять <code>sudo start/stop/restart/status nginx</code></p>

<p>Наш nginx.conf лежит по адресу &lsquo;/usr/local/nginx/conf/nginx.conf&rsquo;, но
пока мы его трогать не будем. Мы его зальем автоматически при первом
деплое приложения.</p>

<p>Для наших веб приложений мы создадим нового пользователя и новую группу,
добавим себя в эту группу, и создадим папку:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo useradd -s /sbin/nologin -r nginx
</span><span class='line'>sudo groupadd web
</span><span class='line'>sudo usermod -a -G web nginx
</span><span class='line'>sudo usermod -a -G web deployer
</span><span class='line'>sudo mkdir /var/www
</span><span class='line'>sudo chgrp -R web /var/www
</span><span class='line'>sudo chmod -R 775 /var/www
</span></code></pre></td></tr></table></div></figure>


<p>Для того, чтобы мы смогли писать в папку придется разлогиниться и зайти
снова под нашим пользователем.</p>

<h4>Установка и настройка PostgreSQL</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/c46/490/b80/c46490b8070528ded4adc5ddd2d2e480.png" title="PostgreSQL" alt="PostgreSQL"></p>

<p>В репозиториях ubuntu лежит устаревшая версия, так что мы добавим
сторонний репо. В файл &lsquo;/etc/apt/sources.list.d/pgdg.list&rsquo; добавим: <code> deb http://apt.postgresql.org/pub/repos/apt/ precise-pgdg main</code></p>

<p>Затем добавляем ключ репозитория и устанавливаем PostgreSQL:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget --quiet -O - http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc | sudo apt-key add -
</span><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install postgresql-9.3 postgresql-server-dev-9.3
</span></code></pre></td></tr></table></div></figure>


<p>И создаем нового пользователя:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo -u postgres psql
</span><span class='line'>
</span><span class='line'>create user deployer with password <span class="s1">&#39;ваш пароль&#39;</span>;
</span><span class='line'>alter role deployer superuser createrole createdb replication;
</span><span class='line'>
</span><span class='line'><span class="se">\q</span>
</span></code></pre></td></tr></table></div></figure>


<p>Чтобы иметь доступ с локального компьютера в файле
&lsquo;/etc/postgresql/9.3/main/postgresql.conf&rsquo; изменим параметр
<code>listen_addresses = 'localhost'</code>на <code>listen_addresses = '*'</code>и добавим в
файл &lsquo;/etc/postgresql/9.3/main/pg_hba.conf&rsquo; строчку</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>host all deployer ваш.внешний.ip.адрес 255.255.255.0 md5
</span></code></pre></td></tr></table></div></figure>


<p>Перезагружаем postgresql коммандой <code>sudo service postgresql restart</code></p>

<h4>Установка и настройка Redis</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/f4e/5dc/854/f4e5dc8543844123d64fb68139951e31.png" title="Redis" alt="Redis"></p>

<p>Если Вы используте gem <a href="https://github.com/resque/resque">resque</a>, то
Вам нужно установить Redis. Ибо в репозитории устаревшая версия, я его
собираю из исходников, к тому же это занимает немного времени:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get install tcl8.5
</span><span class='line'>wget http://download.redis.io/redis-stable.tar.gz
</span><span class='line'>tar xvzf redis-stable.tar.gz
</span><span class='line'><span class="nb">cd </span>redis-stable
</span><span class='line'>make
</span><span class='line'>make <span class="nb">test</span>
</span><span class='line'>sudo cp src/redis-server /usr/local/bin
</span><span class='line'>sudo cp src/redis-cli /usr/local/bin
</span></code></pre></td></tr></table></div></figure>


<p>Redis по умолчанию не защищен паролем и открыт всем, поэтому поставим
пароль: в файле &lsquo;redis.conf&rsquo; добавляем параметр <code>requirepass</code>с нашим
паролем. Redis легко брутфорсится, поэтому я делаю пароль не менее 100
символов. Также, чтобы потом не вылетало ошибок, меняем параметр <code>dir</code>на
<code>/var/www/other</code>, предварительно создав такую папку (
<code>mkdir /var/www/other</code>).
Копируем наш конфиг командой <code>sudo cp redis.conf /etc/redis/redis.conf</code></p>

<p>Создаем upstart скрипт по адресу &lsquo;/etc/init/redis-server.conf&rsquo; со
следующим содержанием:</p>

<figure class='code'><figcaption><span>/etc/init/redis-server.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!upstart</span>
</span><span class='line'>description <span class="s2">&quot;Redis Server&quot;</span>
</span><span class='line'>
</span><span class='line'>env <span class="nv">USER</span><span class="o">=</span>deployer
</span><span class='line'>
</span><span class='line'>start on runlevel <span class="o">[</span>2345<span class="o">]</span>
</span><span class='line'>stop on runlevel <span class="o">[</span>016<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>respawn
</span><span class='line'><span class="nb">exec </span>start-stop-daemon --start --make-pidfile --pidfile /var/run/redis-server.pid --chuid <span class="nv">$USER</span> --exec /usr/local/bin/redis-server /etc/redis/redis.conf &gt;&gt; /var/www/log/redis.log 2&gt;&amp;1
</span></code></pre></td></tr></table></div></figure>


<p>Теперь мы можем управлять Redisом коммандами <code>sudo start/stop/restart/status redis-server</code>, предварительно создав папку для логов ( <code>mkdir /var/www/log</code>).</p>

<h4>Установка RVM, Ruby, Rails, Bundler</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/fd7/5bf/168/fd75bf168d048c419cf083bad58c8e51.png" title="Ruby on Rails" alt="Ruby on Rails"></p>

<p>Тут совсем ничего сложного:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get install git curl python-software-properties
</span><span class='line'>
</span><span class='line'>sudo add-apt-repository ppa:chris-lea/node.js
</span><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install nodejs
</span><span class='line'>
</span><span class='line'>curl -L get.rvm.io | bash -s stable
</span><span class='line'><span class="nb">source</span> ~/.rvm/scripts/rvm
</span><span class='line'>rvm requirements
</span><span class='line'>
</span><span class='line'>rvm install 2.0.0
</span><span class='line'>rvm use 2.0.0 --default
</span><span class='line'>gem install rails --no-ri --no-rdoc
</span><span class='line'>gem install bundler
</span></code></pre></td></tr></table></div></figure>


<h4>Создаем репозиторий на GitHub/BitBucket</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/3d1/b5c/563/3d1b5c56357a4371884a9d1b1a94ac13.png" title="Git" alt="Git"></p>

<p>Мы будем использовать git на удаленном сервере для деплоя нашего
приложения. Можно и настроить git сервер на нашем VPS, но зачем, если
есть удобные бесплатные решения. Итак, создаем репозиторий на
GitHub/BitBucket (у BitBucket приватные репозитории бесплатны), но не
спешим заливать туда наш проект, сначала отредактируем .gitignore файл
(он находится в корне приложения), чтобы в репо не попала никакая
конфидициальная информация (особенно это важно, если репо публичный), да
и заодно лишние файлы нам там не нужны:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>/config/database.yml <span class="c"># доступ к базе данным</span>
</span><span class='line'>/Procfile <span class="c"># про него я еще расскажу</span>
</span><span class='line'>/config/deploy/ <span class="c"># файлы Capistrano</span>
</span><span class='line'>/shared/ <span class="c"># файлы, которых нет в репозитории, но они будут скопированы на сервер при первом деплое приложения</span>
</span><span class='line'>/public/system/ <span class="c"># если установлен Paperclip</span>
</span></code></pre></td></tr></table></div></figure>


<p>Теперь можно сделать первый коммит и запушить проект в git.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git init git remote add origin <span class="c">#АДРЕС РЕПО git add -A git commit -m &#39;first commit&#39; git push -u origin --all</span>
</span></code></pre></td></tr></table></div></figure>


<p>Также нам надо добавить ключ нашего сервера в админку Github/BitBucket,
это обязательное условие, т.к. из репозитория изменения будут
загружаться на сервер. Как это сделать можно узнать в Helpе сервиса.</p>

<h4>gem foreman</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/26d/932/db9/26d932db99bae73a60f9cdfdb865dcb4.jpg" title="Доктор Форман из сериала Доктор Хаус" alt="Доктор Форман из сериала Доктор Хаус"></p>

<p><a href="https://github.com/ddollar/foreman">foreman</a> — гем для управления
процессами приложения. На локальной машине он позволяет запускать сразу
все процессы, указанные в Procfile, одной коммандой <code>foreman start</code> и показывает их вывод.</p>

<p>На сервере командой <code>foreman export upstart</code> он создает upstart скрипт для легкого управления приложением с помощью
команд start/stop/restart. Но об этом потом. Пока просто установим его,
создадим Procfile в корне приложения, и наполним его для локального
использования. У меня он выглядит так.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>web: rails s
</span><span class='line'>job1: bundle <span class="nb">exec </span>rake resque:work <span class="nv">PIDFILE</span><span class="o">=</span>./tmp/pids/resque2.pid <span class="nv">QUEUES</span><span class="o">=</span>send_email
</span><span class='line'>job2: bundle <span class="nb">exec </span>rake resque:work <span class="nv">PIDFILE</span><span class="o">=</span>./tmp/pids/resque2.pid <span class="nv">QUEUES</span><span class="o">=</span>send_email
</span></code></pre></td></tr></table></div></figure>


<p>Production конфигурацию мы напишем потом, когда речь зайдет о
Capistrano.</p>

<h4>Устанавливаем Unicorn</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/01b/a1f/26f/01ba1f26f0eeecd3cfe3380416bff98b.png" title="Unicorn" alt="Unicorn"></p>

<p><a href="https://github.com/defunkt/unicorn">Unicorn</a> — продвинутый HTTP
сервер. Установим его, добавив <code>group :production do gem 'unicorn' end</code> в Gemfile. (Не забудьте про <code>bundle install</code>)</p>

<p>В папке &lsquo;/config/&rsquo; создаем файл unicon.rb c примерно таким содержимым:</p>

<figure class='code'><figcaption><span>unicorn.rb </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">worker_processes</span> <span class="mi">2</span>
</span><span class='line'>
</span><span class='line'><span class="n">working_directory</span> <span class="s2">&quot;/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/current&quot;</span> <span class="c1"># available in 0.94.0+</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># listen on both a Unix domain socket and a TCP port,</span>
</span><span class='line'><span class="c1"># we use a shorter backlog for quicker failover when busy</span>
</span><span class='line'><span class="n">listen</span> <span class="s2">&quot;/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/socket/.unicorn.sock&quot;</span><span class="p">,</span> <span class="ss">:backlog</span> <span class="o">=&gt;</span> <span class="mi">64</span>
</span><span class='line'><span class="n">listen</span> <span class="mi">8080</span><span class="p">,</span> <span class="ss">:tcp_nopush</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># nuke workers after 30 seconds instead of 60 seconds (the default)</span>
</span><span class='line'><span class="n">timeout</span> <span class="mi">30</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># feel free to point this anywhere accessible on the filesystem</span>
</span><span class='line'><span class="n">pid</span> <span class="s2">&quot;/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/run/unicorn.pid&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># By default, the Unicorn logger will write to stderr.</span>
</span><span class='line'><span class="c1"># Additionally, ome applications/frameworks log to stderr or stdout,</span>
</span><span class='line'><span class="c1"># so prevent them from going to /dev/null when daemonized here:</span>
</span><span class='line'><span class="n">stderr_path</span> <span class="s2">&quot;/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/log/unicorn.stderr.log&quot;</span>
</span><span class='line'><span class="n">stdout_path</span> <span class="s2">&quot;/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/log/unicorn.stdout.log&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># combine Ruby 2.0.0dev or REE with &quot;preload_app true&quot; for memory savings</span>
</span><span class='line'><span class="c1"># http://rubyenterpriseedition.com/faq.html#adapt_apps_for_cow</span>
</span><span class='line'><span class="n">preload_app</span> <span class="kp">true</span>
</span><span class='line'><span class="no">GC</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="ss">:copy_on_write_friendly</span><span class="o">=</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>  <span class="no">GC</span><span class="o">.</span><span class="n">copy_on_write_friendly</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Enable this flag to have unicorn test client connections by writing the</span>
</span><span class='line'><span class="c1"># beginning of the HTTP headers before calling the application.  This</span>
</span><span class='line'><span class="c1"># prevents calling the application for connections that have disconnected</span>
</span><span class='line'><span class="c1"># while queued.  This is only guaranteed to detect clients on the same</span>
</span><span class='line'><span class="c1"># host unicorn runs on, and unlikely to detect disconnects even on a</span>
</span><span class='line'><span class="c1"># fast LAN.</span>
</span><span class='line'><span class="n">check_client_connection</span> <span class="kp">false</span>
</span><span class='line'>
</span><span class='line'><span class="n">before_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># the following is highly recomended for Rails + &quot;preload_app true&quot;</span>
</span><span class='line'>  <span class="c1"># as there&#39;s no need for the master process to hold a connection</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">defined?</span><span class="p">(</span><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>    <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">disconnect!</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># The following is only recommended for memory/DB-constrained</span>
</span><span class='line'>  <span class="c1"># installations.  It is not needed if your system can house</span>
</span><span class='line'>  <span class="c1"># twice as many worker_processes as you have configured.</span>
</span><span class='line'>  <span class="c1">#</span>
</span><span class='line'>  <span class="c1"># # This allows a new master process to incrementally</span>
</span><span class='line'>  <span class="c1"># # phase out the old master process with SIGTTOU to avoid a</span>
</span><span class='line'>  <span class="c1"># # thundering herd (especially in the &quot;preload_app false&quot; case)</span>
</span><span class='line'>  <span class="c1"># # when doing a transparent upgrade.  The last worker spawned</span>
</span><span class='line'>  <span class="c1"># # will then kill off the old master process with a SIGQUIT.</span>
</span><span class='line'>  <span class="n">old_pid</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">server</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="ss">:pid</span><span class="o">]</span><span class="si">}</span><span class="s2">.oldbin&quot;</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">old_pid</span> <span class="o">!=</span> <span class="n">server</span><span class="o">.</span><span class="n">pid</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">nr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">server</span><span class="o">.</span><span class="n">worker_processes</span> <span class="p">?</span> <span class="ss">:QUIT</span> <span class="p">:</span> <span class="ss">:TTOU</span>
</span><span class='line'>      <span class="no">Process</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">old_pid</span><span class="p">)</span><span class="o">.</span><span class="n">to_i</span><span class="p">)</span>
</span><span class='line'>    <span class="k">rescue</span> <span class="ss">Errno</span><span class="p">:</span><span class="ss">:ENOENT</span><span class="p">,</span> <span class="ss">Errno</span><span class="p">:</span><span class="ss">:ESRCH</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1">#</span>
</span><span class='line'>  <span class="c1"># Throttle the master from forking too quickly by sleeping.  Due</span>
</span><span class='line'>  <span class="c1"># to the implementation of standard Unix signal handlers, this</span>
</span><span class='line'>  <span class="c1"># helps (but does not completely) prevent identical, repeated signals</span>
</span><span class='line'>  <span class="c1"># from being lost when the receiving process is busy.</span>
</span><span class='line'>  <span class="c1"># sleep 1</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">after_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
</span><span class='line'>  <span class="c1"># per-process listener ports for debugging/admin/migrations</span>
</span><span class='line'>  <span class="c1"># addr = &quot;127.0.0.1:#{9293 + worker.nr}&quot;</span>
</span><span class='line'>  <span class="c1"># server.listen(addr, :tries =&gt; -1, :delay =&gt; 5, :tcp_nopush =&gt; true)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># the following is *required* for Rails + &quot;preload_app true&quot;,</span>
</span><span class='line'>  <span class="n">defined?</span><span class="p">(</span><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>    <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">establish_connection</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># if preload_app is true, then you may also want to check and</span>
</span><span class='line'>  <span class="c1"># restart any other shared sockets/descriptors such as Memcached,</span>
</span><span class='line'>  <span class="c1"># and Redis.  TokyoCabinet file handles are safe to reuse</span>
</span><span class='line'>  <span class="c1"># between any number of forked children (assuming your kernel</span>
</span><span class='line'>  <span class="c1"># correctly implements pread()/pwrite() system calls)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Заменяем ИМЯ_ПРИЛОЖЕНИЯ на Ваше имя приложения, которое Вы потом
зададите в настройках Capistrano.</p>

<h4>Capistrano</h4>

<p><img class="center" src="http://habrastorage.org/getpro/habr/post_images/0a6/3aa/2f6/0a63aa2f640920d345e0d82d27fe3466.jpg" title="Capistrano" alt="Capistrano"></p>

<p><a href="https://github.com/capistrano/capistrano">Capistrano</a> — весьма удобное
средство для деплоя приложения, пусть и сначала таковым не кажется.
Установим его с нужными дополнениями, добавив в Gemfile:</p>

<figure class='code'><figcaption><span>Gemfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano-rails&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano-bundler&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano-rvm&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Выполняем <code>bundle exec cap install</code>и добавляем в Capfile:</p>

<figure class='code'><figcaption><span>Capfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;capistrano/deploy&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capistrano/rvm&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capistrano/bundler&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capistrano/rails&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Уже сейчас, просто указав адрес сервера, репозитория и рабочую папку,
Capistrano:</p>

<ul>
<li>Загрузит ваше приложение из репозитория на сервер в папку
<code>рабочая_папка/имя_приложения/releases/дата_релиза/</code>, не удаляя
старую версию (по умолчанию он хранит 5 последних версий
приложений).</li>
<li>Выполнит bundle install.</li>
<li>Выполнит db:migrate.</li>
<li>Выполнит assets:precompile.</li>
<li>Создаст symlink из папки приложения в папку
<code>рабочая_папка/имя_приложения/current</code></li>
</ul>


<p>Но нам этого мало. Нам нужно реализовать следующее:</p>

<ul>
<li>При первом деплое выполнить настройку nginx, unicorn, загрузить
некоторые файлы, которые не будут меняться, создать upstart скрипт
(с помощью foreman).</li>
<li>Перед каждым деплоем автоматически выполнять git add, git commit,
git push (сообщение к коммиту спрашивать у пользователя). После
каждого деплоя создавать симлинки и перезапускать Unicorn.</li>
</ul>


<p>Нужные только в первый раз файлы будем хранить в папке shared (в папке
проекта на локальной машине), не зря мы ее добавили в .gitignore.
Сначала создадим там nginx.conf примерно с таким содержимым:</p>

<figure class='code'><figcaption><span>nginx.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>user nginx web;
</span><span class='line'>
</span><span class='line'>pid /var/run/nginx.pid;
</span><span class='line'>error_log /var/www/log/nginx.error.log;
</span><span class='line'>
</span><span class='line'>events <span class="o">{</span>
</span><span class='line'>  worker_connections 1024; <span class="c"># increase if you have lots of clients</span>
</span><span class='line'>  accept_mutex off; <span class="c"># &quot;on&quot; if nginx worker_processes &gt; 1</span>
</span><span class='line'>  use epoll; <span class="c"># enable for Linux 2.6+</span>
</span><span class='line'>  <span class="c"># use kqueue; # enable for FreeBSD, OSX</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>http <span class="o">{</span>
</span><span class='line'>  <span class="c"># nginx will find this file in the config directory set at nginx build time</span>
</span><span class='line'>  include mime.types;
</span><span class='line'>  types_hash_max_size 2048;
</span><span class='line'>  server_names_hash_bucket_size 64;
</span><span class='line'>  <span class="c"># fallback in case we can&#39;t determine a type</span>
</span><span class='line'>  default_type application/octet-stream;
</span><span class='line'>
</span><span class='line'>  <span class="c"># click tracking!</span>
</span><span class='line'>  access_log /var/www/log/nginx.access.log combined;
</span><span class='line'>
</span><span class='line'>  <span class="c"># you generally want to serve static files with nginx since neither</span>
</span><span class='line'>  <span class="c"># Unicorn nor Rainbows! is optimized for it at the moment</span>
</span><span class='line'>  sendfile on;
</span><span class='line'>
</span><span class='line'>  tcp_nopush on; <span class="c"># off may be better for *some* Comet/long-poll stuff</span>
</span><span class='line'>  tcp_nodelay off; <span class="c"># on may be better for some Comet/long-poll stuff</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># we haven&#39;t checked to see if Rack::Deflate on the app server is</span>
</span><span class='line'>  <span class="c"># faster or not than doing compression via nginx.  It&#39;s easier</span>
</span><span class='line'>  <span class="c"># to configure it all in one place here for static files and also</span>
</span><span class='line'>  <span class="c"># to disable gzip for clients who don&#39;t get gzip/deflate right.</span>
</span><span class='line'>  <span class="c"># There are other gzip settings that may be needed used to deal with</span>
</span><span class='line'>  <span class="c"># bad clients out there, see http://wiki.nginx.org/NginxHttpGzipModule</span>
</span><span class='line'>  gzip on;
</span><span class='line'>  gzip_http_version 1.0;
</span><span class='line'>  gzip_proxied any;
</span><span class='line'>  gzip_min_length 0;
</span><span class='line'>  gzip_vary on;
</span><span class='line'>  gzip_disable <span class="s2">&quot;MSIE [1-6]\.&quot;</span>;
</span><span class='line'>  gzip_proxied expired no-cache no-store private auth;
</span><span class='line'>  gzip_comp_level 9;
</span><span class='line'>  gzip_types text/plain text/xml text/css
</span><span class='line'>             text/comma-separated-values
</span><span class='line'>             text/javascript application/x-javascript
</span><span class='line'>             application/atom+xml;
</span><span class='line'>
</span><span class='line'>  <span class="c"># this can be any application server, not just Unicorn/Rainbows!</span>
</span><span class='line'>  upstream app_server <span class="o">{</span>
</span><span class='line'>    server unix:/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/socket/.unicorn.sock <span class="nv">fail_timeout</span><span class="o">=</span>0;
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  server <span class="o">{</span>
</span><span class='line'>    <span class="c"># PageSpeed</span>
</span><span class='line'>    pagespeed on;
</span><span class='line'>    pagespeed FileCachePath /var/ngx_pagespeed_cache;
</span><span class='line'>    location ~ <span class="s2">&quot;\.pagespeed\.([a-z]\.)?[a-z]{2}\.[^.]{10}\.[^.]+&quot;</span> <span class="o">{</span>
</span><span class='line'>      add_header <span class="s2">&quot;&quot;</span> <span class="s2">&quot;&quot;</span>;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    location ~ <span class="s2">&quot;^/ngx_pagespeed_static/&quot;</span> <span class="o">{</span> <span class="o">}</span>
</span><span class='line'>    location ~ <span class="s2">&quot;^/ngx_pagespeed_beacon$&quot;</span> <span class="o">{</span> <span class="o">}</span>
</span><span class='line'>    location /ngx_pagespeed_statistics <span class="o">{</span>
</span><span class='line'>      allow 127.0.0.1; allow 5.228.169.73; deny all;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    location /ngx_pagespeed_global_statistics <span class="o">{</span>
</span><span class='line'>      allow 127.0.0.1; allow 5.228.169.73; deny all;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    pagespeed MessageBufferSize 100000;
</span><span class='line'>    location /ngx_pagespeed_message <span class="o">{</span>
</span><span class='line'>      allow 127.0.0.1; allow 5.228.169.73; deny all;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    location /pagespeed_console <span class="o">{</span>
</span><span class='line'>      allow 127.0.0.1; allow 5.228.169.73; deny all;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    charset utf-8;
</span><span class='line'>    <span class="c"># enable one of the following if you&#39;re on Linux or FreeBSD</span>
</span><span class='line'>    listen 80 default deferred; <span class="c"># for Linux</span>
</span><span class='line'>    <span class="c"># listen 80 default accept_filter=httpready; # for FreeBSD</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># If you have IPv6, you&#39;ll likely want to have two separate listeners.</span>
</span><span class='line'>    <span class="c"># One on IPv4 only (the default), and another on IPv6 only instead</span>
</span><span class='line'>    <span class="c"># of a single dual-stack listener.  A dual-stack listener will make</span>
</span><span class='line'>    <span class="c"># for ugly IPv4 addresses in $remote_addr (e.g &quot;:ffff:10.0.0.1&quot;</span>
</span><span class='line'>    <span class="c"># instead of just &quot;10.0.0.1&quot;) and potentially trigger bugs in</span>
</span><span class='line'>    <span class="c"># some software.</span>
</span><span class='line'>    <span class="c"># listen [::]:80 ipv6only=on; # deferred or accept_filter recommended</span>
</span><span class='line'>
</span><span class='line'>    client_max_body_size 4G;
</span><span class='line'>    server_name _;
</span><span class='line'>
</span><span class='line'>    <span class="c"># ~2 seconds is often enough for most folks to parse HTML/CSS and</span>
</span><span class='line'>    <span class="c"># retrieve needed images/icons/frames, connections are cheap in</span>
</span><span class='line'>    <span class="c"># nginx so increasing this is generally safe...</span>
</span><span class='line'>    keepalive_timeout 5;
</span><span class='line'>
</span><span class='line'>    <span class="c"># path for static files</span>
</span><span class='line'>    root /var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/current/public;
</span><span class='line'>
</span><span class='line'>    <span class="c"># Prefer to serve static files directly from nginx to avoid unnecessary</span>
</span><span class='line'>    <span class="c"># data copies from the application server.</span>
</span><span class='line'>    <span class="c">#</span>
</span><span class='line'>    <span class="c"># try_files directive appeared in in nginx 0.7.27 and has stabilized</span>
</span><span class='line'>    <span class="c"># over time.  Older versions of nginx (e.g. 0.6.x) requires</span>
</span><span class='line'>    <span class="c"># &quot;if (!-f $request_filename)&quot; which was less efficient:</span>
</span><span class='line'>    <span class="c"># http://bogomips.org/unicorn.git/tree/examples/nginx.conf?id=v3.3.1#n127</span>
</span><span class='line'>    try_files <span class="nv">$uri</span>/index.html <span class="nv">$uri</span>.html <span class="nv">$uri</span> @app;
</span><span class='line'>
</span><span class='line'>    location ~ ^/<span class="o">(</span>assets<span class="o">)</span>/  <span class="o">{</span>
</span><span class='line'>      root /var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/current/public;
</span><span class='line'>
</span><span class='line'>      expires max;
</span><span class='line'>      add_header Cache-Control public;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    location @app <span class="o">{</span>
</span><span class='line'>      <span class="c"># an HTTP header important enough to have its own Wikipedia entry:</span>
</span><span class='line'>      <span class="c">#   http://en.wikipedia.org/wiki/X-Forwarded-For</span>
</span><span class='line'>      proxy_set_header X-Forwarded-For <span class="nv">$proxy_add_x_forwarded_for</span>;
</span><span class='line'>
</span><span class='line'>      <span class="c"># enable this if you forward HTTPS traffic to unicorn,</span>
</span><span class='line'>      <span class="c"># this helps Rack set the proper URL scheme for doing redirects:</span>
</span><span class='line'>      <span class="c"># proxy_set_header X-Forwarded-Proto $scheme;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c"># pass the Host: header from the client right along so redirects</span>
</span><span class='line'>      <span class="c"># can be set properly within the Rack application</span>
</span><span class='line'>      proxy_set_header Host <span class="nv">$http_host</span>;
</span><span class='line'>
</span><span class='line'>      <span class="c"># we don&#39;t want nginx trying to do something clever with</span>
</span><span class='line'>      <span class="c"># redirects, we set the Host: header above already.</span>
</span><span class='line'>      proxy_redirect off;
</span><span class='line'>
</span><span class='line'>      <span class="c"># set &quot;proxy_buffering off&quot; *only* for Rainbows! when doing</span>
</span><span class='line'>      <span class="c"># Comet/long-poll/streaming.  It&#39;s also safe to set if you&#39;re using</span>
</span><span class='line'>      <span class="c"># only serving fast clients with Unicorn + nginx, but not slow</span>
</span><span class='line'>      <span class="c"># clients.  You normally want nginx to buffer responses to slow</span>
</span><span class='line'>      <span class="c"># clients, even with Rails 3.1 streaming because otherwise a slow</span>
</span><span class='line'>      <span class="c"># client can become a bottleneck of Unicorn.</span>
</span><span class='line'>      <span class="c">#</span>
</span><span class='line'>      <span class="c"># The Rack application may also set &quot;X-Accel-Buffering (yes|no)&quot;</span>
</span><span class='line'>      <span class="c"># in the response headers do disable/enable buffering on a</span>
</span><span class='line'>      <span class="c"># per-response basis.</span>
</span><span class='line'>      <span class="c"># proxy_buffering off;</span>
</span><span class='line'>
</span><span class='line'>      proxy_pass http://app_server;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Rails error pages</span>
</span><span class='line'>    error_page 500 502 503 504 /500.html;
</span><span class='line'>    <span class="nv">location</span> <span class="o">=</span> /500.html <span class="o">{</span>
</span><span class='line'>      root /var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/current/public;
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Это мой конфиг для nginx, там необходимо заменить &lsquo;ИМЯ<em>ПРИЛОЖЕНИЯ&rsquo; на
Ваше имя приложения, указанное в первой строчке config/deploy.rb (set
:application, &lsquo;ИМЯ</em>ПРИЛОЖЕНИЯ&rsquo;).</p>

<p>Теперь создаем там же (в /shared/) файл Procfile с таким содержанием:</p>

<figure class='code'><figcaption><span>nginx.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>web: bundle <span class="nb">exec </span>unicorn_rails -c /var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/current/config/unicorn.rb -E production
</span><span class='line'>job1: bundle <span class="nb">exec </span>rake resque:work <span class="nv">RAILS_ENV</span><span class="o">=</span>production <span class="nv">PIDFILE</span><span class="o">=</span>/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/run/resque1.pid <span class="nv">QUEUES</span><span class="o">=</span>*
</span><span class='line'>job2: bundle <span class="nb">exec </span>rake resque:work <span class="nv">RAILS_ENV</span><span class="o">=</span>production <span class="nv">PIDFILE</span><span class="o">=</span>/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ/run/resque2.pid <span class="nv">QUEUES</span><span class="o">=</span>*
</span></code></pre></td></tr></table></div></figure>


<p>Это конфиг для приложения с двумя resque workerами. Если Вы не
используете Resque, то просто оставьте только первую строчку.
Там же создаём database.yml с настройками базы данных и application.yml,
если пользуетесь гемом Figaro.</p>

<p>Нвш Capistrano скрипт будет выполнять некоторые команды от имени
суперпользователя на сервере. Чтобы разрешить ему делать это, выполняем
команду <code>sudo visudo</code> на сервере и добавляем строчку:</p>

<figure class='code'><figcaption><span>nginx.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>deployer <span class="nv">ALL</span><span class="o">=</span>NOPASSWD: /usr/sbin/service, /bin/ln, /bin/rm, /bin/mv, /sbin/start, /sbin/stop, /sbin/restart, /sbin/status
</span></code></pre></td></tr></table></div></figure>


<p>Осталось только настроить Capistrano. В файле &lsquo;config/deploy/production&rsquo;
делаем изменения:
 <code>server 'IP сервера', user: 'deployer', roles: %w{web app db}</code>
В файл &lsquo;config/deploy.rb&rsquo; добавляем сверху:</p>

<figure class='code'><figcaption><span>deploy.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">set</span> <span class="ss">:repo_url</span><span class="p">,</span> <span class="s1">&#39;Адрес репозитория&#39;</span>
</span><span class='line'><span class="n">set</span> <span class="ss">:application</span><span class="p">,</span> <span class="s1">&#39;ИМЯ_ПРИЛОЖЕНИЯ&#39;</span>
</span><span class='line'><span class="n">application</span> <span class="o">=</span> <span class="s1">&#39;ИМЯ_ПРИЛОЖЕНИЯ&#39;</span>
</span><span class='line'><span class="n">set</span> <span class="ss">:rvm_type</span><span class="p">,</span> <span class="ss">:user</span>
</span><span class='line'><span class="n">set</span> <span class="ss">:rvm_ruby_version</span><span class="p">,</span> <span class="s1">&#39;2.0.0-p353&#39;</span>
</span><span class='line'><span class="n">set</span> <span class="ss">:deploy_to</span><span class="p">,</span> <span class="s1">&#39;/var/www/apps/ИМЯ_ПРИЛОЖЕНИЯ&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">namespace</span> <span class="ss">:foreman</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Start server&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:start</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;start </span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Stop server&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:stop</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;stop </span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Restart server&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:restart</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;restart </span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Server status&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:status</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;initctl list | grep </span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">namespace</span> <span class="ss">:git</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Deploy&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:deploy</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">ask</span><span class="p">(</span><span class="ss">:message</span><span class="p">,</span> <span class="s2">&quot;Commit message?&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">run_locally</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;git add -A&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;git commit -m &#39;</span><span class="si">#{</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:message</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;git push&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Что всё это значит? Первые строчки — конфиг. Затем мы описываем задачи.
Есть задача foreman, у которой есть 4 действия: start, stop, restart
status. При выполнении &lsquo;cap production foreman:start&rsquo; на локальной
машине на сервере будет выполнено &lsquo;sudo start ИМЯ_ПРИЛОЖЕНИЯ&rsquo;, но пока
что это нам ничего не даст, ибо foreman еще не создал upstart скрипты.
Идем дальше: есть задача git, у которой есть действие deploy. При
выполнении &lsquo;cap production git:deploy&rsquo; пользователя спросят комментарий
к коммиту и будет выполнено:</p>

<figure class='code'><figcaption><span>deploy.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">add</span> <span class="o">-</span><span class="n">A</span>
</span><span class='line'><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;КОММЕНТАРИЙ&#39;</span>
</span><span class='line'><span class="n">git</span> <span class="n">push</span>
</span></code></pre></td></tr></table></div></figure>


<p>Совсем не сложно, правда? Но этими командами мы не будем пользоваться
сами, они будут выполняться при выполнении других скриптов. Теперь
внутри &lsquo;namespace :deploy do&rsquo; добавляем:</p>

<figure class='code'><figcaption><span>deploy.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="n">desc</span> <span class="s1">&#39;Setup&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:setup</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;mkdir  </span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/config/&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;mkdir  /var/www/apps/</span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">/run/&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;mkdir  /var/www/apps/</span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">/log/&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;mkdir  /var/www/apps/</span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">/socket/&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;mkdir </span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/system&quot;</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;ln -s /var/log/upstart /var/www/log/upstart&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">upload!</span><span class="p">(</span><span class="s1">&#39;shared/database.yml&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/config/database.yml&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">upload!</span><span class="p">(</span><span class="s1">&#39;shared/Procfile&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/Procfile&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="n">upload!</span><span class="p">(</span><span class="s1">&#39;shared/nginx.conf&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/nginx.conf&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s1">&#39;stop nginx&#39;</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;rm -f /usr/local/nginx/conf/nginx.conf&quot;</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;ln -s </span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/nginx.conf /usr/local/nginx/conf/nginx.conf&quot;</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s1">&#39;start nginx&#39;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">within</span> <span class="n">release_path</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">with</span> <span class="n">rails_env</span><span class="p">:</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:rails_env</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">execute</span> <span class="ss">:rake</span><span class="p">,</span> <span class="s2">&quot;db:create&quot;</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Create symlink&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:symlink</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;ln -s </span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/config/database.yml </span><span class="si">#{</span><span class="n">release_path</span><span class="si">}</span><span class="s2">/config/database.yml&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;ln -s </span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/Procfile </span><span class="si">#{</span><span class="n">release_path</span><span class="si">}</span><span class="s2">/Procfile&quot;</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;ln -s </span><span class="si">#{</span><span class="n">shared_path</span><span class="si">}</span><span class="s2">/system </span><span class="si">#{</span><span class="n">release_path</span><span class="si">}</span><span class="s2">/public/system&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Foreman init&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:foreman_init</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">foreman_temp</span> <span class="o">=</span> <span class="s2">&quot;/var/www/tmp/foreman&quot;</span>
</span><span class='line'>      <span class="n">execute</span>  <span class="s2">&quot;mkdir -p </span><span class="si">#{</span><span class="n">foreman_temp</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="c1"># Создаем папку current для того, чтобы foreman создавал upstart файлы с правильными путями</span>
</span><span class='line'>      <span class="n">execute</span> <span class="s2">&quot;ln -s </span><span class="si">#{</span><span class="n">release_path</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">within</span> <span class="n">current_path</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">execute</span> <span class="s2">&quot;cd </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>        <span class="n">execute</span> <span class="ss">:bundle</span><span class="p">,</span> <span class="s2">&quot;exec foreman export upstart </span><span class="si">#{</span><span class="n">foreman_temp</span><span class="si">}</span><span class="s2"> -a </span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2"> -u deployer -l /var/www/apps/</span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">/log -d </span><span class="si">#{</span><span class="n">current_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;mv </span><span class="si">#{</span><span class="n">foreman_temp</span><span class="si">}</span><span class="s2">/* /etc/init/&quot;</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;rm -r </span><span class="si">#{</span><span class="n">foreman_temp</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="n">desc</span> <span class="s1">&#39;Restart application&#39;</span>
</span><span class='line'>  <span class="n">task</span> <span class="ss">:restart</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="ss">:app</span><span class="p">),</span> <span class="k">in</span><span class="p">:</span> <span class="ss">:sequence</span><span class="p">,</span> <span class="ss">wait</span><span class="p">:</span> <span class="mi">5</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">sudo</span> <span class="s2">&quot;restart </span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">after</span> <span class="ss">:finishing</span><span class="p">,</span> <span class="s1">&#39;deploy:cleanup&#39;</span>
</span><span class='line'>  <span class="n">after</span> <span class="ss">:finishing</span><span class="p">,</span> <span class="s1">&#39;deploy:restart&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">after</span> <span class="ss">:updating</span><span class="p">,</span> <span class="s1">&#39;deploy:symlink&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">after</span> <span class="ss">:setup</span><span class="p">,</span> <span class="s1">&#39;deploy:foreman_init&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">after</span> <span class="ss">:foreman_init</span><span class="p">,</span> <span class="s1">&#39;foreman:start&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="ss">:foreman_init</span><span class="p">,</span> <span class="s1">&#39;rvm:hook&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="ss">:setup</span><span class="p">,</span> <span class="s1">&#39;deploy:starting&#39;</span>
</span><span class='line'>  <span class="n">before</span> <span class="ss">:setup</span><span class="p">,</span> <span class="s1">&#39;deploy:updating&#39;</span>
</span><span class='line'>  <span class="n">before</span> <span class="ss">:setup</span><span class="p">,</span> <span class="s1">&#39;bundler:install&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Есть задача deploy и мы добавили 4 новых действия: setup (первичная
настройка), foreman_init (создание upstart скрипта для приложения),
symlink (создание символьных ссылок) и restart (перезагрузка
приложения). Также мы указываем после/перед какими стадиями, что нужно
выполнить.</p>

<p>deploy:setup выполняет первичную настройку сервера: загружает файлы из
папки shared на локальном компьютере в папку shared на сервере,
настраивает nginx, создает нужные папки и запускает
deploy:foreman_init, который в свою очередь создает upstart скрипты
через foreman и копирует их в /etc/init, после чего мы можем управлять
нашим приложением командами
<code>sudo start/stop/restart/status ИМЯ_ПРИЛОЖЕНИЯ</code>. Перед deploy:setup
выполняется три первых шага обычного деплоя приложения, а именно
заливаются файлы на сервер и выполняется <code>bundle install</code>. После каждого
деплоя создаются новый симлинки и перезагружается Unicorn. Осталось
только в конец этого файла добавить <code>before :deploy, 'git:deploy'</code>и
теперь перед каждым деплоем автоматически будут коммититься новые
изменения.</p>

<p>Еще раз:</p>

<ul>
<li>выполняем <code>cap production deploy:setup</code>при самом первом деплое
Вашего приложения.</li>
<li>выполняем <code>cap production deploy</code>при каждом деплое Вашего
приложения.</li>
</ul>


<hr />

<p>Вот именно так я всегда деплою свои приложения на VPS. Конечно, этот
способ не есть истина в последней инстанции, но я постарался на примере
объяснить как работает Capistrano, чтобы даже у новичка не было проблем
с изменением скрипта под свои нужды. Так же я не утверждаю, что мои
nginx.conf и unicorn.rb идеальны, но у меня с ними уже почти год все
работает на несильно мощных VPS и не было проблем даже под нагрузкой.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Баг в AngularJS Bootsrap-UI]]></title>
    <link href="http://goooseman.ru/2014/03/04/bagh-v-angularjs-bootstrap-ui/"/>
    <updated>2014-03-04T23:47:00+04:00</updated>
    <id>http://goooseman.ru/2014/03/04/bagh-v-angularjs-bootstrap-ui</id>
    <content type="html"><![CDATA[<p><img class="center" src="http://95.85.35.239/ftp/Screen_Shot_20140304_at_23.53.19.png" title="t be found!" alt="Controller carousel, required by directive ngTransclude, can"></p>

<p>Недавно подключил к проекту <a href="http://angular-ui.github.io/bootstrap/">AngularJS Bootstrap-UI</a> и сразу обнажурил баг: на страницах, где используется carousel (класс для слайдшоу в Bootstrap), выскакивает следующая ошибка:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Controller 'carousel', required by directive 'ngTransclude', can't be found! </span></code></pre></td></tr></table></div></figure>


<p></p>

<!-- more -->


<p>Полный лог:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Error: [$compile:ctreq] Controller 'carousel', required by directive 'ngTransclude', can't be found!
</span><span class='line'>http://errors.angularjs.org/1.2.13/$compile/ctreq?p0=carousel&p1=ngTransclude
</span><span class='line'>at http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:146612
</span><span class='line'>at g (http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:169688)
</span><span class='line'>at v (http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:171431)
</span><span class='line'>at http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:174956
</span><span class='line'>at http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:180992
</span><span class='line'>at u (http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:195225)
</span><span class='line'>at u (http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:195225)
</span><span class='line'>at http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:195902
</span><span class='line'>at u.$eval (http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:200165)
</span><span class='line'>at u.$digest (http://aliya-soap.ru/assets/application-177047d459241e8020f5604db9c970de.js.pagespeed.jm.eNxPlzr5Jo.js:1:198869) &lt;div ng-class="{
</span><span class='line'>'active': leaving || (active &amp;&amp; !entering),
</span><span class='line'>'prev': (next || active) &amp;&amp; direction=='prev',
</span><span class='line'>'next': (next || active) &amp;&amp; direction=='next',
</span><span class='line'>'right': direction=='prev',
</span><span class='line'>'left': direction=='next'
</span><span class='line'>}" class="left carousel-control item text-center ng-isolate-scope" ng-transclude="" href="#carousel-example-generic" data-slide="prev"&gt;</span></code></pre></td></tr></table></div></figure>


<p>Погуглив, обнаружил, что я <a href="http://stackoverflow.com/questions/20137900/controller-carousel-required-by-directive-ngtransclude-cant-be-found">не единственный, кто встретил этот баг</a>, вот только единственное решение, которое там предложили &ndash; отключить <code>ui.bootstrap</code>.</p>

<p>Баг находится в директиве <code>carousel</code> контроллера <code>ui.bootstrap.carousel</code>. Можно конечно его удалить из исходников, но я предлагаю способ лучше: переинициализировать этот модуль в нашем javascript файле:</p>

<figure class='code'><figcaption><span>application.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;ui.bootstrap.carousel&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ui.bootstrap.transition&#39;</span><span class="p">])</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;CarouselController&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">,</span> <span class="s1">&#39;$timeout&#39;</span><span class="p">,</span> <span class="s1">&#39;$transition&#39;</span><span class="p">,</span> <span class="s1">&#39;$q&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$timeout</span><span class="p">,</span> <span class="nx">$transition</span><span class="p">,</span> <span class="nx">$q</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">}]).</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;carousel&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}]);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Причина бага? Я её, честно говоря, не вижу. Директива должна вызываться только от аттрибута или элемента &lsquo;carousel&rsquo;, но по непонятной причине вызывается и от класса с таким именем.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Не выходи из комнаты...]]></title>
    <link href="http://goooseman.ru/2014/02/28/nie-vykhodi-iz-komnaty-dot-dot-dot/"/>
    <updated>2014-02-28T17:13:00+04:00</updated>
    <id>http://goooseman.ru/2014/02/28/nie-vykhodi-iz-komnaty-dot-dot-dot</id>
    <content type="html"><![CDATA[<p><img class="center" src="http://95.85.35.239/ftp/20140228172418.png" title="Иосиф Бродский" alt="Иосиф Бродский">
В <a href="http://pirates.radio-t.com/p/2014/02/22/podcast-380/">последнем послешоу</a> <a href="http://radio-t.com">Радио-Т</a> услышал удивительное стихотворение Иосифа Бродского. Решил сюда выложить, чтобы не забыть.</p>

<!--more-->


<blockquote><p>Не выходи из комнаты, не совершай ошибку.<br/> Зачем тебе Солнце, если ты куришь Шипку?<br/> За дверью бессмысленно все, особенно &#8211; возглас счастья.<br/> Только в уборную &#8211; и сразу же возвращайся.</p><p> О, не выходи из комнаты, не вызывай мотора.<br/> Потому что пространство сделано из коридора<br/> и кончается счетчиком. А если войдет живая<br/> милка, пасть разевая, выгони не раздевая.</p><p> Не выходи из комнаты; считай, что тебя продуло.<br/> Что интересней на свете стены и стула?<br/> Зачем выходить оттуда, куда вернешься вечером<br/> таким же, каким ты был, тем более &#8211; изувеченным?</p><p> О, не выходи из комнаты. Танцуй, поймав, боссанову<br/> в пальто на голое тело, в туфлях на босу ногу.<br/> В прихожей пахнет капустой и мазью лыжной.<br/> Ты написал много букв; еще одна будет лишней.</p><p> Не выходи из комнаты. О, пускай только комната<br/> догадывается, как ты выглядишь. И вообще инкогнито<br/> эрго сум, как заметила форме в сердцах субстанция.<br/> Не выходи из комнаты! На улице, чай, не Франция.</p><p> Не будь дураком! Будь тем, чем другие не были.<br/> Не выходи из комнаты! То есть дай волю мебели,<br/> слейся лицом с обоями. Запрись и забаррикадируйся<br/> шкафом от хроноса, космоса, эроса, расы, вируса.</p><footer><strong>Иосиф Бродский</strong></footer></blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Трудности favicon]]></title>
    <link href="http://goooseman.ru/2014/02/28/trudnosti-favicon/"/>
    <updated>2014-02-28T11:55:00+04:00</updated>
    <id>http://goooseman.ru/2014/02/28/trudnosti-favicon</id>
    <content type="html"><![CDATA[<p><img class="center" src="http://95.85.35.239/ftp/20140228170321.png" title="Трудности favicon" alt="Трудности favicon">
Готовясь к <a href="http://academy.1c-bitrix.ru/konkurs/">студенческой олимпиаде по web-разработке</a>, я понял, что надо уделить внимание мелочам. Вот, например, favicon. Что может быть проще? Положил favicon.ico в корень и радуешься жизни. <a href="https://github.com/audreyr/favicon-cheat-sheet">А вот и не все так просто.</a></p>

<ul>
<li>Во-первых, в идеале favicon.ico должен содержать иконки следующих размеров: 16х16, 24x24, 32x32, 48x48, 64x64.</li>
<li>Во-вторых, еще бы не помешали иконки в .png следующих размеров (для живых тайлов в IE11): 70x70, 150x150, 310x310.</li>
<li>В-третих, еще бы нужна иконка в .png размеров 195x195 для Opera Speed Dial.</li>
<li>Наконец, <a href="http://mathiasbynens.be/notes/touch-icons#sizes">иконки для iOS и Android</a> нужны следующих размеров (для поддрежки как и iOS ≤ 6, так и iOS ≥ 7): 57х57, 72x72, 76x76, 114x114, 120x120, 144x144, 152x152.</li>
</ul>


<p>Конечно, это все необязательно, но уж точно хуже не будет. Но как генирировать такое кол-во иконок?</p>

<!--more-->


<h1>PSD шаблон?</h1>

<p>Сначала я нашёл <a href="https://github.com/jonrandahl/H5BP-Multi-Layer-FavIcons">.psd шаблон</a>, который автоматически генерит иконки нужных размеров. Но он не рассчитан под новые размеры, которые рекоммендует Apple после выхода iOS 7 (76x76, 120x120, 152x152). Не беда! <a href="https://github.com/goooseman/H5BP-Multi-Layer-FavIcons-iOS7">Форкнул, отредактировал, закоммитил, запушил</a>. Теперь с <del>блекджеком</del> поддержкой iOS 7. Но все же как то это не удобно: фотошоп, да и .ico файл сам не генерит. Слижком много движений руками.</p>

<h1>Скрипт?</h1>

<p>Нашёл скрипт <a href="https://github.com/emarref/webicon">webicon.sh</a>, который генерит .png разного размера, затех из них делает .ico и показывает html код, который надо вставить в шапку страницы. Но меня он тоже не устроил. <a href="https://github.com/goooseman/webicon">Форкнул</a>, изменил. В отличиее от первоначального варианта, моя версия скрипта:</p>

<ul>
<li>Оптимизирует каждый сгенерированный .png коммандой <code>optipng</code> (<strong>новая зависимость</strong>)</li>
<li>Иконки для iOS (и Android) получают название в соответствии с шаблоном: apple-touch-icon-РАЗМЕРхРАЗМЕР-precomposed.png</li>
<li>Иконки для iOS (и Android) делаются непрозрачными (прозрачный заменяется на белый)</li>
<li>favicon.ico может быть прозрачной</li>
<li>favicon.ico включает в себя следующие размеры: 16х16, 24x24, 32x32, 48x48, 64x64</li>
<li>Те .png, которые необходимы только для генерации .ico, удаляются</li>
<li>Добавлена генерация .png размеро 195х195 для поддержки Opera Speed Dial</li>
<li>Отредактирован вывод html (улучшена поддрежка iOS, добавлена поддержка Opera Speed Dial)</li>
<li>Добавлено изображение для теста</li>
</ul>


<p>Теперь скрипт генерит следующие файлы:</p>

<ul>
<li>apple-touch-icon-57x57-precomposed.png</li>
<li>apple-touch-icon-72x72-precomposed.png</li>
<li>apple-touch-icon-76x76-precomposed.png</li>
<li>apple-touch-icon-114x114-precomposed.png</li>
<li>apple-touch-icon-120x120-precomposed.png</li>
<li>apple-touch-icon-144x144-precomposed.png</li>
<li>apple-touch-icon-152x152-precomposed.png</li>
<li>favicon-70.png</li>
<li>favicon-150.png</li>
<li>favicon-195.png</li>
<li>favicon-310.png</li>
<li>favicon.ico</li>
</ul>


<p>После генерации скрипт показывает следующий код, который нужно вставить в <code>&lt;head&gt;</code> сайта:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;icon&quot;</span> <span class="na">sizes=</span><span class="s">&quot;16x16 32x32 48x48 64x64&quot;</span> <span class="na">href=</span><span class="s">&quot;favicon.ico&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!--[if IE]&gt;&lt;link rel=&quot;shortcut icon&quot; href=&quot;favicon.ico&quot;&gt;&lt;![endif]--&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&lt;!-- The below are optional but encouraged --&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c">&lt;!-- The below are optional --&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&lt;!-- IE 10 Metro tile icon (Metro equivalent of apple-touch-icon): --&gt;</span>
</span><span class='line'><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;msapplication-TileColor&quot;</span> <span class="na">content=</span><span class="s">&quot;#FFFFFF&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;msapplication-TileImage&quot;</span> <span class="na">content=</span><span class="s">&quot;apple-touch-icon-144x144-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- Opera Speed Dial icon --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;icon&quot;</span> <span class="na">sizes=</span><span class="s">&quot;195x195&quot;</span> <span class="na">href=</span><span class="s">&quot;favicon-195.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- IE 11 live tiles: --&gt;</span>
</span><span class='line'><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;msapplication-square70x70logo&quot;</span> <span class="na">content=</span><span class="s">&quot;favicon-70.png&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;msapplication-square150x150logo&quot;</span> <span class="na">content=</span><span class="s">&quot;favicon-150.png&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;msapplication-square310x310logo&quot;</span> <span class="na">content=</span><span class="s">&quot;favicon-310.png&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For iPad with high-resolution Retina display running iOS ≥ 7: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">sizes=</span><span class="s">&quot;152x152&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-152x152-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For iPad with high-resolution Retina display running iOS ≤ 6: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">sizes=</span><span class="s">&quot;144x144&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-144x144-precomposed&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For iPhone with high-resolution Retina display running iOS ≥ 7: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">sizes=</span><span class="s">&quot;120x120&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-120x120-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For iPhone with high-resolution Retina display running iOS ≤ 6: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">sizes=</span><span class="s">&quot;114x114&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-114x114-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For the iPad mini and the first- and second-generation iPad on iOS ≥ 7: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">sizes=</span><span class="s">&quot;76x76&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-76x76-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For the iPad mini and the first- and second-generation iPad on iOS ≤ 6: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">sizes=</span><span class="s">&quot;72x72&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-72x72-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: --&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;apple-touch-icon-precomposed&quot;</span> <span class="na">href=</span><span class="s">&quot;apple-touch-icon-57x57-precomposed.png&quot;</span><span class="nt">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://github.com/goooseman/webicon">Скачать скрипт</a>. Перед использованием необходимо установить <a href="http://www.imagemagick.org/">imagemagick</a> и <a href="http://optipng.sourceforge.net/">optipng</a>. На маке легче всего это сделать через <a href="http://brew.sh/">homebrew</a>. Сам скрипт лучше всего его положить в папку, которая включена в $PATH, чтобы с легкостью запускать его просто коммандой <code>webicon.sh</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Лучшая техподдержка]]></title>
    <link href="http://goooseman.ru/2014/01/12/luchshaia-tiekhpoddierzhka/"/>
    <updated>2014-01-12T01:38:00+04:00</updated>
    <id>http://goooseman.ru/2014/01/12/luchshaia-tiekhpoddierzhka</id>
    <content type="html"><![CDATA[<p>Есть сервис <a href="http://siteheart.com">SiteHeart</a>, предоставляющий лучший, на мой взгляд, чат для онлайн консультирования посетителей Вашего сайта. Вот только у них с консультантами небольшая проблема. По крайней мере с одним:<br/>
<img class="center" src="http://screencloud.net//img/screenshots/8fab28f4bce0279069f57ed053518525.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ошибка Capistrano bundle: not found]]></title>
    <link href="http://goooseman.ru/2014/01/08/oshchibka-capistrano-bundle-not-found/"/>
    <updated>2014-01-08T23:48:00+04:00</updated>
    <id>http://goooseman.ru/2014/01/08/oshchibka-capistrano-bundle-not-found</id>
    <content type="html"><![CDATA[<p><img class="center" src="http://d.pr/i/Ftgm+"><br/>
Для деплоя своих проектов на Rails я использую третью версию Capistrano. На серверах я использую rvm для установки ruby и на локалке использую следующий набор гемов:</p>

<figure class='code'><figcaption><span>Gemfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano-rails&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano-bundler&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capistrano-rvm&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>
И тут два дня назад деплой ломается одновременно на обоих моих проектах. На попытке сделать <code>assets:precompile</code> вылетает такая ошибка:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DEBUG [6c391f27] Command: cd /var/www/apps/aliya/releases/20140108194955 && ( RAILS_ENV=production bundle exec rake assets:precompile )
</span><span class='line'>DEBUG [6c391f27]  bash: bundle: command not found
</span><span class='line'>cap aborted!
</span><span class='line'>rake stdout: Nothing written
</span><span class='line'>rake stderr: Nothing written
</span><span class='line'>
</span><span class='line'>Tasks: TOP => deploy:assets:precompile
</span><span class='line'>(See full trace by running task with --trace)</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<p>Я связал это с выходом новой версии ruby (2.1) и решил прописать в <code>deploy.rb</code> нужную версию:</p>

<figure class='code'><figcaption><span>deploy.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">set</span> <span class="ss">:rvm_type</span><span class="p">,</span> <span class="ss">:user</span>
</span><span class='line'><span class="n">set</span> <span class="ss">:rvm_ruby_version</span><span class="p">,</span> <span class="s1">&#39;2.0.0-p353&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>
Но это не помогло. Тогда я прописал в тот же файл значение переменной $PATH. Для этого заходим по SSH на сервер, выполняем <code>echo $PATH</code> и прописываем его на локалке:</p>

<figure class='code'><figcaption><span>deploy.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">set</span> <span class="ss">:default_env</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">:PATH</span> <span class="o">=&gt;</span> <span class="s1">&#39;/home/deployer/.rvm/gems/ruby-2.0.0-p353/bin:/home/deployer/.rvm/gems/ruby-2.0.0-p353@global/bin:/home/deployer/.rvm/rubies/ruby-2.0.0-p353/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/home/deployer/.rvm/bin&#39;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
Бинго! Всё работает как раньше.</p>

<p>P.S. Самое интересное, что если прописать $PATH, но не указывать версию ruby, то все равно получаем ошибку, но уже раньше, на <code>bundle install</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cap aborted!
</span><span class='line'>bundle stdout: Nothing written
</span><span class='line'>bundle stderr: Nothing written
</span><span class='line'>
</span><span class='line'>Tasks: TOP => deploy:updated => bundler:install
</span><span class='line'>(See full trace by running task with --trace)
</span><span class='line'>DEBUG [c90cd2c7]  /home/deployer/.rvm/scripts/set: line 19: exec: bundle: not found</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Новый Safari и Yandex.Maps 2.1β]]></title>
    <link href="http://goooseman.ru/2013/11/11/novyi-safari-i-yandex-dot-maps-2-dot-1b/"/>
    <updated>2013-11-11T11:45:00+04:00</updated>
    <id>http://goooseman.ru/2013/11/11/novyi-safari-i-yandex-dot-maps-2-dot-1b</id>
    <content type="html"><![CDATA[<p>Я разрабатываю один проект и долго не мог понять, почему при загрузке сайта в Safari (Mavericks) я получаю сообщение &ldquo;A problem occured with this webpage so it was reloaded&rdquo; (&ldquo;При работе с этой веб-страницей произошел сбой, поэтому она была перезагружена&rdquo;), и вылетает crash log Safari.<br/>
<img class="center" src="http://d.pr/i/YU0p+"></p>

<!-- more -->


<p>При повторной перезагрузке я получаю сообщение &ldquo;A problem repeatedly occured with &hellip;&rdquo; (&ldquo;Повторилась проблема с &hellip;&rdquo;).<br/>
<img class="center" src="http://d.pr/i/JPRF+"><br/>
Самое интересное, что если открыть консоль, то ничего не падает.<br/>
<img class="center" src="http://d.pr/i/rCSv+"><br/>
Как Вы могли уже догадаться из скриншотов, проблема на моём сайте оказалась в использовании бета версии Яндекс.Карт за порядковым номером 2.1. Надеюсь, к релизу пофиксят.</p>

<p>UPD: Уже исправили</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Знак рубля]]></title>
    <link href="http://goooseman.ru/2013/11/09/znak-rublia/"/>
    <updated>2013-11-09T21:36:00+04:00</updated>
    <id>http://goooseman.ru/2013/11/09/znak-rublia</id>
    <content type="html"><![CDATA[<p>Во вторник Банк России предложил людям проголосовать за символ Рубля. Вот предложенные варианты:<br/>
<img class="center" src="http://d.pr/i/ihvL+"><br/>
Вы серьёзно? Все эти варианты были предложены еще 6 лет назад. Это раз.<br/>
Первый вариант будет ужасен в жирном начертании. Это два.<br/>
Последние три априори ужасны. Они пытались сделать буквы У, выходящей из Р, а получил английская R.<br/>
Второй неплох, к тому же он уже давно используется многими, и уже появляется в некоторых шрифтах (недавно даже в <a href="http://fontawesome.io/">Font Awasome</a> появился).<br/>
Ну так зачем давать выбор, когда он настолько очевиден?<br/>
С другой стороны, хорошо, что они вообще об этом вспомнили, вон у Украинской гривны <a href="http://ru.wikipedia.org/wiki/%D0%A1%D0%B8%D0%BC%D0%B2%D0%BE%D0%BB_%D0%B3%D1%80%D0%B8%D0%B2%D0%BD%D1%8B">давно</a> уже есть свой символ:<br/>
<img class="center" src="http://d.pr/i/U7bH+" width="66" height="98"><br/>
Кстати, через годик после принятия символа рубля, он должен появится в кодировке Unicode, то есть скоро будем набирать прямо на айФоне знак <i class="fa fa-rub"></i>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Винтики в MacBook]]></title>
    <link href="http://goooseman.ru/2013/11/09/vintiki-v-macbook/"/>
    <updated>2013-11-09T14:55:00+04:00</updated>
    <id>http://goooseman.ru/2013/11/09/vintiki-v-macbook</id>
    <content type="html"><![CDATA[<p>Бывают ярые фанатики Apple. Я к таким не отношусь. Я люблю Apple, но еще я люблю придираться к мелочам.<br/>
Apple официально разрешает самому пользователю менять (без потери гарантии) в своём MacBook две вещи: HDD да память. Ну тогда на кой хрен они делают на HDD винтики (которые закрепляют HDD в самом лотке) под отвертку T4 (шестиконечная звезда)? Полюбуйтесь:<br/>
<img class="center" src="http://d.pr/i/fpC3+"><br/>
Вы конечно можете вынуть HDD без специальной отвертки, но вот нормально закрепить новый &ndash; ни ни. Весь парадокс в том, что лично в моем MacBook нет больше не единого специфичного винтика, то есть я могу разобрать его полностью обычной крестовой отверткой, а вот тупо поменять HDD &ndash; нет.<br/>
Я понимаю, если бы Apple сама бы занималась дистрибуцией HDD с уже вкрученными болтами, но такого нет. Так зачем писать user replaceable, но так мешать домохозяйке, которая хочет побольше памяти?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Использование fabric.js как инструмент для кропа изображений]]></title>
    <link href="http://goooseman.ru/2013/11/09/ispol%27zovaniie-fabric-dot-js-kak-instrumient-dlia-kropa-izobrazhienii/"/>
    <updated>2013-11-09T14:27:00+04:00</updated>
    <id>http://goooseman.ru/2013/11/09/ispol&#8217;zovaniie-fabric-dot-js-kak-instrumient-dlia-kropa-izobrazhienii</id>
    <content type="html"><![CDATA[<p>Задача: сделать инструмент, с помощью которого юзер может обрезать свое изображение по определнной маске.<br/>
Например, есть вот такая рамка:<br/>
<img class="center" src="http://d.pr/i/E3LK+"><br/>
Юзер может перетягивать свое изображение под этой маской, менять его размер и по нажатии на кнопку, все, что внутри фигуры сохраняется в .png файл.</p>

<!-- more -->


<p>Я буду использовать библиотеку для работы с html5 canvas fabric.js. Ничего более простого я придумать не смог.<br/>
Маска должна быть в .svg, <a href="http://d.pr/f/HxLv">вот</a>, например, моя.<br/>
Создаем два canvas: один статичный (маска то не изменяемая), второй нет (на нем будет фото). Pointer-events мы используем для того, что статичный canvas будет находится над другим (фото должно быть под маской), но pointer-events должны быть только у нижнего.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;photo-canvas&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">&quot;photo-canvas&quot;</span><span class="nt">&gt;&lt;/canvas&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;photo-canvas&quot;</span> <span class="na">style=</span><span class="s">&quot;pointer-events: none;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">&quot;static-photo-canvas&quot;</span><span class="nt">&gt;&lt;/canvas&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.photo-canvas</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">500px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">500px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
Подключаем fabric.js и пишем js:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Создаем холсты</span>
</span><span class='line'><span class="nx">photoCanvas</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">fabric</span><span class="p">.</span><span class="nx">Canvas</span><span class="p">(</span><span class="s1">&#39;photo-canvas&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nx">staticPhotoCanvas</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">fabric</span><span class="p">.</span><span class="nx">StaticCanvas</span><span class="p">(</span><span class="s1">&#39;static-photo-canvas&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Задаем их размеры</span>
</span><span class='line'><span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">setHeight</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.photo-canvas&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">());</span>
</span><span class='line'><span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">setWidth</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.photo-canvas&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">());</span>
</span><span class='line'><span class="nx">staticPhotoCanvas</span><span class="p">.</span><span class="nx">setHeight</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.photo-canvas&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">());</span>
</span><span class='line'><span class="nx">staticPhotoCanvas</span><span class="p">.</span><span class="nx">setWidth</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.photo-canvas&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Загружаем маску на статичный холст и устанавливаем ее по центру холста</span>
</span><span class='line'><span class="nx">fabric</span><span class="p">.</span><span class="nx">loadSVGFromURL</span><span class="p">(</span><span class="s1">&#39;/assets/first.svg&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">objects</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">mask</span> <span class="o">=</span> <span class="nx">fabric</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">groupSVGElements</span><span class="p">(</span><span class="nx">objects</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">staticPhotoCanvas</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">mask</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">mask</span><span class="p">.</span><span class="nx">center</span><span class="p">().</span><span class="nx">setCoords</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">staticPhotoCanvas</span><span class="p">.</span><span class="nx">renderAll</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Загружаем изображение на динамический холст, задаем высота и устанавливаем ее по центру</span>
</span><span class='line'><span class="nx">fabric</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">fromURL</span><span class="p">(</span><span class="s1">&#39;/assets/Cat.jpg&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">img</span><span class="p">.</span><span class="nx">scaleToHeight</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">img</span><span class="p">.</span><span class="nx">center</span><span class="p">().</span><span class="nx">setCoords</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">renderAll</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>
Мы добавили нашу маску на статичный canvas, и изображение &ndash; на динамический. Теперь код кнопки &ldquo;Обрезать&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#crop-button&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// Обрезаем холст</span>
</span><span class='line'>  <span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">clipTo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>           <span class="nx">staticPhotoCanvas</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">render</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">renderAll</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Сохраняем .png файл в переменную</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">dataUrl</span> <span class="o">=</span> <span class="nx">photoCanvas</span><span class="p">.</span><span class="nx">toDataURL</span><span class="p">(</span><span class="s1">&#39;png&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>
То есть мы обрезали наш canvas с фотографией по контору векторной маски и сохранили его в png файл, который хранится в переменной dataUrl.<br/>
Результат работ:<br/>
<img class="center" src="http://d.pr/i/LiuH+"><br/>
P.S. Если нужно создать canvas в модальном окне Bootstrap 3, то лучше создавать холст на событии &lsquo;shown.bs.modal&rsquo;. Иначе он не будет принимать pointer events.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CandyBox 2]]></title>
    <link href="http://goooseman.ru/2013/10/29/candybox-2/"/>
    <updated>2013-10-29T18:32:00+04:00</updated>
    <id>http://goooseman.ru/2013/10/29/candybox-2</id>
    <content type="html"><![CDATA[<p>Где-то в начале года я узнал о такой прекрасной игре, как CandyBox.<br/>
Игра сделана на JavaScript, вся графика &ndash; ASCII, но затягивает с удивительной скоростью. Прошел, понравилось, попробовал HardMode. Забил. Забыл.<br/>
<img class="center" src="http://d.pr/i/ovx9+"><br/>
И на прошлой неделе вышла <a href="http://candybox2.net/">вторая версия</a>. В ней наконец-то сделали autosave и менее линейную модель. Всем, кто видел первую часть играть обязательно. Я прошел за 3 дня. И снова забыл. (хотя обещают Arena мод, и сами участники могут создавать уровни).</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[И еще чуть чуть в продолжении темы]]></title>
    <link href="http://goooseman.ru/2013/06/20/i-ieshchie-chut%27-chut%27-v-prodolzhienii-tiemy/"/>
    <updated>2013-06-20T00:36:00+04:00</updated>
    <id>http://goooseman.ru/2013/06/20/i-ieshchie-chut&#8217;-chut&#8217;-v-prodolzhienii-tiemy</id>
    <content type="html"><![CDATA[<p>В продолжение <a href="http://goooseman.ru/2013/06/17/ios-7/">первого</a> и <a href="http://goooseman.ru/2013/06/18/i-ieshchie-niemnogho-ob-ios-7/">второго</a> постов&hellip;</p>

<!--more-->


<p>
А мне эта история напоминает историю с Windows 8. Желание кардинальных перемен, непринятое обществом. Люди, кричащие, что не перейдут на новую систему. Корпоративный сектор, не желающий обновляться&amp; Все негодуе. Ну кроме гиков, этим все по кайфу.</p>

<p>И что делает Microsoft? В следующем обновлении они сдались и решили сделать defalutный envinroment по выбору. То есть вы можете выбрать какой интерфейс будет загружаться по умолчанию.</p>

<p>Вот только Apple &ndash; не Microsoft. Они не признают ошибок, они доказывают свою правоту до тех пор, пока все не поверят в нее. (По крайней мере так было при Джобсе, Кук какой-то слишком мягкий в этом плане.) Они не сделают большую кнопку &ldquo;Вернуться к старому дизайну&rdquo;.</p>

<div>
   <table width="100%" height="100%" align="center" valign="center" cellpadding="0" cellspacing="0" border="0" style="background-color:white; border: 0px solid transparent;">
   <tr><td style="border: 0">
      <img src="http://d.pr/i/45r4+" width="40%" height="40%" />
   </td></tr>
   </table>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[И еще немного об iOS 7]]></title>
    <link href="http://goooseman.ru/2013/06/18/i-ieshchie-niemnogho-ob-ios-7/"/>
    <updated>2013-06-18T13:23:00+04:00</updated>
    <id>http://goooseman.ru/2013/06/18/i-ieshchie-niemnogho-ob-ios-7</id>
    <content type="html"><![CDATA[<p>Продолжая <a href="http://goooseman.ru/2013/06/17/ios-7/">вчерашний пост</a>&hellip;</p>

<!--more-->


<ul>
<li><p>Просто представьте&hellip; У Вас есть галимый продукт. Галимость &ndash; понятие весьма относительное. Так как сделать его менее галимым? Самый простой способ: показать сначала еще более галимый продукт, затем сделать его чуть лучше и на фоне того, что было раньше, конечный продукт не покажется уж совсем унылым говном. Но вряд ли Apple делают так спеиально, скорее оно само так выходит в данном случае.</p></li>
<li><p>До WWDC в информационном мире околояблочной тематики происходило дикое затишье. Единственные новости были &ndash; дикие предположения о том, как будет выглядеть iOS 7. Профильные сайты о Сасунгах писали больше, чем об iPhone. Так что именно сейчас Apple было выгодно выпустить что-то кардинально новое, чтобы о ней все говорили еще, как минимум, полгодика.</p></li>
<li><p>На WWDC 2012, показывая функции iOS 6 &ldquo;спалили&rdquo; iPhone 5:</p></li>
</ul>


<div>
   <table width="100%" height="100%" align="center" valign="center" cellpadding="0" cellspacing="0" border="0" style="background-color:white; border: 0px solid transparent;">
   <tr><td style="border: 0">
      <img src="http://d.pr/i/VXts+" width="80%" height="80%" />
   </td></tr>
   </table>
</div>


<p></p>

<div>  
   <table width="100%" height="100%" align="center" valign="center" cellpadding="0" cellspacing="0" border="0" style="background-color:white; border: 0px solid transparent;">
   <tr><td style="border: 0">
      <img src="http://d.pr/i/PpqR+" width="80%" height="80%" />
   </td></tr>
   </table>
</div>


<p>  <br/>
Тогда многие подняли эту версию насмех, но в сентябре месяце на презентации нового iPhone все стало ясно.<br/>
А теперь давайте посмотрим на то устройство, на котором показали нам iOS 7:</p>

<div>
   <table width="100%" height="100%" align="center" valign="center" cellpadding="0" cellspacing="0" border="0" style="background-color:white; border: 0px solid transparent;">
   <tr><td style="border: 0">
      <img src="http://d.pr/i/TyGG+" width="80%" height="80%" />
   </td></tr>
   </table>
</div>


<p>
Выглдядит странно, не так ли? Не похоже ни на одно устройство Apple. Так может нас сразу ждет iPhone 6, а не 5S? Может вместе с совершенно новой iOS сразу и выпустить совершенно новый iPhone?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS 7]]></title>
    <link href="http://goooseman.ru/2013/06/17/ios-7/"/>
    <updated>2013-06-17T10:59:00+04:00</updated>
    <id>http://goooseman.ru/2013/06/17/ios-7</id>
    <content type="html"><![CDATA[<p>С WWDC прошло уже 2 недели, но до сих пор бурления говна на счет новой iOS не утихают. Все спорят о том, удалась она или нет. Все показывают свое остроумие, придумывая &ldquo;смешные&rdquo; картинки с Джонни. Лебедев лишь прошелся по мелочам, так и не сказав свое мнение в общем.</p>

<p><img class="center" src="http://d.pr/i/NKFI+"></p>

<p>Но есть аспекты, о которых, на мой взгляд мало кто задумывается.</p>

<!--more-->


<p>Люди, касательно UI весьма консервативны. Да, гики хотят всего нового, да побольше, но обычные люди они не такие. Если мартышка привыкла 2 года жать кнопку и получать банан, то ей не понравится, если механизм получения награды изменится, даже если он станет в 10 раз удобней и легче. Знаете сколько я людей знаю, которые с iPhone и iPad заходят на vk.com через Safari, да еще и специально открывают именно десктопную версию. Может они не умеют устанавливать приложения из AppStore? Да нет, все умеют, и в Instagramмах есть. У некоторых есть отговорка, мол так удобно, так как они с компьютера часто заходят, и не хотят привыкать к двум интерфейсам сразу. Но я знаю много людей, которые, купив iPad перестали пользоваться компьютером, ибо больше браузера им ничего и не надо. Если нарисовать круги Эйлера, получаем такую картину:</p>

<div>
   <table width="100%" height="100%" align="center" valign="center" cellpadding="0" cellspacing="0" border="0" style="background-color:white; border: 0px solid transparent;">
   <tr><td style="border: 0">
      <img src="http://d.pr/i/ocm2+" width="70%" height="70%" />
   </td></tr>
   </table>
</div>


<p>
И таких консервативно настроенных к UI людей очень много. И им точно не понравится новый дизайн. Я тут поспрашивал, так они уже кричат &ldquo;Дуров, верни стену!&rdquo; Не зря китайцы говорят, &ldquo;Не дай вам бог жить во время перемен&rdquo;.</p>

<p>Бета ну очень сырая. Раньше первые беты были намного более стабильны. Прям таких лагов не было. Я не к тому, что &ldquo;При Джобсе такого не было&rdquo;, а к тому, что прошивку явно делали в спешке, чтобы успеть в WWDC. И многое еще успеют изменить. Точно будут менять иконки, <a href="http://www.latimes.com/business/technology/la-fi-tn-apple-alternate-ios-7-icons-20130614,0,3336441.story">их уже меняют</a>. Так что есть шанс, что к осени, оно будет выглядеть намного лучше, чем на WWDC.</p>

<p>iPad забыли? Раньше все беты были и на iPad тоже, ведь разрабам надо тестировать свои приложения. Теперь же беты на iPad нет. На презентации ни разу не показали новую iOS на большом брате iPhone. Это лишний раз доказывает, что они не успевали доделать прошивку к WWDC.</p>

<p>Так что ждем изменений. А мне iOS 7 нравится, за исключением многих иконок. Они тошнотоврны.</p>

<p><a href="http://goooseman.ru/2013/06/18/i-ieshchie-niemnogho-ob-ios-7/">Продолжение &rarr;</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Новая Опера]]></title>
    <link href="http://goooseman.ru/2013/06/11/novaia-opiera/"/>
    <updated>2013-06-11T12:39:00+04:00</updated>
    <id>http://goooseman.ru/2013/06/11/novaia-opiera</id>
    <content type="html"><![CDATA[<p>А мне нравится Opera Next. Все таки это alpha, и многие функции вернутся. Но начало уже радует, что-то в нем есть. Я люблю всё новое. Но вот одного я понять не могу.<br/>
<img src="http://d.pr/i/kM8C+"><br/>
Что такое &ldquo;Показать поля&rdquo;? При нажатии открывается окно загрузок. Не, я прекрасно понимаю, что это альфа, но откуда взялась эта фраза? Даже Google не переводит &ldquo;Downloads&rdquo; как &ldquo;Поля&rdquo;. Прям глаз режет.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Про Android...]]></title>
    <link href="http://goooseman.ru/2013/06/06/pro-android-dot-dot-dot/"/>
    <updated>2013-06-06T13:35:00+04:00</updated>
    <id>http://goooseman.ru/2013/06/06/pro-android-dot-dot-dot</id>
    <content type="html"><![CDATA[<p>Я люблю Android. Я достаточно долго &ldquo;сидел&rdquo; на iOS и WP7, но Android мне нравится больше, чем те двое вместе взятые. Но вот некоторые странности меня не перестают удивлять.</p>

<p>В Android есть системное приложение Google Play Services. Оно предостовляет доступ к API приложений Google сторонним разрабам. Но после его обновления до последней версии (а этого требуют многие приложения) происходит забавное: при установке apk файла (установочный файл приложения) не из Google Play нам предлагают не один установщик, а целых два:</p>

<div>
   <table width="100%" height="100%" align="center" valign="center" cellpadding="0" cellspacing="0" border="0" style="background-color:white; border: 0px solid transparent;">
   <tr><td style="border: 0">
      <img src="http://d.pr/i/jFWZ+" width="40%" height="40%" />
   </td></tr>
   </table>
</div>


<p>Второй как раз с иконкой того самого Google Play Services. Отличие только одно: второй как то проверяет файл перед установкой, потом передает установку тому самому первому установщику. Конечно баг не критичный, но он присутствует у всех, я его проверил на версиях Android 2.3, 4.0.4, 4.1.2, и везде он есть. Ну ОК, конечно они молодцы, что внедрили хотя бы какую-то базовую проверку файла на наличие всяких там вирусов, но почему нельзя было заменить старый установщик, а не предлагать юзеру сразу два.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Попал под раздачу РосКомНадзора]]></title>
    <link href="http://goooseman.ru/2013/05/29/popal-pod-razdachu-roskomnadzora/"/>
    <updated>2013-05-29T09:29:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/29/popal-pod-razdachu-roskomnadzora</id>
    <content type="html"><![CDATA[<p>У меня есть домен <a href="http://goooseman.ru">goooseman.ru</a>, делегированный на <a href="http://hostinger.ru">hostinger.ru</a>. Почему именно там? У них один из лучших бесплатных хостингов, на мой взгляд. Именно бесплатных. Сам блог находится на <a href="http://github.com">ГитХабе</a>, но есть одна, важная для меня хреновина, которая хостится на этом самом бесплатном хостинге. Хреновина эта &ndash; php скриптик, который собирает информацию из POST запросов, отправляемых ему моей программой <a href="http://goooseman.ru/rutracker-updater/">RuTracker Updater</a>, и записывает в базу данных. То есть ведет статистику. И еще есть маленький скриптик, который отдает содержимое базы данных в виде .csv файла (чтобы легко скачать можно было wgetом).</p>

<p>И в один прекрасный день, мне wget возвращает совершенно пустой файл. Иду разбираться и вижу:<br/>
<img src="http://d.pr/i/9ntv+"></p>

<!--more-->


<p>
Запрещенной информации там быть не может, ибо там нет вообще никакой информации. Так что варианта аж две штуки: или ошибка или бан по IP.</p>

<p>Идем на <a href="http://www.zapret-info.gov.ru/">zapret-info.gov.ru</a>, вводим IP и танцуем лезгинку на могиле пункта 5 статьи 29 Конституции РФ:<br/>
<img src="http://d.pr/i/AJJD+"></p>

<p>То есть какой-то ужасный человек вымещает детскую порнографию, где <del>говорят, что Путин &ndash; краб, </del> юзают наркотики, кончают жизнь самоубийством, а страдать должны все? Причем у них же есть инструмент, банящий не по IP, а по домену. Да они даже конкретную страницу могут забанить. Так какого хрена тогда они делают? Хотя, кого ебет чужое горе&hellip;</p>

<p>Что будем делать? Пути есть два: писать хостеру или писать этому страшному РосКомНадзору. Мы трудных путей не ищем, по этому решил начать с хостера. Написал вчера письмо: <br/>
<img src="http://d.pr/i/Dy8h+"><br/>
Обещали ответить в течение 24 часов, предложив перейти на платный план, где время ожидания составляет 2-3 часа. Спасибо, не надо.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[А ты можешь спать спокойно?]]></title>
    <link href="http://goooseman.ru/2013/05/16/a-ty-mozhiesh%27-spat%27-spokoino/"/>
    <updated>2013-05-16T09:42:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/16/a-ty-mozhiesh&#8217;-spat&#8217;-spokoino</id>
    <content type="html"><![CDATA[<p>В госдуме обсждается законопроект, по которому чиновники будут иметь право изъять землю на нужды чемпионата мира по футболу 2018 года. Конечно, рыночная стоимость возвращается владельцу и сам факт может быть оспорен в суде. Но на кой черт такой маленький срок? До чемпионата еще больше 4х лет, или они уже сейчас поняли, что все будут делать в последний момент?</p>

<p>А еще этой весной был принят законопроект, упрощающий процесс изъятия земель в Новой Москве и в Подмосовье. Правда тут срок уже не неделя, а три месяца, но все же хороший репресивный инструмент, чтобы карать &ldquo;врагов народа&rdquo;.</p>

<p>В сочах же сейчас могут изъять землю за 1 месяц.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Горе киллер]]></title>
    <link href="http://goooseman.ru/2013/05/15/gorie-killier/"/>
    <updated>2013-05-15T09:45:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/15/gorie-killier</id>
    <content type="html"><![CDATA[<p>Представьте, что Вы такой обычный житель подмосковья. Только с судимостями. И вот к Вам приходит крутой бизнесмен из Питера и предлагает всего лишь убить человека за почти 3 ляма рублей. Ну кто откажется от такого? 3 ляма то на дороге не валяются.</p>

<p>Вроде история банальная, но кульминация заставляет подумать о том, что если уж нужен киллер, то лучше проффесионал:</p>

<div class="video-container">
    <iframe width="560" height="315" src="http://www.youtube.com/embed/eFViKTdRiRA" frameborder="0" allowfullscreen></iframe>    
</div>


<p>Киллер подходит, делает выстрел через пакет. Но вот беда, пистолет заклинило! Киллер убегает от жертвы, но увидев, что жертва сама убегает от него, бежит обратно. На полпути вспоминает, что пистолет то заклинило и бежит уже от жертвы обратно. Каламбур, блин.<br/>
Ясен хрен его поймали, так что не пытайтесь повторить это дома.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Только 18% людей в этой стране имеют загран]]></title>
    <link href="http://goooseman.ru/2013/05/14/tol%27ko-18-percent-liudiei-v-etoi-stranie-imieiut-zaghran/"/>
    <updated>2013-05-14T09:54:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/14/tol&#8217;ko-18-percent-liudiei-v-etoi-stranie-imieiut-zaghran</id>
    <content type="html"><![CDATA[<p>По данным ФМС на 2010 год примерно 18% людей в этой стране имеют загранпаспорт, <a href="http://www.interfax.ru/tourism/tourisminf.asp?sec=1466&amp;id=132720">сообщает</a> Интерфакс. По статистическим данным Левада-Центра загран имеют 17% россиян.</p>

<p>Это конечно печально, но все мы помним железный занавес, и нежелание народа сидеть в этой стране легко объяснить. Прибавив бедность и возможность поехать на Украину или в Белорусь без загранника, понимаем, что в этом факте вообще ничего удивительного нет.</p>

<p>Просто на этом фоне забавно выглядит <a href="http://travel.mail.ru/world/europe/russian_federation/news/46005/pochti_90_procentov_grazhdan_rossii_imeyut_zagranpasport/">статья на mail.ru</a> за 2008 год, в которой они утверждают, что загран получили 90% граждан.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Есть лишние 6.500.0000$? Надоела благотворительность? Можете сделать цепочку домино из 10.000 iPhone.]]></title>
    <link href="http://goooseman.ru/2013/05/05/iest%27-lishniie-6-dot-500-dot-0000-nadoiela-blaghotvoritiel%27nost%27-mozhietie-sdielat%27-tsiepochku-domino-iz-10-dot-000-iphone/"/>
    <updated>2013-05-05T16:02:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/05/iest&#8217;-lishniie-6-dot-500-dot-0000-nadoiela-blaghotvoritiel&#8217;nost&#8217;-mozhietie-sdielat&#8217;-tsiepochku-domino-iz-10-dot-000-iphone</id>
    <content type="html"><![CDATA[<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/tj7al6MXu7U" frameborder="0" allowfullscreen></iframe>     
</div>


<p>
На самом деле это компьютерная графика, но никто Вам не мешает повторить такое в живую.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[День народного единства]]></title>
    <link href="http://goooseman.ru/2013/05/05/dien%27-narodnogho-iedinstva/"/>
    <updated>2013-05-05T13:21:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/05/dien&#8217;-narodnogho-iedinstva</id>
    <content type="html"><![CDATA[<p>Восемь лет назад у нас на календарях появился такой праздник, как &ldquo;День Народного Единства&rdquo;.<br/>
Итак, теперь мы 4 ноября празднуем изгнание поляков с земли Русской. Но в нашей истории есть и немало других немаловажных дат. Почему наши власти выбрали именно это событие, чтобы ежегодно отмечать его?</p>

<!--more-->


<h3>Единения ли ради?</h3>

<p>Давайте вспомним историю. Поляки, воспользовавшись ослаблением страны, захватили власть и угнетали бедный русский люд. Люду это, само собой не нравилось, но в одиночку идти против власти бессмысленно. Князь Минин и купец Пожарский тайно начали собирать ополчение, сплотив народ против общего врага. В итоге Лжедмитрия II поймали, жестоко убили, а прах отправили пушкой в сторону Польши.
Что в этой истории главное? Идея того, что народ объединился, несмотря на свои какие-либо внутренние неприязни, против общей проблемы и решил ее. А население нашей страны сейчас неплохо так дефрагментировано, так почему бы не сделать праздник, который поможет народу задуматься о единстве нашей страны в общем, и о единстве ее населении в частности.</p>

<p>Хорошая идея, но есть два но:</p>

<ul>
<li>Мало кто, отмечая этот праздник, помнит кто такие эти самые Минин и Пожарский.</li>
<li>Есть причина по важнее.</li>
</ul>


<h3>Причина по важнее</h3>

<p>Дело в том, что, когда существовал Советский Союз, в стране было два главных праздника: День труда и День Великой Октябрьской социалистической революции. Второй приходился на 7 ноября, и народ уже привык <del>бухать</del> расслабляться в это время. В 1996 году его переименовали в &ldquo;День согласия и примирения&rdquo;. День согласия и примирения с чем? С Великой Октябрьской Революцией? В один момент, кто-то подумал, что хватит уж отмечать эту дату. Но рефлекс бухать, выработанный недолгой историей СССР, уже не отнимешь у народа, и умным людям дали задание придумать что-то. Так и появился у нас этот светлый праздник. А Минин и Пожарский здесь не при чем, просто прогнали поляков они в нужное время.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Самая лучшая защита от копирования материалов сайта]]></title>
    <link href="http://goooseman.ru/2013/05/05/samaia-luchshaia-zashchita-ot-kopirovaniia-matierialov-saita/"/>
    <updated>2013-05-05T12:28:00+04:00</updated>
    <id>http://goooseman.ru/2013/05/05/samaia-luchshaia-zashchita-ot-kopirovaniia-matierialov-saita</id>
    <content type="html"><![CDATA[<p>На <a href="http://www.fanty.ru/">fanty.ru</a>   самая бестолковая защита от копирования материалов сайта. Это реально пиздец какой-то, придуманный только для защиты от детей блондинок. Вся система заключается в том, что при нажатии на правую кнопку мыши в любом месте сайта появляется алерт:<br/>
<img src="http://d.pr/i/N0cB+"><br/>
Ну что за люди!? Во-первых, на правой кнопкой кроме <del>спиздить</del> скопировать есть еще не мало других действий. Во-вторых, выделить текст Вам никто не мешает, а cmd+c, Изменить->Скопировать работают. Да к тому же всегда можно открыть исходник страницы.<br/>
И что получается? Умный пользователь все равно возьмет то, что ему нужно взять, а глупый даже не сможет открыть страницу в новой вкладке.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Китайская сторона Москвы]]></title>
    <link href="http://goooseman.ru/2013/04/28/kitaiskaia-storona-moskvy/"/>
    <updated>2013-04-28T15:01:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/28/kitaiskaia-storona-moskvy</id>
    <content type="html"><![CDATA[<div class="video-container">
    <iframe width="480" height="360" src="http://www.youtube.com/embed/2afP_xOWOuo" frameborder="0" allowfullscreen></iframe>     
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[10 негритят]]></title>
    <link href="http://goooseman.ru/2013/04/28/10-nieghritiat/"/>
    <updated>2013-04-28T13:41:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/28/10-nieghritiat</id>
    <content type="html"><![CDATA[<p><img src="https://upload.wikimedia.org/wikipedia/ru/thumb/1/12/10_%D0%BD%D0%B5%D0%B3%D1%80%D0%B8%D1%82%D1%8F%D1%82.JPG/190px-10_%D0%BD%D0%B5%D0%B3%D1%80%D0%B8%D1%82%D1%8F%D1%82.JPG"><br/>
Только недавно узнал, что известный роман Агаты Кристи &ldquo;10 негритят&rdquo; в штатах с самого начала издавалась под названием &ldquo;And Then There Were None&rdquo; из соображений политкорректности.</p>

<!--more-->


<p>И вот тут мы сталкиваемся с тем, что одни и те же вещи звучат на разных языках совершенно по-разному. По-русски &ldquo;10 негритят&rdquo; звучит совершенно безобидно. Да даже, если бы у нас было также много <del>нигеров</del> афрорусских, мало бы кого смогло обидеть название &ldquo;10 негритят&rdquo;. А вот по-английски &ldquo;10 little niggers&rdquo; звучит совершенно по другому. Причем не только из-за самого слово &ldquo;nigger&rdquo;. Хотя не, именно из-за него, ведь только нигер может называть нигера нигером. А Агата Кристи, как известно, далеко не <del>нигер</del> афроангличанка:<br/>
<img src="http://the100.ru/images/womens/id918/334-f6cee3c327d8442c33b7dc77e39.jpg"><br/>
А помните стих-считалку из этого произведения? По-русски в разных переводах оно звучит по-разному, мне лично больше всего этот вариант:</p>

<blockquote><p>Десять негритят собрались пообедать, <br/>Один вдруг поперхнулся – и их осталось девять. </p><p>Девять негритят уселись под откосом, <br/>Один из них заснул – и их осталось восемь. </p><p>Восемь негритят поплыли в Ноттингем, <br/>Одни из них пропал – и их осталось семь. </p><p>Семь глупых негритят на дуб решили влезть, <br/>Один из них упал – и их осталось шесть. </p><p>Шесть негритят у пчел решили меду взять, <br/>Закусан один был – и их осталось пять. </p><p>Пять глупых негритят судейство учинили, <br/>Один в тюрьму попал – и стало их четыре. </p><p>Три глупых негритенка опомнились едва, <br/>Но тут пришел медведь – и их осталось два. </p><p>Последний негритенок не делал ничего, <br/>Когда же он женился, не стало никого!</p></blockquote>


<p>
Американцы снова же заменили нигеров на индейцев, а в некоторых изданиях на солдатиков. Так то.</p>

<p>Также одно из издательств США решило сделать политкорректное издания &ldquo;Приключения Тома Сойера&rdquo; и &ldquo;Приключения Гекльберри Финна&rdquo;, убрав, снова же, слово &ldquo;нигер&rdquo; на &ldquo;раб&rdquo;.</p>

<p>Подождите&hellip; А как же &ldquo;Жизнь и удивительные приключения Робинзона Крузо&rdquo;? А как же &ldquo;Убить пересмешника&rdquo;? А &ldquo;Вокруг света за 80 дней&rdquo;?<br/>
Да и давно уже переименовать страну &ldquo;Нигер&rdquo; в <del>Афроамериканию</del> Афроафриканию.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Пиздить то можно не только у Apple...]]></title>
    <link href="http://goooseman.ru/2013/04/28/pizdit%27-to-mozhno-nie-tol%27ko-u-apple-dot-dot-dot/"/>
    <updated>2013-04-28T11:24:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/28/pizdit&#8217;-to-mozhno-nie-tol&#8217;ko-u-apple-dot-dot-dot</id>
    <content type="html"><![CDATA[<p><img src="http://d.pr/i/34iz+"><br/>
Слева &ndash; Nokia 6300 (год выпуска: 2007), справа &ndash; Samsung GT-C3322 (год выпуска: 2011).</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Руки надо отрывать таким дизайнерам...]]></title>
    <link href="http://goooseman.ru/2013/04/23/ruki-nado-otryvat%27-takim-dizainieram-dot-dot-dot/"/>
    <updated>2013-04-23T10:46:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/23/ruki-nado-otryvat&#8217;-takim-dizainieram-dot-dot-dot</id>
    <content type="html"><![CDATA[<p>Недавно по всей Москве появилась реклама от МТС следующего содержания:<br/>
<img src="http://d.pr/i/GbFP+"></p>

<!--more-->


<p>В чем проблема? Есть два типа кнопок выбора чего-либо:</p>

<ul>
<li><img src="http://www.scip.be/ImagesVisualStyles/Button.CheckBox.CheckedNormal_Blue.png"> Checkbox button</li>
<li><img src="http://www.scip.be/ImagesVisualStyles/Button.RadioButton.CheckedNormal_Blue.png"> Radio button</li>
</ul>


<p>Отличие radio от checkbox в том, что radio button допускает выбор только одного пункта из нескольких, а checkbox &ndash; любого количества пунктов (если не заданы дополнительные параметры).</p>

<p>Можно предположить, что дизайнеры не знают разницы между ними. Предположили. Но это же не ООО &ldquo;СельХозМебель&rdquo;, это же МТС! А МТС, как известно технологическая компания с большим штатом сотрудников. И я не понимаю, почему никто в такой компании не заметил такую оплошность.</p>

<p>Хотя, может быть, только я замечаю такие вот мелочи? И, может быть, только меня они раздражают?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Вам не хватает скайпа? Потрогайте своего собеседника через интернет!]]></title>
    <link href="http://goooseman.ru/2013/04/22/vam-nie-khvataiet-skaipa-potroghaitie-svoiegho-sobiesiednika-chieriez-intierniet/"/>
    <updated>2013-04-22T08:50:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/22/vam-nie-khvataiet-skaipa-potroghaitie-svoiegho-sobiesiednika-chieriez-intierniet</id>
    <content type="html"><![CDATA[<p><img src="http://d.pr/i/kTkO+"><br/>
Небезизвестная компания Durex представила свою новую разработку. Интересно что же это может быть?</p>

<!--more-->


<p><em>Fundawear</em> &ndash; нижнее нанобельё. Женщинам &ndash; стринги и бюстгальтер, мужчинам &ndash; трусы, но можно поменяться, если очень хочется. В белье вшиты специальные подушечки, имитирующие касания, и микроконтролер Arduino, принимающий комманды с iPhone.</p>

<p>А если проще, то вы можете общаться с человеком по скайпу, виртуально трогая его самые интимные зоны через iPhone. Выглядит это вот так:</p>

<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/qb7DN3kpl2o" frameborder="0" allowfullscreen></iframe>    
</div>


<p>Одному управлять своим бельем не выйдет, нужен обязательно партнер. Судя по скринам должна быть пара мужчина-женщина, а это дискриминация.<br/>
Сколько стоит? Хороший вопрос. Это всего лишь прототип. Но, если Вы живете в Австралии, можете попробовать поучаствовать в <a href="https://www.facebook.com/Durex.Australia/app_493857570680544">конкурсе</a>. Надо рассказать о том, как вы будете их использовать с партнером, и автор самого креативного ответа получит белье, 500$ и два номера в пятизвездночном отеле.<br/>
Есть еще два видео. Первое о технологическом аспекте:</p>

<div class="video-container">
<iframe width="640" height="360" src="http://www.youtube.com/embed/T6vul95hwOY" frameborder="0" allowfullscreen></iframe>
</div>


<p>  Второе о дизайнерском:</p>

<div class="video-container">
<iframe width="640" height="360" src="http://www.youtube.com/embed/KHRpJXRwdXk" frameborder="0" allowfullscreen></iframe>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[А может все таки ввести порку за вождение пьяным? Публичную. На красной площади.]]></title>
    <link href="http://goooseman.ru/2013/04/19/a-mozhiet-vsie-taki-vviesti-porku-za-vozhdieniie-p%27ianym-publichnuiu-na-krasnoi-ploshchadi/"/>
    <updated>2013-04-19T09:34:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/19/a-mozhiet-vsie-taki-vviesti-porku-za-vozhdieniie-p&#8217;ianym-publichnuiu-na-krasnoi-ploshchadi</id>
    <content type="html"><![CDATA[<p>Ну вот на хрена ночью на Садовом по встречке ехать? Ну пробок же нет! Да даже будучи в гавно пьяным, как ему такая мысль пришла? В итоге: трое на смерть, виновник в тяжелом. Авария произошла на мосту над Цветным бульваром &ndash; Олимпийским проспектом. Одна из машин, пробила ограждение, остановившись `на краю моста.</p>

<div class="video-container">     
<object width='640' height='468'><param name='movie' value='http://www.m24.ru/v/17037'></param><param name='wmode' value='transparent'></param><param name='allowScriptAccess' value='always'></param><param name='allowFullScreen' value='true'></param><embed src='http://www.m24.ru/v/17037' type='application/x-shockwave-flash' wmode='window' width='640' height='468' allowFullScreen='true' allowScriptAccess='always'></embed></object>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Новости из мира Apple]]></title>
    <link href="http://goooseman.ru/2013/04/16/novosti-iz-mira-apple/"/>
    <updated>2013-04-16T10:31:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/16/novosti-iz-mira-apple</id>
    <content type="html"><![CDATA[<p>Обычно новости про всякие нелепости, хоть как то связанные с Apple, появляются на всех крупных русскоязычных сайтах, связанных с Apple (<a href="http://iphones.ru">iPhones.ru</a>, <a href="http://appleinsider.ru">AppleInsider.ru</a>, <a href="http://deepapple.com">DeepApple.com</a>). Но эти две новости появились почему-то только на <a href="http://deepapple.com">DeepApple</a>.</p>

<!--more-->


<h2>Не оставляйте iPad на крыше машины</h2>

<p><img src="http://www.iphonedaily.ru/content/2013/1988/iphonedaily_ru_1988_1.jpg"><br/>
Отец некой девушки однажды заметил странное: у машины дочери в переднем бампере торчал iPad. После извлечения его оттуда, не без помощи молотка, они были приятно удивлены, что iPad, несмотря на многочисленные повреждения, был в рабочем состоянии. Найдя информацию о владельце в iPadе, они связались с владельцем, и вот что выяснили: несчастный автолюбитель забыл iPad на крыше своего автомобиля, и поехал. В один момент iPad слетел и прилетел в бампер бедной девушки. Обо всем этом и многое другое в видеосюжете:</p>

<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/oP5sPUOskd4" frameborder="0" allowfullscreen></iframe>   
</div>


<p>
Зато сколько шуток на тему &ldquo;У iPhone есть Bumper, а у iPad нету, вот он и решил его &#8220;приобрести&rdquo;&ldquo;.</p>

<p>P.S. На прошлой неделе разбил свой Nexus 7 3G, так у него сразу тач перестал работать. А тут прилител в бампер и работает.</p>

<h2>А вам слабо?</h2>

<p>Некий житель Пекина наловчился вытягивать палочками для еды вещи из карманов велосипедистов. И не плохо заработовал, пока его не &ldquo;спалила&rdquo; камера:<br/>
<img src="http://d.pr/i/nOZU+"><br/>
<img src="http://d.pr/i/X4OU+"><br/>
<img src="http://d.pr/i/5XVx+"><br/>
<img src="http://d.pr/i/3S9w+">
<img src="http://d.pr/i/nNxm+"><br/>
Эти фотографии были выложены в СМИ, в итоге несчастный воришка пришел сам сдаваться в полицию, и признался, что воровал для своей 12-летней дочери:<br/>
<img src="http://d.pr/i/Q1Ow+"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Инфографика по статистике моего блога]]></title>
    <link href="http://goooseman.ru/2013/04/16/infoghrafika-po-moiemu-bloghu/"/>
    <updated>2013-04-16T09:54:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/16/infoghrafika-po-moiemu-bloghu</id>
    <content type="html"><![CDATA[<p>Нашел <a href="https://create.visual.ly/graphic/google-analytics/">интересный сервис</a>, который собирает интересную инфографику по Вашему сайту, опираясь на данные Google Analytics. И даже умеет ее вам раз в неделю присылать на почту.</p>

<!--more-->


<p>Вот инфографика по моему блогу:</p>

<p><img src="http://d.pr/i/VUNv+"></p>

<p>Правда, чтобы получить такую инфорграфику, приходится регистрироваться. Но оно того стоит: на сайте есть еще много интересной инфографики, вот например весьма спорная информация, под названием &ldquo;Падение Apple&rdquo;:</p>

<div class='visually_embed' data-category='Computers' rel='infographic'>
            <img class='visually_embed_infographic' src='http://thumbnails.visually.netdna-cdn.com/the-fall-of-apple_516c71bd41617_w587.jpg' rel='http://thumbnails.visually.netdna-cdn.com/the-fall-of-apple_516c71bd41617.jpg' alt='The Fall of Apple' />
            <div class='visually_embed_bar'>
                <span class='visually_embed_cycle'><a href="http://visual.ly/fall-apple/?utm_source=visually_embed"></a> </span>
            </div>
            <a id='visually_embed_view_more' target='_blank' href='http://visual.ly/fall-apple?utm_source=visually_embed'></a>
            <link rel='stylesheet' type='text/css' href='http://visual.ly/embeder/style.css' />
            <script type='text/javascript' src='http://visual.ly/embeder/embed.js'></script>
        </div>


<p>Или про глобальное потепление:</p>

<div class='visually_embed' data-category='Computers' rel='infographic'>
            <img class='visually_embed_infographic' src='http://thumbnails.visually.netdna-cdn.com/when-sea-levels-attack_50290a5ae4576_w587.jpg' rel='http://thumbnails.visually.netdna-cdn.com/when-sea-levels-attack_50290a5ae4576.jpg' alt='When Sea Levels Attack!' />
            <div class='visually_embed_bar'>
                <span class='visually_embed_cycle'><a href="http://visual.ly/when-sea-levels-attack/?utm_source=visually_embed"></a> </span>
            </div>
            <a id='visually_embed_view_more' target='_blank' href='http://visual.ly/when-sea-levels-attack?utm_source=visually_embed'></a>
            <link rel='stylesheet' type='text/css' href='http://visual.ly/embeder/style.css' />
            <script type='text/javascript' src='http://visual.ly/embeder/embed.js'></script>
        </div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[А теперь тоже самое на Obj-C]]></title>
    <link href="http://goooseman.ru/2013/04/13/a-tiepier%27-tozhie-samoie-na-obj-c/"/>
    <updated>2013-04-13T15:29:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/13/a-tiepier&#8217;-tozhie-samoie-na-obj-c</id>
    <content type="html"><![CDATA[<p><a href="http://goooseman.ru/2013/04/13/iesli-khochiesh%27/">В прошлом посте</a> я писал про скрипт на bash, который скачивает .torrent файлы с rutracker.org, используя bash. Ради эксперимента решил реализовать такой код на Obj-C.</p>

<!--more-->


<div><script src='https://gist.github.com/5378021.js'></script>
<noscript><pre><code>//  RutrackerSimpleDownload
//  Created by Alexander Gusev on 12.04.13.
//  Copyright (c) 2013 Alexander Gusev. All rights reserved.
//  http://goooseman.ru


        // Variables //
      
        NSString *username = @&quot;&quot;;
        NSString *password = @&quot;&quot;;
        NSInteger fileID = 4296614;
        NSString *fileLocation = @&quot;/Users/goooseman/Downloads/&quot;; //should be /path/to/file/ not /path/to/file. ~ doesn&#39;t work here
        
        // Login Session (Getting cookies) //
        
        NSURL *loginUrl = [NSURL URLWithString:@&quot;http://login.rutracker.org/forum/login.php&quot;];
        NSMutableURLRequest *loginRequest = [NSMutableURLRequest requestWithURL:loginUrl];
        NSHTTPURLResponse *loginResponse;
        NSError* loginError;
        
        NSString *post = [NSString stringWithFormat:@&quot;login_username=%@&amp;login_password=%@&amp;login=Вход&quot;, username, password];
        NSLog(@&quot;%@&quot;, post);
        NSData *postData = [post dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
        
        [loginRequest setValue:[NSString stringWithFormat:@&quot;%ld&quot;,[postData length]] forHTTPHeaderField:@&quot;Content-Length&quot;];
        [loginRequest setTimeoutInterval:15];
        [loginRequest setHTTPBody:postData];
        [loginRequest setHTTPMethod:@&quot;POST&quot;];
        [loginRequest setHTTPShouldHandleCookies:YES];
        
        [NSURLConnection sendSynchronousRequest:loginRequest returningResponse:&amp;loginResponse error:&amp;loginError];
        

    
        
        // Download file //
        
        NSURL *torrentUrl = [NSURL URLWithString:[NSString stringWithFormat:@&quot;http://dl.rutracker.org/forum/dl.php?t=%ld&quot;, fileID]];
        NSLog(@&quot;%@&quot;, torrentUrl);
        NSHTTPURLResponse *torrentResponse;
        NSError *torrentError;
        NSMutableURLRequest *torrentRequest = [NSMutableURLRequest requestWithURL:torrentUrl];
        
        NSString *torrentPost = [NSString stringWithFormat:@&quot;t=%ld&quot;, fileID];
        NSData *torrentPostData = [torrentPost dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
        
        [torrentRequest setValue:[NSString stringWithFormat:@&quot;%ld&quot;,[postData length]] forHTTPHeaderField:@&quot;Content-Length&quot;];
        [torrentRequest setHTTPShouldHandleCookies:YES];
        [torrentRequest setHTTPBody:torrentPostData];
        [torrentRequest setHTTPMethod:@&quot;POST&quot;];
        [torrentRequest setValue:[NSString stringWithFormat:@&quot;t:%ld&quot;, fileID] forHTTPHeaderField:@&quot;header&quot;];
        [torrentRequest setValue:[NSString stringWithFormat:@&quot;http://rutracker.org/forum/viewtopic.php?t=%ld&quot;, fileID] forHTTPHeaderField:@&quot;Referer&quot;];
        
        
        NSData *torrentUrlConnection = [NSURLConnection sendSynchronousRequest:torrentRequest returningResponse:&amp;torrentResponse error:&amp;torrentError];
        
        [torrentUrlConnection writeToFile:[NSString stringWithFormat:@&quot;%@[rutracker.org].t%ld.torrent&quot;, fileLocation, fileID] atomically:YES];
        </code></pre></noscript></div>


<p>Знаете, что мне не нравится? Когда логинишься на rutracker.org с другого клиента, авторизация на всех других слетает. Видимо у них одновременно может существовать только одна валидная кука. В хроме приходится заново логинится каждый раз после использования этого кода. Хорошо, что код использует системный cookie jar (который использует Safari), благодаря этому авторизация в Safari не слетает.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Если хочешь, чтобы дело было сделано хорошо, сделай его сам]]></title>
    <link href="http://goooseman.ru/2013/04/13/iesli-khochiesh%27/"/>
    <updated>2013-04-13T06:41:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/13/iesli-khochiesh&#8217;</id>
    <content type="html"><![CDATA[<p>Нужен был скрипт на баше или на python, который бы скачивал .torrent файлы с rutracker.org. Сложность задачи в том, что rutracker не дает файлы напрямую, а пишет, мол зайдите со страницы форума.</p>

<p>Я нашел аж 7 скриптов, но не один из них не работал as is. Даже после косметической правки. Поэтому, опираясь на опыт других, быстро написал свою балалайку.</p>

<!--more-->


<div><script src='https://gist.github.com/5376630.js'></script>
<noscript><pre><code>#!/bin/bash
## Rutracker Downloader by goooseman.ru ##
## Created on 13th of April 2013 ##


## Variables ##
USERNAME=
PASSWORD=
TORRENTID=$1

## Variables checking ##
if [ ! $TORRENTID ];
  then
  echo Please use it as &quot;scriptname.sh &lt;topicid&gt;&quot;
    echo Topicid is the number at the end of the topic link. 
    echo Example: link is &quot;http://rutracker.org/forum/viewtopic.php?t=4246831&quot;
    echo Command is: ./RutrackerDownloader.sh 4246831
    exit 1
fi

if  [ -z $USERNAME ] || [ -z $PASSWORD ];
    then 
    echo Please setup USERNAME and PASSWORD variables 
    exit 1
fi



## Saving cookies ##
if [ ! -f cookies.txt ];
    then
    echo
    echo Saving cookies to cookies.txt...
    wget --user-agent=Mozilla/5.0 --save-cookies cookies.txt --post-data &quot;login_username=$USERNAME&amp;login_password=$PASSWORD&amp;login=Вход&quot; --no-check-certificate http://login.rutracker.org/forum/login.php
    echo Cookies saved...
    echo 
fi

## Downloading file ##
echo
echo Downloading .torrent...
wget --keep-session-cookies --load-cookies cookies.txt  --referer=&#39;http://rutracker.org/forum/viewtopic.php?t=&#39;$TORRENTID --header=&#39;Content-Type:application/x-www-form-urlencoded&#39; --header=&#39;t:&#39;$TORRENTID --post-data=&#39;t=&#39;$TORRENTID http://dl.rutracker.org/forum/dl.php?t=$TORRENTID -O [rutracker.org].t$TORRENTID.torrent
echo .torrent saved
echo

## Removing tmp files ##

if [ -f login.php ];
    then
    echo 
    echo Removing login.php...
    rm login.php*
    echo login.php deleted
fi
</code></pre></noscript></div>


<p>В первый раз скрипт сохраняет куки в файл cookies.txt, который потом используется. Чтобы обойти ограничение на прямое скачивание используется referer=&ldquo;страница топика&rdquo;.
Зачем оно надо? Для автоматизации процесса поиска новых серий в раздачах. Скоро этим займусь.</p>

<p>P.S. На маке для запуска скрипта понадобится wget. Скачать его можно, например, через <a href="http://mxcl.github.io/homebrew/">Homebrew</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Что такое Bitcoin?]]></title>
    <link href="http://goooseman.ru/2013/04/11/chto-takoie-bitcoin/"/>
    <updated>2013-04-11T22:24:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/11/chto-takoie-bitcoin</id>
    <content type="html"><![CDATA[<p>Нашел два интересных видео, поясняющих что такое Bitcoin.</p>

<!--more-->


<div class="video-container">
<iframe src="http://player.vimeo.com/video/63502573" width="500" height="281" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe> <p><a href="http://vimeo.com/63502573">Bitcoin Explained</a> from <a href="http://vimeo.com/duncanelms">Duncan Elms</a> on <a href="http://vimeo.com">Vimeo</a>.</p>  
</div>


<p></p>

<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/Um63OQz3bjo" frameborder="0" allowfullscreen></iframe>     
</div>


<p>Но чтобы действительно понять, что такое Bitcoin, придется почитать <a href="https://ru.bitcoin.it/wiki/%D0%97%D0%B0%D0%B3%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">wiki</a> или <a href="http://habrahabr.ru/search/?q=%5Bbitcoin%5D&amp;target_type=posts">статьи на хабре</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Борьба с курением?]]></title>
    <link href="http://goooseman.ru/2013/04/10/bor%27ba-s-kurieniiem/"/>
    <updated>2013-04-10T12:34:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/10/bor&#8217;ba-s-kurieniiem</id>
    <content type="html"><![CDATA[<p><img class="center" src="http://d.pr/i/yhy0+"></p>

<p>Вот почему у нас так часто получается, что хотели как лучше, а получилось&hellip; как всегда?<br/>
4 года назад производителей сигарет обязали печатать на пачках их максимальную розничную цену. Продавцов же обязали продавать сигареты по цене, не превышающей указанную. Прошло 4 года&hellip;</p>

<!--more-->


<h3>Идея</h3>

<p>Зачем это было сделано? Надеялись, что ограничив максимальную розничную цену, продавцам будет не выгодно заниматься продажей сигарет, и станет меньше мест, где они продаются. На самом же деле маржа конечно снизилась, но не настолько, чтобы бизнес перестал быть рентабельным. Тем более у сигарет большой срок годности, что положительно влияет на их окупаемость. Так что здесь практически ничего не изменилось.</p>

<h3>Исполнение</h3>

<p>За исполнением закона стараются следить. Или делают вид, что стараются. Первое время полиция (тогда еще милиция) отчитывалась о найденных нарушителях.  Каждый, кто заметил нарушение, может позвонить в РосПотребНадзор и заявить об этом. В Москве я давно уже не видел, чтобы в магазине продавались сигареты по цене большой указанной на пачке, так что можно сказать, что закон работает. Или нет?</p>

<h3>Темная сторона вопроса</h3>

<p>Многие отмечают тот факт, что этот закон сдерживает цены на сигареты. То есть без него сигареты бы стоили дороже. Да и стабильность цен привлекает людей. Вот и получается, что хотели как лучше, а получилось только облегчили курильщикам жизнь.</p>

<h3>Набор курильщика</h3>

<p>Как известно, в барах и ресторанах сигареты всегда стоили на порядок дороже. И после принятия этого закона, они придумали такую уловку, чтобы продавать сигареты дороже: они Вам предлагают купить не просто сигареты, а &ldquo;набор курильщика&rdquo;, в который входят сами сигареты и зажигалка. И получается, что зажигалка, которая многим и не нужна, стоит дороже сигарет. Но на самом деле это нарушение закона &ldquo;О защите прав потребителей&rdquo;, статья 16.2 которого гласит: &ldquo;Запрещается обусловливать приобретение одних товаров (работ, услуг) обязательным приобретением иных товаров (работ, услуг).&rdquo; Вот только наказание мягче.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ну а голыми то зачем?]]></title>
    <link href="http://goooseman.ru/2013/04/09/nu-a-gholymi-to-zachiem/"/>
    <updated>2013-04-09T12:58:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/09/nu-a-gholymi-to-zachiem</id>
    <content type="html"><![CDATA[<p><img src="http://d.pr/i/19by+" title="&#34;Фото: Jochen Lübke / DPA / AFP&#34;" alt="&#34;Фото: Jochen Lübke / DPA / AFP&#34;">
Почему постоянно феминистки выступают топлесс? Чтобы подчеркнуть свою женственность? Или чтобы привлечь к себе еще большое внимание?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[0 промилле? Есть панацея получше!]]></title>
    <link href="http://goooseman.ru/2013/04/09/0-promil%27-iest%27-panatsieia-poluchshie/"/>
    <updated>2013-04-09T10:27:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/09/0-promil&#8217;-iest&#8217;-panatsieia-poluchshie</id>
    <content type="html"><![CDATA[<p>У нас как то странно правительство борется с пьяными водителями: ну снизили они порог до нуля промилле, а что изменилось то? Что раньше нельзя было выпить банку пива, так и сейчас нельзя. Зато повышается шанс &ldquo;ложных срабатований&rdquo; (бананы, квас, кефир).<br/>
На самом деле мы не одиноки. Например, в Эстонии тоже граница &ndash; 0 промилле. Но все же в большинстве развитых стран граница &ndash; 0.5.</p>

<!--more-->


<p>Так что обратно вернуть 0.2, зато наказание сделать построже.<br/>
Вот, видео из Малайзии:</p>

<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/fxWg6JDoRFs" frameborder="0" allowfullscreen></iframe>    
</div>


<p>
Называется оно &ldquo;Наказание за вождение в пьяном виде в Сингапуре&rdquo;, но на самом деле оно из Малайзии и наказывают тут насильника. В Сингапуре за вождение пьяным очень высокие штрафы и лишение прав, не знаю откуда пошла эта утка.</p>

<p>Можно, конечно, ввести такое наказание у нас для тех, у кого в крови больше 0.8 промилле, т.е. тех, кто серьезно подвергает жизнь других людей опасности. Но если посмотреть правде в глаза, то просто возрастут многократно взятки. А показательно пороть будут дворовых алкашей на ржавых копейках, да и тех кому попался &ldquo;честный ГАИшник&rdquo; (которому надо поймать пьяного для статистики).</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Первый настоящий российский смартфон? ORLY?!]]></title>
    <link href="http://goooseman.ru/2013/04/08/piervyi-nastoiashchii-rossiiskii-smartfon-orly/"/>
    <updated>2013-04-08T12:50:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/08/piervyi-nastoiashchii-rossiiskii-smartfon-orly</id>
    <content type="html"><![CDATA[<p><img src="http://habrastorage.org/storage2/d0a/e3e/1fc/d0ae3e1fc81ee254e8884d80e5800cd0.jpg" title="&#34;Та самая картинка, которая гуляет по всем постам о новом смартфоне&#34;" alt="&#34;Та самая картинка, которая гуляет по всем постам о новом смартфоне&#34;">
Некий Сергей Зонин, являющийся директором одного контрактного производителя электроники, <a href="http://zorins.livejournal.com/51597.html">объявил в своем ЖЖ</a> об окончании начального этапа разработки нового российского смартфона и о выпуске опытной партии. Информации почти никакой, но уже сейчас вся затея вызывают сомнения.</p>

<!--more-->


<h3>Нужен ли?</h3>

<p>Как я уже говорил, известно о новом шедевре современной инженерии мало, но уже сейчас известно, что данный смартфон флагманом не будет. Пока они дойдут до серийного производства (если дойдут), железо и ПО уже устареет, а цена будет на уровне устройств такого же класса, но с железом поновее. К тому же, если серийное производство собирается в России, конечная розничная цена будет процентов на 30% выше, чем у конкурентов (во-первых, у нас труд дороже, во-вторых, у нас логистика ужасная).</p>

<p>Положение может спасти &ldquo;какая-нибудь фишка&rdquo;. Ну хоть что-то, что выделит смартфон из стада таких же китайских, но дешевле. Но мне кажется, что никакой фишки не будет.</p>

<p>Так зачем это? Если это дело спонсируется государством (что вряд-ли), то все ясно. Если это частная инициатива, то тут я не могу придумать ни одного ответа на вопрос &ldquo;Зачем?&rdquo;. Хотя чудеса случаются&hellip;</p>

<h3>Первый ли?</h3>

<p>На хабре уже две статьи на эту тему (<a href="http://habrahabr.ru/post/175683/">первая</a> и <a href="http://habrahabr.ru/post/175793/">вторая</a>), море комментариев, но почти никто не вспомнил про <a href="http://www.yotaphone.com/rus/">YotaPhone</a>. Так ведь это он же наш первый российский смартфон! Да, он будет производиться в Китае, а не в России, но ведь это же вообще не аргумент! Где производится iPhone? Где производится BlackBerry? Где производится Motorola? И ведь никто даже не думает говорить, мол iPhone не американский смартфон, ибо делают его в Китае. А чем наша страна особенная? Почему у нас люди кричат: &ldquo;Раз называете смартфон российским, так и производите его здесь!&rdquo; Почему у нас действительно более-менее интересный проект забыли, зато что-то вообще неопределенное называют <strong>первым</strong> российским смартофоном, так как его обещают собирать у нас.</p>

<p>Другими словами первый российский смартфон будет YotaPhone, если выйдет. И у Yota намного больше шансов заслужить интерес покупателя. Если они ничего не испортят.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Божья кара]]></title>
    <link href="http://goooseman.ru/2013/04/05/bozh%27ia-kara/"/>
    <updated>2013-04-05T10:05:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/05/bozh&#8217;ia-kara</id>
    <content type="html"><![CDATA[<p>Этим летом произошли две интересных аварии: сначала в конце июля ночью <a href="http://lenta.ru/news/2012/08/17/stopit/">игумен Тимофей</a> на новеньком Z4 с номерами посольства Мальты, въехав в зад попутному Туарегу, вылетел на встречку, пролетел несколько рядов и в лоб столкнулся с Короллой и <a href="http://lenta.ru/news/2012/08/17/guiltyness/">иеромонах Илья</a> на Гелике с номерами АМО 77 на огромной скорости не справился с управлением и сбил троих рабочих, двоих из которых на смерть. Обсуждать сам факт, что священники ездят пьяными за дорогими иномарками, я не собираюсь. Просто потому, что ничего удивительного. Вводим в гугле &ldquo;пьяный священник&rdquo; или &ldquo;священник дорогая машина&rdquo; и любуемся. Вон в Киеве недавно <a href="http://nbnews.com.ua/news/28999/">еще один случай произошел</a>, вот только машина победнее. Если копать дальше, то находим просто сотни случаев, отличающихся друг от друга только степенью опьянения. А теперь вводим &ldquo;drunk priest&rdquo; и смотрим разницу. Да, есть конечно, никто не идеален, но масштабы другие. Да и есть упоминания именно наших &ldquo;богослужителей&rdquo;.</p>

<p>К чему я тут все это вспоминаю? <a href="http://lenta.ru/video/2013/04/04/semin/">На ленте выложили запись очередного судебного заседания по делу того самого иеромонаха Ильи.</a></p>

<!--more-->


<p>Но сначала давайте вспомним про игумена Тимофея. В сентябре он заявил, что он был трезв и что сотрудники полиции с ним грубо обошлись. Волею случая я был свидетелем этой аварии, мы просто объехали ее справа, когда уже были сотрудники ДПС, а дип номера с Z4 уже были сняты. Игумена положили лицом на багажник и так держали. Можно сказать, что действительно грубо обошлись, но лицо у него действительно было неадекватное. Вот даже не то, чтобы пьяное, а именно неадекватное. Позднее игумена признали виновным и лишили прав на год и 8 месяцев. Хотя я просто уверен, что он просто без прав будет кататься.</p>

<p>Но в той аварии не было жертв. А вот иеромонаху Илье сулит до семи лет в тюрьме. Может священник в тюрьме не помешает, будет там преступников одухотворять. Или они его&hellip; Но кажется иеромонах уже получил помилование &ldquo;свыше&rdquo;. Цитирую:</p>

<blockquote><p>Однако к началу суда из дела бесследно исчез протокол заявления свидетеля аварии и материалы камер видеонаблюдения.</p></blockquote>


<p> <br/>
Ведь это же чудо! Радуйся иеромонах, кто-то &ldquo;сверху&rdquo; заботиться о твоей &ldquo;светлой&rdquo; душе.</p>

<p>P.S. Видеосюжет Ленты просто поражает своей несерьезностью. Особенно обивают последние кадры, где оператор решил посидеть на месте судьи.</p>

<p>P.P.S. Вспомнил, что была интересная цитата на lifenews про Илью (Павел Семин), <a href="http://lifenews.ru/news/99677">нашел ее</a>, цитирую:</p>

<blockquote><p>Павел всегда ездил со скоростью 100 - 150 км/ч, хотя он сам говорил, что врачи ему не рекомендовали вообще садиться за руль, - сообщил полицейским епископ Александр. - В детстве ему сделали операцию из-за травмы головы, и этот факт отражается на всех его поступках. Павел любил крепко выпить и потом вытворял не пойми что, а работа в церкви нужна была только для приобретения связей с высокопоставленными и обеспеченными людьми.</p></blockquote>


<p>  <br/>
Хотя я понимаю, что доверять lifenews не следует.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Внимание к мелочам]]></title>
    <link href="http://goooseman.ru/2013/04/02/vnimaniie-k-mielocham/"/>
    <updated>2013-04-02T11:33:00+04:00</updated>
    <id>http://goooseman.ru/2013/04/02/vnimaniie-k-mielocham</id>
    <content type="html"><![CDATA[<p>Ни для кого не секрет, что внимательность к мелочам &ndash; важная составляющая успеха компании. Для многих управленцев это весьма трудно, ведь управленец &ndash; человек, который на все смотрит широко. Но именно ошибки в мелочах &ndash; то, что может снизить лояльность клиентов. А такие оплошности, о которых я хотел бы поговорить вообще неприемлемы для больших заведений.</p>

<!--more-->


<p>В Москве на Новом Арбате есть такой бар под названием Chesterfield. <br/>
<img src="https://irs2.4sqi.net/img/general/width960/19168627_7raqlNACtFFXa56GsdZJqX3LS143JFcxIl9oeneehy8.jpg"><br/>
Когда-то я там часто бывал, ибо недалеко от дома, да и акции интересные у них были. Но как-то, когда у них была акция &ldquo;два по цене одного&rdquo;, мы поняли, что нам явно недоливают алкоголь, и желания туда зайти больше не появлялось. <br/>
Но я хотел сказать совсем про другое. Вот фотография гостя этого бара с foursquare:<br/>
<img src="https://irs1.4sqi.net/img/general/width960/E1U1PPT3S1OKHFUHOSIYSC00BPQK4HV24BOS4HELFGJIBUJF.jpg"><br/>
М<strong>а</strong>хито. Ну как в <strong>баре</strong> можно делать такие ошибки? Я конечно все понимаю, и я далеко не грамма наци, но все таки можно же хотя бы названия в R-Keeperе (или чем они там пользуются) проверять.<br/>
И еще у них справа от входа сейчас висит реклама. Снизу надпись &ldquo;По средам <strong>free</strong> bar девушками <strong>бесплатно</strong>&rdquo;. Ну что за масло масленное? А в другие дни у них <strong>free</strong> bar платный? Я конечно понимаю, что народ то он тупой, но даже моя мама, которой за полтинник, сможет перевести слово free, что уж там говорить о молодежи.<br/>
Что я всем этим хотел сказать? Не ходить в этот бар? Нет конечно, это лично для меня такие мелочи снижают привлекательность заведения, тем более если это не палаткой с шавермой у метро. Но иногда стоит лишний раз перепроверить, чтобы не допускать таких ошибок. Причем это касается не только бизнеса, но и обычной жизни. Так что &ldquo;поспешишь &ndash; людей насмешишь&rdquo;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[У Google настолько мощная защита от спама...]]></title>
    <link href="http://goooseman.ru/2013/03/24/u-gmail-nastol%27ko-moshchnaia-zashchita-ot-spama-dot-dot-dot/"/>
    <updated>2013-03-24T15:24:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/24/u-gmail-nastol&#8217;ko-moshchnaia-zashchita-ot-spama-dot-dot-dot</id>
    <content type="html"><![CDATA[<p>&hellip; что он не доверяет даже сам себе.<br/>
<img src="http://d.pr/i/P6RW+"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Сводные братья]]></title>
    <link href="http://goooseman.ru/2013/03/24/svodnyie-brat%27ia/"/>
    <updated>2013-03-24T12:24:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/24/svodnyie-brat&#8217;ia</id>
    <content type="html"><![CDATA[<p>Постоянно, просто постоянно вокруг себя наблюдаю, как люди не правильно понимают значение выражения &ldquo;Сводные братья/сестры&rdquo;. Или даже в кино. Вот в недавнем <a href="http://www.kinopoisk.ru/film/577306/">Ты и я</a> главных героев называют сводными, хотя у них просто один общий родитель. Конечно это вина локализаторов, а не создателей фильма.<br/>
Еще не поняли почему я так бешусь? Тогда Вам будет полезен этот пост.</p>

<!-- more -->


<p>Для начала просто приведу <a href="http://dic.academic.ru/dic.nsf/ushakov/1018714">статью на слово &ldquo;Сводный&rdquo; из Толкового словаря Ушакова</a> (в силу современных реалий, я бы вычеркнул первое слово &ldquo;брак&rdquo;, ведь дети сейчас не обязательно должны быть рождены в браке):</p>

<blockquote><p>2. О лице, приходящемся кому-нибудь братом или сестрой по отчиму или мачехе. Сводный брат, сводная сестра (сын, дочь отчима или мачехи). Сводные дети (дети от первых браков лиц, вступивших между собой во второй брак, т.е. не родные, не единокровные и не единоутробные, но чужие, &#8220;сведенные&#8221; в одну семью).</p></blockquote>


<p>Более &ldquo;современное&rdquo; определение дает <a href="http://ru.wikipedia.org/wiki/%D0%A0%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BE%D1%82%D0%BD%D0%BE%D1%88%D0%B5%D0%BD%D0%B8%D1%8F#.D0.A1.D0.B2.D0.BE.D0.B4.D0.BD.D1.8B.D0.B5">Википедия</a>:</p>

<blockquote><p>Сводные братья и сёстры — дети, родители которых состоят в браке между собой, но не имеют общих детей.</p></blockquote>


<p>
Сводные братья/сестры не являются кровными родственниками.<br/>
Многие почему-то уверены, что сводные &ndash; братья/сестры, у которых один общий родитель. Почему многие так думают, я не понимаю, хотя пытался найти связь. Кто их <strong>сводит</strong>? Это же не логично!<br/>
Та же самая <a href="http://ru.wikipedia.org/wiki/%D0%A1%D0%B2%D0%BE%D0%B4%D0%BD%D1%8B%D0%B5_%D1%80%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%B8%D0%BA%D0%B8">Википедия</a> подтверждает мои слова у существовании этого заблуждения:</p>

<blockquote><p>Неверным является распространённое заблуждение называть сводными братьев или сестёр, у которых общий отец (единокровные) или мать (единоутробные).</p></blockquote>


<p>Что касается братьев/сестер, у которых один общий родитель, то это называется неполнородные братья/сестры. Причем есть разделение: единокровные братья/сестры &ndash; те, у кого общим является только отец, а единоутробные &ndash; те, у кого только общая мать. Неполнородные братья/сестры считаются кровными родственниками, юридически они равны в правах полнородным.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Детский баг Мегафона]]></title>
    <link href="http://goooseman.ru/2013/03/20/dietskii-bagh-mieghafona/"/>
    <updated>2013-03-20T13:12:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/20/dietskii-bagh-mieghafona</id>
    <content type="html"><![CDATA[<p>Помню в начале 00-х, когда мобильный интернет только начал появляться, был один полезный баг у Билайна: если на балансе ровно 0,00 доллара, то мобильный интернет не отключается, но и денег за него не берут. То есть получался абсолютно бесплатный интернет.<br/>
Но баг тот давно уже прикрыли, поэтому я был очень удивлен встретить его снова у другого оператора.</p>

<!--more-->


<p>Сейчас у меня Мегафон (год назад покинул Билайн), и на мой счет подключена услуга <a href="http://moscow.megafon.ru/internet/telefon_i_smartfon/#day">Безлимитный Интернет для телефона</a>. В день у меня списывают по 5 рублей. Если баланс менее 5и рублей, то 5 рублей списывают за этот день, баланс уходит в минус. Но при отрицательном балансе интернет не работает, поэтому получается, что за этот день ты и заплатил, но пользоваться интернетом не можешь, пока не пополнишь баланс. Не приятно, но логично.<br/>
Но самое интересное у меня произошло на прошлой недели. 5 рублей за тот день сняли и на балансе оставались какие-то копейки. Совершив звонок, я смог сказать только пару слов, ибо деньги подошли к нулю, и звонок оборвался. На мое удивление интернет продолжал работать, хотя и баланс был равен нулю рублям. Я решил на протяжении некоторого времени не класть деньги на счет, чтобы посмотреть, что будет дальше.<br/>
Прошло шесть дней, баланс продолжал быть равен нулю, а интернет все работал. Я положил себе денег на счет, снова стали снимать по 5 рублей в день и все стало как раньше.<br/>
Получается с 1е по 24е марта у меня сняли абон. платы за пользование этой услуги на 89,99 рублей, то есть за 18 дней:<br/>
<img src="http://d.pr/i/tMW8+"><br/>
Я ни в коем случае не призываю пользоваться такой сомнительной халявой, ибо все равно время уже не то, и мобильный интернет стоит копейки.</p>

<p>P.S. И почему то у меня потрачено не 90, а именно 89.99 рублей. И в сервис-гиде у этой услуги абонентская плата в месяц равна не 155, а 154.99:<br/>
<img src="http://d.pr/i/EiuF+"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Samsung и копирка]]></title>
    <link href="http://goooseman.ru/2013/03/19/sasmsung-i-kopirka/"/>
    <updated>2013-03-19T20:08:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/19/sasmsung-i-kopirka</id>
    <content type="html"><![CDATA[<p>Недавно Samsung представила миру Galaxy S4. Обсуждать это устройство у меня нет никакого желания, ибо оно не такое интересное на фоне таких конкурентов, как Sony Xperia Z и HTC One. Но Samsung представила линейку аксессуаров для своего нового устройства, и я хотел бы остановиться на их новом джойстике.</p>

<!--more-->


<p><img src="http://d.pr/i/hES6+">  <br/>
Ничего не напоминает? <br/>
<img src="http://d.pr/i/y6Md+"><br/>
Да, новое творение Samsung очень похоже на джойстик для Xbox 360. Тут все сразу начинают вспоминать былые &ldquo;заслуги&rdquo; корейской компании и кричать &ldquo;До коле уже?!&rdquo; Но давайте попробуем отнестись к ситуации не так предвзято. Кто является будущими покупателями нового аксессуара? Геймеры. Ну так зачем геймерам давать, что то новое, к чему еще надо будет привыкать, если можно дать вполне привычный, проверенный временем джойстик. Но зачем же тогда повторять даже цвета? Все просто, ведь это выделит джойстик на прилавке среди сотен других таких же от других производителей. Но как бы непредвзято я не пытался рассмотреть эту проблему, я все таки считаю, что это их не оправдывает. Как бы не было обосновано воровство, оно все же является воровством. Скоро ждем приставку к телевизору от Samsung в стиле Apple TV, но которая умеет ставить на паузу фильм, когда идешь в туалет.<br/>
Было бы забавно, если они выпустили два джойстика: один для белого Galaxy S4, второй для черного. Белый бы повторял дизайн Xbox 360, а черный &ndash; PS3.<br/>
И что самое смешное: оттенок пластика аксессуара не сходится с оттенком корпуса телефона. Может они просто скупают джойстики от Xbox и преплавляют их?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Речь Мадонны и Pussy Riot]]></title>
    <link href="http://goooseman.ru/2013/03/18/riech%27-madonny-i-pussy-riot/"/>
    <updated>2013-03-18T15:04:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/18/riech&#8217;-madonny-i-pussy-riot</id>
    <content type="html"><![CDATA[<p>Мадонна выступила с речью на ежегодном вручение премий, выдаваемых Альянсом геев и лесбиянок против диффамации. Говорит она хорошо, вдумчиво, красиво.    Смотреть одно удовольствие. Между слов она упомянула и Путина, и Pussy Riot и администрацию Санкт-Петербурга, чем вызвала бурление масс у нас в стране.</p>

<!--more-->


<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/ZI7wRDMsk5k" frameborder="0" allowfullscreen></iframe>     
</div>


<p>Цитирую:</p>

<blockquote><p>If President Putin sat in a room with Pussy Riot, he’d probably want to fuck all of them, but anyways, if he did, and he had an open dialogue with them about their point of view as young, creative women growing up in modern day Russia, would he really have allowed them to be dragged away to prison for three years? I mean think about it, it’s just insane. Because they criticized the government.</p></blockquote>


<p>Перевод от <a href="http://www.rbcdaily.ru/society/562949986281632">РБК daily</a>:</p>

<blockquote><p>Если бы президент Путин сел в одной комнате с Pussy Riot (наверное, он бы захотел их всех трахнуть, ну да ладно), вступил с ними в открытый диалог, выслушал их точку зрения как молодых творческих женщин современной России, неужели он позволил бы упечь их на три года в тюрьму? Когда я думаю об этом, это все представляется просто безумием. И это все только за критику правительства.</p></blockquote>


<p>Можно вырвать цитату из контекста, но я считаю необходимым обратить внимание на то, что говорит она это в качестве примера тому, что люди перестали прислушиваться друг к другу, и что многих конфликтов можно избежать. Сама речь идет целых 12 минут, и Pussy Riot &ndash; далеко не главная тема. С одной стороны, она как будто упомянула эту проблему между слов. С другой же стороны, она хотела еще раз заострить внимание общественности на девушках.
Мадонна в августе делала прямое обращение к Путину по поводу Pussy Riot. Не сработало. Теперь решила &ldquo;пристыдить&rdquo; его. Сработает? Нет, конечно.<br/>
Тем более известная певица немного дезинформирована. Во-первых, девушкам дали не 3 года, а 2. Во-вторых, Самуцевич уже отпустили. В-третьих, Путин бы не трахнул девушек.<br/>
Хотя все же приятно, что она вспомнила. А то как всегда: покричали и забыли. А уверенный голос Мадонны заставил нас снова вернутся к обсуждению это проблемы. Но, к сожалению, уверенный голос Мадонны не сможет ничего изменить. Да и мало кто сможет.</p>

<p>P.S.<br/>
<img src="http://25.media.tumblr.com/185aa6ef310b324fbfa53245f3f8b65b/tumblr_mjswz55lw31rxml8no1_500.gif"><br/>
<img src="http://25.media.tumblr.com/2e2c81e35220056c6781b23c660151fc/tumblr_mjswz55lw31rxml8no2_500.gif"><br/>
<img src="http://25.media.tumblr.com/c37d9f36417bdba30dbf4bec85388a8c/tumblr_mjswz55lw31rxml8no3_500.gif"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Retina или хороший маркетинговый подход]]></title>
    <link href="http://goooseman.ru/2013/03/17/retina-ili-khoroshii-markietinghovyi-podkhod/"/>
    <updated>2013-03-17T02:18:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/17/retina-ili-khoroshii-markietinghovyi-podkhod</id>
    <content type="html"><![CDATA[<p>Сегодня пришло письмо от Apple, которое заставило меня не только еще раз удивиться правильному подходу сией компании к мелочам, но и поразиться той лжи, которую они написали.</p>

<!--more-->


<p>Вот, собственно говоря кусок этого письма, рекламирующего iPhone 5:<br/>
<img src="http://d.pr/i/HGHJ+"><br/>
Читаем первую строчку:</p>

<blockquote><p>Только iPhone имеет Retina дисплей.</p></blockquote>


<p>
Если придираться к мелочам, то они здесь не правы, ведь Retina экран есть и у iPod Touch, и у iPad, и у Macbook Pro. Хотя они скорее здесь сравнивают с другими телефонами, так что придираться мы не будем. Тут я всего лишь хотел еще раз сказать про то внимание к мелочам, которое присуще Apple. Как же они были правы, когда в 2010м году не просто создали новый экран, но и назвали его своим именем, да и таким коротким и запоминающимся. Поэтому они действительно могут сказать, что Retina только у них, и не важно, что у других экраны то и по лучше бывают, зато у них Retina, а не какой-нибудь SuperUltraMegaHDAMOLED.<br/>
Идем дальше:</p>

<blockquote><p>Ретина дисплей начала эру экранов супервысокого разрешения.</p></blockquote>


<p>Да, тут они безусловно правы. Но вся соль в последней строчке:</p>

<blockquote><p>Увидев однажды текст и изображения на Retina экране, вы больше никогда не будете удовлетворены чем-либо другим (экраном).</p></blockquote>


<p>ORLY? У меня прошлогодний Sony Xperia S, у него PPI &ndash; 342. У всех iPhone &ndash; 326. А если взять, например, Sony Xperia Z с Full HD экраном, то у него PPI примерно равен 441. Да и даже если не было бы других смартфонов с хорошими экранами, то так все равно нельзя писать, ведь в будующем все равно будут экраны получше чем нынешние, а пишут, что мы больше не будем другим удовлетворены.<br/>
И нет, я не хотел полить грязью Apple. У меня у самого сейчас Macbook, iPad, iPod Classic (да, я им до сих пор пользуюсь) и было пару айфонов, да iPod Touch. Просто такой наглостьи я от них не ожидал.<br/>
Ах да&hellip; &ldquo;При Стиве Такого Не Было111&rdquo;(с)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Умножение и японские дети]]></title>
    <link href="http://goooseman.ru/2013/03/15/umnozhieniie-i-iaponskiie-dieti/"/>
    <updated>2013-03-15T20:32:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/15/umnozhieniie-i-iaponskiie-dieti</id>
    <content type="html"><![CDATA[<p>Я думаю все помнят, как считать столбиком, ведь нас этому учат еще в начальной школе. А в Японии дети такой способ умноженея не знают: там детей учат считать рисованием полосок.</p>

<!--more-->


<p>Идея метода в следующем: мы рисуем полоски паралельные друд другу и образовываем ими квадрат. Полоски цифр одного числа помещаем на разные грани квадрата, а цифры другого числа, перпендикулярны первым полоскам. Смотрим на рисунок:<br/>
<img src="http://www.funpicplanet.com/uploadedpics/8724734How_Japanese_Kids_Learn_To_Multiply_In_Primary_School.jpg"><br/>
Чтобы высчитать результат, надо сначало подсчитать количество пересечений полосок в верхнем левом углу. Это сотни. Затем считаем сумму пересечений верхнего правого и нижнего левого углов. Это десятки. Ну и количество пересечений нижнего правого угла &ndash; единицы. <br/>
Перемножать небольшие двузначные числа очень даже удобно. Но, если взять хотя бы большие двузначные числа&hellip;<br/>
<img src="http://goooseman.ru/images/blog/math.jpeg"> <br/>
Теперь переходим к трехзначным числам:</p>

<div class="video-container">
    <iframe width="480" height="360" src="http://www.youtube.com/embed/otCLgQjBaio" frameborder="0" allowfullscreen></iframe>    
</div>


<p>Снова же с небольшими числами все просто и быстро, но если умножать 999 на 999&hellip;</p>

<p>А пока японские дети учатся умножать, китайских сразу учат паять свой первый калькулятор. Ну или телефон на Андроиде c калькулятором.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Руки надо отрывать за такие словари!]]></title>
    <link href="http://goooseman.ru/2013/03/15/ruki-nado-otryvat%27-za-takiie-slovari/"/>
    <updated>2013-03-15T20:12:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/15/ruki-nado-otryvat&#8217;-za-takiie-slovari</id>
    <content type="html"><![CDATA[<p><img src="http://d.pr/i/G8vK+"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Наконец-то!]]></title>
    <link href="http://goooseman.ru/2013/03/13/nakoniets-to/"/>
    <updated>2013-03-13T20:58:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/13/nakoniets-to</id>
    <content type="html"><![CDATA[<p><a href="http://rbcdaily.ru/market/562949986158223">Новость одной ссылкой.</a></p>

<!--more-->


<p>Но все же не получится не прокомментировать. Дело в том, что я действительно ждал отмены всех этих Jaguarов и Strikов. Почему? Да просто потому, что это дьявол во плоти. Да и в общем сама идея алкоголь мешать с энергетиком чудовищна, а продавать это еще и по цене, доступной школьникам, вообще преступление. И даже если предположить, что создатели оригинального американского напитка <a href="http://en.wikipedia.org/wiki/Four_Loko">Four Loko</a> преследовали благие цели, и действительно хотели всего лишь создать крутой напиток для тусовок, это не отменяет того факта, что напиток этот уже запрещен в США. А поверить в то, что наши производители хотели сделать мир лучше, мягко говоря трудно.<br/>
<a href="http://bg.ru/society/shkolota_po_amerikanski-17399/">Большой Город представил подбор изображений, иллюстрирующий схожесть нашего &ldquo;Ягуара&rdquo; с &ldquo;Four Loko&rdquo;</a>:<br/>
<img src="http://bg.ru/media/upload/images/society/2013/march2013/12march/jaga/3(1).jpg">
<img src="http://bg.ru/media/upload/images/society/2013/march2013/12march/jaga/1(1).jpg">
<img src="http://bg.ru/media/upload/images/society/2013/march2013/12march/jaga/2(1).jpg">
<img src="http://bg.ru/media/upload/images/society/2013/march2013/12march/jaga/6(1).jpg">
<img src="http://bg.ru/media/upload/images/society/2013/march2013/12march/jaga/5(1).jpg">
<img src="http://bg.ru/media/upload/images/society/2013/march2013/12march/jaga/4(1).jpg"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Погода, вашу ж мать]]></title>
    <link href="http://goooseman.ru/2013/03/13/vashu-zh-mat%27/"/>
    <updated>2013-03-13T13:12:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/13/vashu-zh-mat&#8217;</id>
    <content type="html"><![CDATA[<p>Пару недель назад я собирался уже переобувать машину, ибо температура была выше 0&deg;, стало сухо, только птиц не хватало для полного ощущения весны. Но потом снова стало холодать, но все же было очень сухо, что не могло не радовать.</p>

<!-- more -->


<p>Мы пользуемся будильником от Uniqlo под названием <a href="http://www.uniqlo.com/wakeup/ru/pc/">Uniqlo Wake Up</a>, который не только будит тебя под музыку именитых японских композиторов, которые специально для программы записали треки, но и делает это в зависимости от погоды. И сегодня с утра, еще не открыв глаза, вместо привычного &ldquo;It&rsquo;s sunny day&rdquo; или хотя бы &ldquo;It&rsquo;s partly cloudy&rdquo; мы с невестой слышим &ldquo;It&rsquo;s snowy day&rdquo;, вскакиваем, смотрим в окно и видим обычное такое январское утро.<br/>
<img src="http://img.rl0.ru/pgc/432x288/513ef94f-48a9-8d5e-48a9-8d5130d8c91d.photo.0.jpg"><br/>
Открываю, как всегда, <a href="http://www.rg.ru/2013/03/13/snegopad-site-anons.html">РГ</a>, и читаю:</p>

<blockquote><p>По данным Метеобюро Москвы и области, около 6.00 в столице начался снегопад, и за 4 часа он нарастил высоту снежного покрова на 2-3 см. Наибольшее количество осадков выпало на западе Подмосковья, в Волоколамске и Можайске &ndash; 3мм.</p>

<p>Сегодня выпала первая порция осадков, самая незначительная, ближе к вечеру снегопад продолжится, &ndash; пояснила Поздянкова. &ndash; {&ldquo; Основной удар стихия нанесет с четверга по субботу. За это время высота снежного покрова увеличится на 25 сантиметров. &rdquo;}</p></blockquote>

<p>Чувствую сегодня всю неделю теперь пробки будут. А мне надо в ПФР на Пятницкую съездить, поеду я сейчас, пока не поздно. Да и вообще, какого хрена ПФР <em>Пресненского</em> района находится на Новокузнецкой?<br/>
Есть одна надежда: на масленицу. Ведь это еще языческий праздник проводов зимы и встречи весны. Так что всем в воскресенье чучела жечь! Прогоним зиму! Задолбала уже!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Напольная навигация в Московском метрополитене]]></title>
    <link href="http://goooseman.ru/2013/03/12/napol%27naia-navighatsiia-v-moskvoskom-mietropolitienie/"/>
    <updated>2013-03-12T15:00:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/12/napol&#8217;naia-navighatsiia-v-moskvoskom-mietropolitienie</id>
    <content type="html"><![CDATA[<p>Год назад по <a href="http://www.couchsurfing.org/">CouchSurfing</a> у нас проживал Австралиец несколько дней. Такой типичный западный путешественник: пока учился в университете копил деньги, а как закончил, на полученные деньги поехал в полугодовое путешествие по Евразии. Когда он жил у нас в Москве больше всего он проклинал наше метро. А именно то, что у нас в метро мало надписей дублировано на английском, и даже выход в город найти сложно, не зная русского языка. Другое дело Питер: там дублировано все, ну кроме рекламы. И вот наконец, спустя два с лишним десятка лет с тех пор, как открыли железный занавес и туристы начали посещать Москву, Московский метрополитен пошел на уступки посещающим Москву.</p>

<!--more-->


<p>Я конечно же говорю про новые указатели, которые уже появились на Пушкинской-Чеховской-Тверской.<br/>
<img src="http://www.metronews.ru/_internal/gxml!0/2qijkhn0ctpwx8acoz5fxkpvtmr4nbh$f9fivxtz4ol3uczxw4hehjgdmnkhp0d/bul-8342.jpeg">
<img src="http://pix.timeout.ru/370662.jpeg"><br/>
Пусть все и говорят, что не замечают это нововведение, но, если ты иностранец, ты будешь крутить головой, пытаясь найти знакомые буквы и уж точно заметишь яркие наклейки на полу. Так что идея хорошая, исполнение неплохое (посмотрим на них через пару месяцев), вот только непонятно почему раньше нельзя было делать хоть какие-то указатели на английском.<br/>
Еще интересны напольные подсказки местоположения дверей вагонов. <br/>
<img src="http://www.mk.ru/upload/iblock_mk/475/60/83/b5/DETAIL_PICTURE__51533575.jpg"><br/>
Понятно и практично. А главное полезно как самому метрополитену (уменьшается время погрузки пассажиров в вагоны), так и пассажирам. И даже добавлять на эти наклейки ничего не стоит, наши люди не любят уступать друг другу и тем более вникать в &ldquo;сложные&rdquo; схемы, как, например, в Каракасе:<br/>
<img src="http://www.ridus.ru/_ah/img/Kfhl2_U5bDrTz0D_GnWCzg"><br/>
Короче говоря, куда ни плюнь &ndash; одни плюсы. Как то не похоже на Россию, может все меняется к лучшему? Ах, да! На создание напольной навигации на этих трех станциях было выделено <a href="http://www.gazeta.ru/social/news/2013/02/25/n_2771461.shtml">1.9 миллиона рублей</a>. Хотя я могу предположить, что там команда именитых дизайнеров и менеджеров + всякие там социологи, но почти 2 миллиона действительно немаленькая сумма, учитывая, что работа была выполнена за 10 дней, а эксплуатационный срок наклеек &ndash; 3 месяца.</p>

<p>P.S. Говорят, что если писать &ldquo;Выход здесь&rdquo; вместо просто &ldquo;Выход&rdquo; или, в нашем случае, &ldquo;Выход в город&rdquo;, то снижается количество самоубийств в данном регионе. Может стоит попробовать?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Количество непрочитанных сообщений Skype в меню баре OS X]]></title>
    <link href="http://goooseman.ru/2013/03/09/kolichiestvo-nieprochitannykh-soobshchienii-skype-v-mieniu-barie-os-x/"/>
    <updated>2013-03-09T18:44:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/09/kolichiestvo-nieprochitannykh-soobshchienii-skype-v-mieniu-barie-os-x</id>
    <content type="html"><![CDATA[<p>Skype под OS X имеет два способа нотификации: всплывающее уведомление и &ldquo;badge&rdquo; на иконке в доке. (<img class="right" src="http://d.pr/i/zjRC+" title="Badge" >) Но док у меня постоянно спрятан, а нотификацию можно пропустить. У Skype есть еще иконка в меню баре, так почему бы не сделать ее более информативной.</p>

<!--more-->


<p>Подумав о решении этой проблемы, у меня не появилось не единой идеи. Но загуглив, я осознал, что я не одинок. Некий <a href="https://github.com/pwc3">pwc3</a> из Бостона тоже столкнулся с этой проблемой и даже написал скрипт на ruby с использованием F-Script, добавляющий количество непрочитанных сообщений рядом с иконкой Skype. Скрипт читает кол-во сообщений с иконки Skype и добавляет счетчик слева от иконки в меню баре.<br/>
Но чтобы скрипт работал, нужно сначала установить F-Script. Качаем его с <a href="http://www.fscript.org/">официальной страницы</a>, распаковываем, и копируем FScript.framework в /Library/Frameworks.<br/>
Теперь сам скрипт:</p>

<div><script src='https://gist.github.com/2728176.js'></script>
<noscript><pre><code>#!/usr/bin/env ruby

FSCRIPT_PATH = &quot;/Library/Frameworks/FScript.framework&quot;

GDB = IO.popen(&quot;gdb&quot;, &quot;w&quot;)
def gdb(cmd)
    GDB.puts cmd
    GDB.flush
end

updaterScript = &lt;&lt;END_OF_FSCRIPT
SkypeMenuUpdater : NSObject
{
    statusBarItem
    timer

    - init
    {
        self := super init.
        self ~~ nil ifTrue:
        [
            statusBarItem := NSStatusBar systemStatusBar statusItemWithLength:20.

            timer := NSTimer scheduledTimerWithTimeInterval:1
                                                     target:[self updateMenu]
                                                   selector:#value
                                                   userInfo:nil
                                                    repeats:YES.
        ].
        ^ self
    }

    - updateMenu
    {
        statusBarItem setTitle:NSApplication sharedApplication dockTile badgeLabel.
    }
}.

updater := (SkypeMenuUpdater alloc) init.
END_OF_FSCRIPT

updaterScript.gsub!(&quot;\n&quot;, &quot;\\n&quot;)

gdb &quot;attach Skype&quot;
gdb &quot;p (char)[[NSBundle bundleWithPath:@\&quot;#{FSCRIPT_PATH}\&quot;] load]&quot;
gdb &quot;p (void)[[FSInterpreter interpreter] execute:@\&quot;#{updaterScript}\&quot;]&quot;
gdb &quot;detach&quot;
gdb &quot;quit&quot;

GDB.close
</code></pre></noscript></div>


<p>Создаем файл, кладем в него этот скрипт, сохраняем. Я обычно это делаю через nano, например <code>nano ~/skypehelper.rb</code>.<br/>
Убеждаемся, что Skype запущен и выполняем <code>ruby наш файл</code>. Результат:<br/>
<img src="http://d.pr/i/Uds0+"><br/>
Но это еще не все, скрипт надо запускать строго после запуска Skype. А каждый раз запускать его в ручную &ndash; не путь Джедая. Я предлагаю создать приложение в Automator. Добавляем действие &ldquo;Запустить shell-скрипт&rdquo;, в нем в качестве среды выбираем ruby и копируем туда весь скрипт. После <code>#!/usr/bin/env ruby</code> добавляем следующие две строчки:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>system %{open -a Skype.app}
</span><span class='line'>sleep 5 </span></code></pre></td></tr></table></div></figure>


<p>
Сохраняем. Добавляем нашу новую программу в автозапуск или запускаем ее ручками вместо Skype.<br/>
Окно Automator и результат в меню баре:<br/>
<img src="http://d.pr/i/poBW+" title="" ></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Синхронизация контактов Google с iPhone GSM]]></title>
    <link href="http://goooseman.ru/2013/03/07/sinkhronizatsiia-kontaktov-google-s-iphone-gsm/"/>
    <updated>2013-03-07T22:09:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/07/sinkhronizatsiia-kontaktov-google-s-iphone-gsm</id>
    <content type="html"><![CDATA[<p>Моя невеста до сих пор пользуется iPhone GSM, тем самым, который первого поколения. Контакты у нее синхронизируются с гуглом. Но с 30го января 2013 года Google отключил синхронизацию через протокол Microsoft Exchange, а на 3.1.3 нет поддержки CardDAV, поэтому на телефоне исчезла поддержка синхронизации. Можно синхронизировать через компьютер, но здесь есть один небольшой нюанс.</p>

<!-- more -->


<p>Приложение Contacts.app у меня давно настроено на синхронизацию с Google таким вот образом:<br/>
<img src="http://d.pr/i/WTiT+"> <br/>
Получается так, что в учетной записи &ldquo;На моем Mac&rdquo; контактов нет, а все они в учетной записи Google. Но при синхронизации на iPhone контакты не появляются. Вообще. Хотя и учетная запись по умолчанию стоит &ldquo;Google&rdquo;.<br/>
Секрет в том, что есть еще один способ синхронизировать с Google: в настройках жмем на учетную запись &ldquo;На моем Mac&rdquo; и ставим галочку &ldquo;Синхронизировать с Google&rdquo;. Нам предлагают ввести логин и пароль, что мы и делаем. Начинается синхронизация.<br/>
<img src="http://d.pr/i/EOeH+"> <br/>
При таком методе синхронизации контакты нормально синхронизируются с iPhone. Удивительно, но даже если подключить учетную запись iCloud, он и с ней не будет синхронизировать iPhone, ибо они снова же синхронизируются в своей учетной записи, а не с &ldquo;На моем Mac&rdquo;. Как то это не удобно.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Настройка терминала]]></title>
    <link href="http://goooseman.ru/2013/03/07/nastroika-tierminala/"/>
    <updated>2013-03-07T16:58:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/07/nastroika-tierminala</id>
    <content type="html"><![CDATA[<p>Я всегда стремлюсь сделать свою жизнь за компьютером удобнее. Терминал &ndash; инструмент, которым многие из нас пользуются достаточно часто, так почему бы не сделать его удобнее?</p>

<!-- more-->


<h3>TotalTerminal</h3>

<p>Разработчик известного всем <a href="http://totalfinder.binaryage.com/">TotalFinder</a> уже давно выпустил очень удобную утилиту под OSX. Называется она <a href="http://totalterminal.binaryage.com/">TotalTerminal</a>. Те, кто долго сидел на линуксом, может быть знают такую утилиту, как guake (или его альтернативы под другие среды рабочего стола). Все что делала эта утилита, так вызывала полупрозрачное окно терминала сверху по шорткату, как во многих играх (Имя guake произошло от quake).<br/>
<img src="http://guake.org/screenshots/2?format=raw" title="Guake" ><br/>
TotalTerminal делает то же самое, но под OSX. Состоит оно из плагина и из .app, которое просто запускает Терминал, подгружая свой плагин.<br/>
<img src="http://d.pr/i/7GSW+"><br/>
Поэтому после установки советую положить TotalTerminal.app в автозагрузку. Настройки TotalTerminal находятся в настройках самого терминала.<br/>
<img src="http://d.pr/i/Oupq+"><br/>
Я поставил шорткат на shift+§, мне лично так очень удобно. Еще я в настройках поменял местоположение вслыающего окна. Оно у меня справа, ибо так удобней в него делать drag&#8217;n&#8217;drop.<br/>
Чтобы убрать иконку из дока, открываем Finder, переходим в Applications/Utilities, находим Ваш Terminal.app (Не TotalTerminal, а просто Terminal, который Терминал). Жмем правой кнопкой, показать содержимое пакета, Contents, там открываем Info.plist, да хоть в TextEdit, но лучше в чем-нибудь, что работает с .plist, да в том же XCode. Находим строчку <code>Application is agent (UIElement)</code> и придаем ей значение <code>True</code>. <br/>
<img src="http://d.pr/i/Ko3X+">  <br/>
Завершаем Terminal, запускаем TotalTerminal. Иконка исчезла! Вот только как теперь вызывать окно настроек, если надо? Разворачиваем окно TotalTerminal и жмем системный шорткат настроек <code>cmd+,</code> (cmd+запятая). Новую вкладку можно открыть системным шорткатом <code>cmd+t</code>. <br/>
Хотите поменять тему? Просто удалите стандартную тему Visor и TotalTerminal примет тему, которая выставлена в настройках.<br/>
На данный момент Терминал выглядит вот так:<br/>
<img src="http://d.pr/i/CR5K+"></p>

<h3>Другие твики</h3>

<p>Bash пусть и не zsh, но все же достаточно гибко настраивается. Я лишь предложу включить цвета и настроить приветствие. Приветствие &ndash; это то, с чего начинается каждая строка.<br/>
<img src="http://d.pr/i/8ob3+" title="Стандартное приветствие" ><br/>
Для этого нам надо изменать файл .bash_profile, лежащий в корне вашей домашней директории. Легче всего это сделать в том же самом терминале простой коммандой <code>nano ~/.bash_profile</code>. Открывается текстовой редактор, в конец файла дописываем: <br/>
<code>export CLICOLOR=1</code> &ndash; активируем цвета. <br/>
<code>export PS1="[\A] \u\[@\]\h:\w\$ "</code> Добавляем время в приветствие.<br/>
<img src="http://d.pr/i/G01z+"><br/>
Жмем Ctrl+O, чтобы сохранить, Ctrl+X, чтобы выйти. Чтобы изменения сразу вошли в силу выполняем <code>source ~/.bash_profile</code>, в противном случае они войдут в силу после перезапуска терминала. <br/>
<img src="http://d.pr/i/gcwy+" title="Конечный результат" >
Теперь при выводе, например, команды ls, все выводится в разных цветах. Цвета настраиваются в Настроки (Терминала)&ndash;>Настройки->Текст->Цвета ANSI.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[МКАД и фуры]]></title>
    <link href="http://goooseman.ru/2013/03/07/mkad-i-fury/"/>
    <updated>2013-03-07T11:32:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/07/mkad-i-fury</id>
    <content type="html"><![CDATA[<p>С 1го марта запретили въезд на МКАД грузовым автомобилям грузоподъёмностью более 12 т. Пишут, что даже губернатор подмосковья выступил за эту идею, простояв 4 часа в пробке на МКАДе. Но что мы получаем в итоге?</p>

<!-- more -->


<p>В общем ограничить движение транзитников по МКАДу &ndash; идея весьма полезная, но есть три но:</p>

<ol>
<li>Нет вариантов объезда. Правительство предлагает бетонку, из которой к 2015ому году хотят сделать хорошую дорогу, но на данный момент, это вечностоящее двуполосное кольцо. Да и длина окружности бетонки намного больше, чем МКАДа.</li>
<li>Повышение затрат на транспортировку (ехать по бетонке &ndash;> тратить больше времени и бензина) может аукнуться повышением цен на товары.</li>
<li>Но и самое главное, штраф за нарушение нового правила &ndash; 300 рублей. Даже если раз 5 остановят и 5 раз придется заплатить по 300 рублей, мало кого это отпугнет. Что такое 1500 рублей, когда везешь более 12 тонн товара? Да если ехать в объезд, может даже больше денег на бензин потратишь.</li>
</ol>


<p>Получается тоже самое, что с присоединением Новой Москвы: присоеденить то присоединили, а инфраструктуры там никакой, чтобы язык повернулся назвать это Москвой. Так что сначала надо создавать условия для выполнения закона, а потом его принимать. То есть сначала надо было бетонку сделать нормальной трассой, а потом такие законы принимать. Хорошо, что хоть штраф маленький, так что закон все равно действовать не будет. Хотя все таки может и будет. У нас же теперь за каждое правонарушение &ldquo;начисляют баллы&rdquo; на личное дело водителя. И если за год набралось более энного количества &ndash; лишают прав. Так что только это сможет остановить, а не трехсотрублевый штраф.</p>

<p>А новости у нас как всегда сильно разнятся:</p>

<p><img src="http://d.pr/i/sYaC+"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Удивительный спам]]></title>
    <link href="http://goooseman.ru/2013/03/04/udivitiel%27nyi-spam/"/>
    <updated>2013-03-04T20:44:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/04/udivitiel&#8217;nyi-spam</id>
    <content type="html"><![CDATA[<p>В последнее время приходит все меньше и меньше спама. Хвалить, наверное надо чудесные фильтры GMailа, который закидывает в папку &ldquo;Спам&rdquo; и много нужных писем. Но бывает такой спам, который просто удивляет изобретательностью своих авторов.</p>

<!-- more -->


<p>Приходит мне значит спам от неких IQ Elite, в котором мне сообщают, что меня ждет одно непрочитанное сообщение от моего друга.</p>

<p><img src="http://d.pr/i/8kB9+"></p>

<p>И даже не один раз.</p>

<p><img src="http://d.pr/i/8R91+"><br/>
<img src="http://d.pr/i/vagz+"></p>

<p>Фигня фигней, но в поле &ldquo;От&rdquo; указано имя &ldquo;Милантьева Надежда&rdquo;. И вот это то и удивительно. Все дело в том, что я действительно знаю одну Милантьеву Надежду, это подруга моей тещи. Но я никогда с ней не переписывался через email и не встречал в интернете вообще. Поэтому меня это крайне удивило. Загуглив, осознал, что этот IQ Elite действительно фишинговый сайт, на котором предлагают пройти некий IQ Test, а потом предлагают ввести логин и пароль от google аккаунта!</p>

<p><img src="http://d.pr/i/KSyr+">
<img src="http://d.pr/i/s8ku+">
<img src="http://d.pr/i/wckk+"></p>

<p>Получается, что люди отдают им свой логин и пароль мыла, те просто берут их контакт лист и отсылают такой же спам, только от лица жертвы. Таким образом, они собирают спам лист не просто действующих email адресов, а адреса живых людей, которые читают почту. Но откуда у меня у Надежды в контакт листе оказался мой email? Поискав по своему ящику, заметил, что теща присылала одно письмо, которое было адресовано не только мне, но и Надежде.</p>

<p><img src="http://d.pr/i/3hgm+"></p>

<p>Но самое странное, что в письме то написано, что пришло сообщение на этом сайте, а, когда открываешь сайт, никакого сообщения нету. Неужели это никого не смущает?</p>

<p>Остается только один вопрос: почему оно не попадает в спам и почему Google ничего не делает, не смотря на частые упоминания?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Пора валить в офлайн?]]></title>
    <link href="http://goooseman.ru/2013/03/04/pora-valit%27-v-oflain/"/>
    <updated>2013-03-04T16:29:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/04/pora-valit&#8217;-v-oflain</id>
    <content type="html"><![CDATA[<p>Раньше хакеры писали вирусы  и трояны, чтобы достать конфидециальные данные с машины пользователя. Но времена меняются, и теперь, чтобы украсть данные, можно не закидывать зараженный файл на компьютер, а взломать какой-нибудь крупный сервис, где кто-нибудь может держать свои секретные данные, и украсть не у одного, а у миллиона человек.</p>

<!-- more -->


<p>К чему я это? С утра захожу в <strong>Evernote</strong> на маке и вижу такую картину:</p>

<p><img src="http://d.pr/i/cgAA+"></p>

<p>Странно, подумал я, может ошибка сервера какая, всяко бывает. Оставив Evernote на потом, открываю Reeder и читаю о том, что Evernote взломан.</p>

<p><img src="http://d.pr/i/Veld+"></p>

<p>Пароль то поменял через &ldquo;Восстановление пароля&rdquo;, но пишу не об этом. Я не понимаю зачем взламывать Evernote. Представим ситуацию:</p>

<ul>
<li>Предположим я домохозяйка из небольшого подмосковного городка и пользуюсь Evernote.</li>
<li>Предположим у меня в Evernote лежит pin код от кредитки, на которой лежит миллион, номер паспорта, и адрес дома, под которым зарыт клад.</li>
<li>Предположим Evernote взломали. Угнали 1000000 аккаунтов, скопировав локально все данные с этих аккаунтов.</li>
<li>Предположим Вы &ndash; хакер. У вас есть данные миллиона аккаунтов. Фотки, мысли, бесполезная и полезная информация миллиона (или около того) людей.</li>
<li>Предположим Вам надо извлечь из этих данных что-то, из чего можно получить выгоду. Просматривать все в ручную никто не будет. Будут искать patternами. Скорей всего в первую очередь, будут искать номер кредитки с cvs и exp. date, emailы и пароли. Но неужели процент тех, кто в Evernote держит такие данные, больше 1%? А другие данные бесполезны. Как воспользоваться Вашей личной информацией, если неизвестно кто Вы и где живете. И даже если есть такая информация, скорей всего Вы где-то очень далеко. Да даже просто pin от карты бесполезен, только если чтобы составить статистику среди всех пользователей, какие pinы более распространены.</li>
</ul>


<p>Другое дело, что когда ломают таких крупных игроков как Evernote, становится неспокойно. Ведь тогда взломать могут и Dropbox, на котором у некоторых лежат данные 1Password, и даже могут расшифровать эти самые данные. Так что для паролей может и стоит поднять какой-нибудь свой маленький сервак, который конечно не так защищен, как Dropbox, зато на который уж точно никто не будет нападать. Или использовать Яндекс.Диск, вероятность нападения на который поменьше. Вот только синхронизацию настроить будет сложно.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Воспроизведение видео на нескольких мониторах под OS X]]></title>
    <link href="http://goooseman.ru/2013/03/03/vosproizviedieniie-vidieo-na-nieskol%27kikh-monitorakh-pod-os-x/"/>
    <updated>2013-03-03T13:08:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/03/vosproizviedieniie-vidieo-na-nieskol&#8217;kikh-monitorakh-pod-os-x</id>
    <content type="html"><![CDATA[<p>Была у меня работа: надо было сделать систему удаленной смены видеоконтента, показываемого на тв плазмах в бутике. Вроде бы все просто, вариантов реализации не мало. Но была еще одна задача: на сдвоенных плазмах нужно было реализовать показ одного видео на двух мониторах, то есть видео должны быть растянуто по ширине на двух мониторах, подключенных к одному Mac Mini. Как оказалось, существует не так много бесплатного софта для реализации video wall под OS X.</p>

<!-- more -->


<h2>VLC</h2>

<p>Для начала я попробовал <a href="http://www.videolan.org/vlc/">VLC</a>. У него лично для меня было два плюса: хорошая поддержка вызова из коммандной строки и поддержка video wall. Вот только во второй версии они этот самый video wall поломали, по этому я использовал версию 1.1.4. Забегая вперед, расскажу, что заставить работать нормально так и не вышло. <br/>
Запустить видео с поддержкой показа на двух мониторах, можно как настроив из GUI, так и добавив пару параметров при вызове из коммандной строки. Разницы абсолютно никакой, я сейчас расмотрю настройку из GUI.</p>

<ul>
<li>Настройки &ndash;> Показать все &ndash;> Видео  Отмечаем галочкой &ldquo;Полноэкранный вывод видео&rdquo;.</li>
<li>Видео &ndash;> Фильтры<br/>
Отмечаем галочкой Wall Video Filter.      <br/>
<img src="http://d.pr/i/jEfD+"></li>
<li>Видео &ndash;> Фильтры &ndash;> Стена из изображений<br/>
Указывем количество мониторов и другие настройки.   <br/>
<img src="http://d.pr/i/7U07+"></li>
</ul>


<p>И в первый раз у меня действительно это получилось. Открыл видео &ndash; оно в полноэкранном режиме растянуто на двух мониторах.<br/>
Но есть удивительный баг: если даже просто отключить монитор от Mac и обратно его подключить, все ломается. Открываешь видео, а отображается только левая его часть, и то на правом мониторе. Или вообще ничего не показывается. Как я только не менял настройки, помогло лишь удаление /Library/Preferences/com.apple.windowserver.plist и перезагрузка. Но это работает до тех пор, пока снова не отключишь монитор. Так что не наш выбор</p>

<h2>MPlayer</h2>

<p>У MPlayer есть интересный параметр: &mdash;xineramascreen. Он позволяет выбрать монитор на котором будет воспроизводится видео. То есть <code>mplayer --xineramascreen 0</code> Воспроизводить на первом мониторе, <code>mplayer --xineramascreen 1</code> &ndash; на правом. Но <code>mplayer --xineramascreen -2</code> должно воспроизводить на всех мониторах одновременно. Должно, но воспроизводит ровно так, как будто этого параметра нет. Гугл говорит о том, что оно так ни у кого не работает. Но я не сдавался: пробовал разные сборки mplayer: <a href="http://www.mplayerosx.ch/">MPlayer OSX Extended</a>, <a href="http://mplayerx.org/">MPlayerX</a>, <a href="http://www.mplayer2.org/">Mplayer2</a>, собирал с помощью Macports и Homebrew &ndash; ничто не смогло заработать так, как это нужно было.</p>

<h2>MSAQTPlayer</h2>

<p>И только после всех этих мучений я наткнулся на <a href="https://github.com/memo/MSAQTPlayer">MSAQTPlayer</a>. Маленькая программа, которая умеет только одно: воспроизводить видео одновременно на всех подключенных мониторах. Правда реализована она весьма странно: она воспроизводит видео, путь до которого прописан в ее preferences.plist, по другому (То есть через &ldquo;Открыть в программе&rdquo; из Finder или <code>open -a MSAQTPlayer /путь/до/файла")</code> никак видео она не открывает. Весьма странный подход. Настроек минимум: fullscreen, in front, autoplay и loop, но большего и не надо.</p>

<p><img src="http://d.pr/i/Llek+"></p>

<p>Работает просто прекрасно, пусть и написана в 2008ом году, использует обычный QuickTime. Только одна проблема: ибо путь к файлу у него в preferences.plist, а видео надо менять удаленно, пришлось делать генерацию этого самого preferences.plsit, в котором прописывается путь до нового файла на удаленной машине, которая копирует его с замной на место старого и выполняет <code>open -a MSAQTPlayer</code> через SSH.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Цой^W David Bowie жив]]></title>
    <link href="http://goooseman.ru/2013/03/02/tsoi-w-david-bowie-zhiv/"/>
    <updated>2013-03-02T04:03:00+04:00</updated>
    <id>http://goooseman.ru/2013/03/02/tsoi-w-david-bowie-zhiv</id>
    <content type="html"><![CDATA[<p>Давненько я не смотрел клипы. Да и всегда больше нравилось музыку слушать, а не смотреть. Но бывает клипы, которые хочется пересматривать и пересматривать, которые не похожи на всю ту попсовую муть, которой даже MTV в нашей стране перестал нас поливать, которые являются не просто кривлянием музыканта на камеру или красивой картинкой, которые рассказывают историю так, как ее не расскажет ни один фильм.</p>

<!-- more -->


<p>Как Вы уже поняли, я о двух новых клипах Davida Bowie, которые он выпустил перед премьерой своего нового альбома. Снятые разными режисерами, они оба просто великолепны. <br/>
Про берлинскую стену давно никто не пел, да и как то этот вопрос не актуален. До сих пор перед глазами финальные кадры <a href="http://www.imdb.com/title/tt0084503/">Pink Floyd &ndash; The Wall</a>, где дети собирают мусор на обломках стены, чтобы построить что то новое. Но в 2013 году я был удивлен увидеть клип на это тему, тем более такой удивительный. Пусть и последние несколько лет я слушаю только электронную музыку, но этот клип я готов пересматривать и пересматривать.</p>

<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/QWtsV50_-p4" frameborder="0" allowfullscreen></iframe>
</div>


<p>Второй же клип еще интересней. Он рассказывает нам о том, как обычным людям накручивается порочный образ жизни звезд. А как он прекрасно отснят&hellip; Сейчас так мало кто делает клипы. Ощущение такого олдскула, как будто его сняли лет так 10 назад. А эти театральные приемы&hellip; Ну почему так никто больше не снимает? Помнится у Дельфина есть красиво снятый <a href="http://www.youtube.com/watch?v=1KrlVXC9_7g">клип</a> с красивой моделью в главной роли. Вроде бы все хорошо, но с песней то он никак не связан, да и вообще сюжета нету, одни намеки на Толкиена. И получается, что клип только портит песню, ее намного интереснее слушать. А у Bowie здесть есть все: и красота, и смысл, и сюжет.</p>

<div class="video-container">
    <iframe width="640" height="360" src="http://www.youtube.com/embed/gH7dMBcg-gE" frameborder="0" allowfullscreen></iframe> 
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Настройка плагина Octopress для Sublime Text]]></title>
    <link href="http://goooseman.ru/2013/02/28/nastroika-plaghina-octopress-dlia-sublime-text/"/>
    <updated>2013-02-28T15:51:00+04:00</updated>
    <id>http://goooseman.ru/2013/02/28/nastroika-plaghina-octopress-dlia-sublime-text</id>
    <content type="html"><![CDATA[<p>Есть такой текстовой редактор Sublime Text, про который не писал только ленивый да домохозяйка. Описывать его прекрасные возможности я не собираюсь, а поговорю про <a href="https://github.com/blueplanet/sublime-text-2-octopress">Octopress Plugin</a> для него, а точнее как этот самый плагин заставить работать.</p>

<!-- more -->


<h2>Установка</h2>

<ul>
<li>Устанавливаем <a href="http://wbond.net/sublime_packages/package_control">Package Control</a>.</li>
<li>Жмем Shift+Cmd+P, начинаем вводить Install, выбираем &ldquo;Install Package&rdquo; и ставим Octopress.</li>
</ul>


<p><img src="http://d.pr/i/CRvF+"></p>

<h2>Настройка</h2>

<p>А теперь самое веселое. В OS X если приложение запускается из GUI, то она использует другие переменные среды, то есть файл .bashrc не грузится. Есть 2 решения проблемы: запускать Sublime Text 2 из command prompt или перед каждым выполнением комманд запускать &ldquo;source ~/.bashrc&rdquo;, как нам предлагает делать автор, создавший специальную переменную, которая задается в настройках &ldquo;octopress_cmd_before_rake&rdquo;. Первый вариант мы отметаем, хотя и можно создать маленькое приложение в Automator, мы легкие пути не ищем. Второй пункт, при всей своей кажущейся легкости, у многих просто так не работает, о чем свидетельствует <a href="https://github.com/blueplanet/sublime-text-2-octopress/issues/5">эта тема</a>, в которой так никто и не справился с этой проблемой. Но обо всем по порядку. Проблема наблюдается у пользователей OSX, которые используют rvm.</p>

<ul>
<li>Открываем Preferences->Package Settings->Octopress->Settings &ndash; User.</li>
<li>Можно скопировать все из Preferences->Package Settings->Octopress->Settings &ndash; Default, можно и копировать только то, что нужно изменить.</li>
<li>Задаем &ldquo;octopress_path&rdquo;.</li>
<li>Наконец приходим к &ldquo;octopress_cmd_before_rake&rdquo;. Как и советует автор, вставляем &ldquo;source ~/.bashrc&rdquo;. Нажимаем  Shift+Cmd+P и выбираем Octopress: Generate, если Вам повезет, то все пойдет как по маслу, иначе получите такую ошибку в консоли (Ctrl+`):</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake aborted!
</span><span class='line'>
</span><span class='line'>no such file to load -- bundler/setup
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>/Volumes/DATA/Users/goooseman/octopress/Rakefile:2
</span><span class='line'>(See full trace by running task with --trace)
</span><span class='line'>
</span><span class='line'>(in /Volumes/DATA/Users/goooseman/octopress)</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Проверяем свой .bashrc:<code>nano ~/.bashrc</code> мой выглядит так:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PATH=$PATH:$HOME/.rvm/bin # Add RVM to PATH for scripting</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Изменяем &ldquo;octopress_cmd_before_rake&rdquo; на &ldquo;source ~/.bashrc &amp;&amp; export GEM_HOME=~/.rvm/gems/ruby-1.9.3-p374&rdquo;, сохраняем, пробуем, проблема остается.</li>
<li>Теперь изменяем на &ldquo;source ~/.bashrc &amp;&amp; export GEM_HOME=~/.rvm/gems/ruby-1.9.3-p374 &amp;&amp; gem install bundler&rdquo;. Пробуем, проблема остается.</li>
<li>Изменяем на &ldquo;source ~/.bashrc &amp;&amp; export GEM_HOME=~/.rvm/gems/ruby-1.9.3-p374 &amp;&amp; bundle install&rdquo;. Пробуем, дело должно продвинуться дальше. Но ошибка все равно может вывалиться, только теперь касательно кодировки.</li>
<li>Убираем &ldquo;&amp;&amp; bundle install&rdquo;. Может все и заработает, но у меня вывалилась такая ошибка:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/Volumes/DATA/Users/goooseman/octopress/plugins/pagination.rb:73:in `pagination_enabled?'
</span><span class='line'>: 
</span><span class='line'>invalid byte sequence in US-ASCII (ArgumentError)
</span><span class='line'>
</span><span class='line'>  from /Volumes/DATA/Users/goooseman/octopress/plugins/pagination.rb:14:in `block in generate'
</span><span class='line'>
</span><span class='line'>  from /Volumes/DATA/Users/goooseman/octopress/plugins/pagination.rb:13:in `each'
</span><span class='line'>  from /Volumes/DATA/Users/goooseman/octopress/plugins/pagination.rb:13:in `generate'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/gems/jekyll-0.12.0/lib/jekyll/site.rb:190:in `block in generate'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/gems/jekyll-0.12.0/lib/jekyll/site.rb:189:in `each'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/gems/jekyll-0.12.0/lib/jekyll/site.rb:189:in `generate'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/gems/jekyll-0.12.0/lib/jekyll/site.rb:40:in `process'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/gems/jekyll-0.12.0/bin/jekyll:264:in `&lt;top (required)&gt;'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/bin/jekyll:19:in `load'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/bin/jekyll:19:in `&lt;main&gt;'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/bin/ruby_noexec_wrapper:14:in `eval'
</span><span class='line'>  from /Users/goooseman/.rvm/gems/ruby-1.9.3-p374/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'
</span><span class='line'>Configuration from /Volumes/DATA/Users/goooseman/octopress/_config.yml
</span><span class='line'>Building site: source -&gt; public
</span><span class='line'>YAML Exception reading 2013-02-26-dielaiem-skrinshot-pravil'no.markdown: invalid byte sequence in US-ASCII
</span><span class='line'>YAML Exception reading 2013-02-26-vosstanovlieniie-otdiel'nykh-failov-iz-bekapa-itunes.markdown: invalid byte sequence in US-ASCII
</span><span class='line'>YAML Exception reading index.markdown: invalid byte sequence in US-ASCII
</span><span class='line'>YAML Exception reading index.html: invalid byte sequence in US-ASCII
</span><span class='line'>YAML Exception reading index.html: invalid byte sequence in US-ASCII
</span><span class='line'>YAML Exception reading search.html: invalid byte sequence in US-ASCII</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Если такое вывалилось, то в &ldquo;octopress_cmd_before_rake&rdquo; добавляем &ldquo;&amp;&amp; export LANG=en_US.UTF-8 &amp;&amp; export LC_ALL=en_US.UTF-8&rdquo;. Сохраняем, проверяем, должно завершаться <code>Successfully generated site: source -&gt; public</code></li>
</ul>


<p><img src="http://d.pr/i/LrNt+"></p>

<p>P.S. <a href="https://github.com/blueplanet/sublime-text-2-octopress/issues/5#issuecomment-14481400">Здесь</a> пользователь <a href="https://github.com/skarfacegc">skarfacegc</a> подсказал еще один вариант:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"octopress_cmd_before_rake" : "source $HOME/.rvm/scripts/rvm && export PATH=$HOME/.rvm/bin:$PATH && export GEM_HOME=~/.rvm/gems/ruby-1.9.3-p374" </span></code></pre></td></tr></table></div></figure>


<h2>rbenv</h2>

<p>Если Вы используете rbenv, то Ваш <code>~/.bashrc</code> должен выглядеть так:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PATH="$HOME/.rbenv/versions/1.9.3-p194/bin:$PATH"</span></code></pre></td></tr></table></div></figure>


<p>А <code>octopress_cmd_before_rake</code> вот так: <code>source ~/.bashrc &amp;&amp; export LANG=en_US.UTF-8 &amp;&amp; export LC_ALL=en_US.UTF-8</code>.
В этом случае устанавливать снова зависимости мне не понадобилось.</p>

<h2>Другие возможные ошибки</h2>

<ul>
<li><code>git: command not found</code> <br/>
Если вы используете ~/.bashrc, то в конце значения параметра PATH вы не указали &ldquo;:$PATH&rdquo;, который нужен для подгурзки стандартных путей.</li>
<li></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/Users/&lt;user&gt;/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/pygments.rb-0.3.4/lib/pygments/popen.rb:377:in `header_to_json': Traceback (most recent call last): (MentosError) </span></code></pre></td></tr></table></div></figure>


<p>
Проблема в подсветке кода, в одной из записей или страниц кода не правильно вставлен код. Какой именно можно найти в этой строчке: <code>ClassNotFound: no lexer for alias 'PATH=$PATH:$HOME/.rvm/bin' found</code> Лучше всего знаки ` с самим кодом отделять переводом каретки.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Делаем скриншот правильно!]]></title>
    <link href="http://goooseman.ru/2013/02/26/dielaiem-skrinshot-pravil%27no/"/>
    <updated>2013-02-26T17:41:00+04:00</updated>
    <id>http://goooseman.ru/2013/02/26/dielaiem-skrinshot-pravil&#8217;no</id>
    <content type="html"><![CDATA[<p>Существует много сервисов, которые позволяют быстро сделать скриншот и выложить его в сеть. Но как же выбрать единственно нужный вам? Забегая вперед, скажу, что лично для меня идела нет, но можно допилить.</p>

<!-- more -->


<p>У всех людей цели разные, лично для меня этот сервис должен обладать следующим:</p>

<ul>
<li>Иметь нативный клиент под OS X.</li>
<li>Копировать в буфер не ссылку на свой сайт, а прямую ссылку на изображение</li>
<li>Уметь быстро делать снимок не только всего экрана, но и области и отдельного окна</li>
<li>Не оставлять после себя файлов</li>
</ul>


<p>Итак, вот программы, которые я успел потестить.</p>

<ul>
<li><p><a href="http://getcloudapp.com/">CloudApp</a><br/>
<img src="http://d.pr/i/kD2n+"><br/>
Сервис хорош, но сразу перейду к минусам. А он всего лишь-то один, но очень неприятный: он копирует ссылку на сайт, а не на само изображение. Конечно этим сейчас грешат все, да и это можно исправить, но раздражает такое отношение.</p></li>
<li><p><a href="http://tinygrab.com/">TinyGrab</a><br/>
<img src="http://d.pr/i/yNsN+"><br/>
Когда-то (В году эдак в 2009м) был действительно хорошим сервисом. Загружал на свой сайт скрин и давал direct link на него. Но как же его испоганили&hellip;. Это ж ужас&hellip;<br/>
Дело в том, что теперь он копирует ссылку на свой сайт, а не на изображение. Но это не самое страшное. Даже с этого сайта просто так ссылку не вытащишь.
ОК, благо есть аплоад на FTP. Настроил, залил, а вот ссылку он не дает. В корзину.</p></li>
<li><p><a href="https://droplr.com/">Droplr</a><br/>
<img src="http://d.pr/i/BXcN+"><br/>
Да, он также <strong>не</strong> копирует direct link, но(!) если добавить в конец адреса знак &ldquo;+&rdquo;, ссылка становится прямой. Например, вот ссылка, которая копируется в буфер:</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://d.pr/i/mFcE</span></code></pre></td></tr></table></div></figure>


<p>
Она ведет на сайт Droplr. А вот так:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://d.pr/i/mFcE+</span></code></pre></td></tr></table></div></figure>


<p>
Превращается в прямую ссылку. Разве не круто?<br/>
Теперь осталось только настроить так, чтоб в любой момент можно было сделать скрин как и всего экрана, так и области и окна, полученный скрин загрузился бы и сам удалился. Для этого мы будем использовать Automator.</p>

<ul>
<li>Открываем Automator и создаем новую службу.</li>
<li>В качестве входных данных указываем &ldquo;Нет входных данных&rdquo; &ldquo;в любой программе&rdquo;.</li>
<li>Добавляем действие &ldquo;Запустить shell-скрипт&rdquo;.</li>
</ul>


<p>Весь экран:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir -p ~/Desktop/tmp/Screenshot
</span><span class='line'>screencapture ~/Desktop/tmp/Screenshot/Screen.png
</span><span class='line'>open -a Droplr ~/Desktop/tmp/Screenshot/Screen.png
</span><span class='line'>sleep 5
</span><span class='line'>rm -r ~/Desktop/tmp</span></code></pre></td></tr></table></div></figure>


<p>Скриншот окна:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir -p ~/Desktop/tmp/Screenshot
</span><span class='line'>screencapture -w ~/Desktop/tmp/Screenshot/Screen.png
</span><span class='line'>open -a Droplr ~/Desktop/tmp/Screenshot/Screen.png
</span><span class='line'>sleep 5
</span><span class='line'>rm -r ~/Desktop/tmp</span></code></pre></td></tr></table></div></figure>


<p>Скриншот выбранной области:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir -p ~/Desktop/tmp/Screenshot
</span><span class='line'>screencapture -i ~/Desktop/tmp/Screenshot/Screen.png
</span><span class='line'>open -a Droplr ~/Desktop/tmp/Screenshot/Screen.png
</span><span class='line'>sleep 5
</span><span class='line'>rm -r ~/Desktop/tmp</span></code></pre></td></tr></table></div></figure>


<p>Подставив свой путь папки и изображения соответственно. sleep нужен для того, чтобы файл не удалился еще до заливки в Droplr. <br/>
<img src="http://d.pr/i/a7MJ+"></p>

<ul>
<li>Заходим в Настройки, Клавиатура, Службы и находим наши службы. Ставим на них горячие клавиши. Я поставил cmd+shift+[2,3,4] соответственно для окна, экрана, области.<br/>
<img src="http://d.pr/i/tui2+"></li>
</ul>


<p>И не забывайте ставить плюс в конце ссылки.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Восстановление отдельных файлов из бэкапа iTunes]]></title>
    <link href="http://goooseman.ru/2013/02/26/vosstanovlieniie-otdiel%27nykh-failov-iz-bekapa-itunes/"/>
    <updated>2013-02-26T16:15:00+04:00</updated>
    <id>http://goooseman.ru/2013/02/26/vosstanovlieniie-otdiel&#8217;nykh-failov-iz-bekapa-itunes</id>
    <content type="html"><![CDATA[<p>Так уж исторически сложилось, что я люблю ставить систему &ldquo;с чистого листа&rdquo;, а потом восстанавливаю данные по очереди. Да, это всегда долго, но иногда спасает от дальнейших неприятностях.<br/>
И вот, я наконец нашел время обновить iPad невесты до iOS 6. Забэкапив данные приложений через ssh, я решил сделать бэкап в iTunes на всякий пожарный. Восстановив на iOS 6 и почти все посстановив, я вдруг понял, что забыл забэкапить GarageBand, в котором невеста часто записывает песни, поэтому данные надо было востановить. Вроде бы задача простая, софта много, но все меняется, если некоторые файлы, которые нужно  восстановить, имеют в имени русские символы.</p>

<!-- more -->


<h2>Приложения для извлечения файлов из бэкапа iTunes под OS X:</h2>

<ul>
<li><a href="http://supercrazyawesome.com/">iPhone / iPod Touch Backup Extractor</a><br/>
Действительно хорошая программа, которая прекрасно справляется со своей задачей и не просит за это денег. Раньше только ей и пользовался. Но есть один минус: будучи разработанной парнем из Ванкувера, она не слыхала про кириллицу, поэтому он файлы, в именах которых содержаться кракозябры, он просто игнорит, а папки преврощает в то, что когда-то называли &ldquo;кракозябрами&rdquo;. Например (.band &ndash; это папка):</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>goooseman$ ls /Volumes/DATA/Users/goooseman/Desktop/Backup/com.apple.mobilegarageband/Library/Application\ Support/Documents 
</span><span class='line'>One moment .band
</span><span class='line'>The show.band
</span><span class='line'>Ð?Ð½Ð³ÐµÐ» Ñ?Ñ?Ð°Ð½Ð¸Ñ?ÐµÐ»Ñ?.band
</span><span class='line'>Ð?Ð°Ð»Ñ?Ñ?Ð¸Ð½Ð¾Ð³ÐµÐ½Ð½Ñ?Ð¸Ì?.band
</span><span class='line'>Ð?Ñ?ÐºÐ°Ñ? ÐºÑ?Ñ?Ð³.band
</span><span class='line'>Ð?Ñ?Ð¾Ð½Ð¸Ñ? Ð»Ñ?Ð±Ð²Ð¸.band
</span><span class='line'>Ð?Ñ?Ñ? Ñ?ÐµÐ±Ñ?.band
</span><span class='line'>Ð?Ð¾Ñ?Ð¼Ð¸Ñ?ÐµÑ?ÐºÐ¸Ð¸Ì? Ð±Ð»Ñ?Ð·.band </span></code></pre></td></tr></table></div></figure>


<p><img src="http://f.cl.ly/items/1D3d3d1o1V1Q2z2D203i/Screen%2026:2:2013.png"></p>

<p>Короче говоря, приложение идеально, но только если Вы уверены, что в нужных вам данных нет файлов, в названии которых присутсвуют русские буквы.</p>

<ul>
<li><a href="http://www.wondershare.com/data-recovery/iphone-data-recovery.html">Wondershare Dr.Fone</a><br/>
Даже говорить про него не хочу, ибо файлы приложений вообще доставить не умеет, а еще и денег хотят.</li>
</ul>


<p><img src="http://d.pr/i/Kg0d+"></p>

<ul>
<li><p><a href="http://www.iphonebackupextractor.com/">iPhone Backup Extractor</a><br/>
Название похоже, но программа совершенно другая. Интересно, что для OS X они предлагают запускать exe файл через Mono. ОК, но выглядит оно вот так:
<img src="http://f.cl.ly/items/0c1k3D1a093C36363j0T/3.png"><br/>
Под надписью &ldquo;Select Backup:&rdquo; должно быть dropdown меню, но именно под макосью его почему то нет, и программа просто выбирает последний бэкап. Поэтому, чтобы выбрать нужный мне бэкап, я просто перенес остальные бэкапы в другую папку. Уже потрясает.<br/>
Но снова же: в именах файлов любой русский символ он заменяет на &ldquo;_&rdquo;, то есть получается <code>_____ _________.band</code><br/>
Снова мимо тазика&hellip; Да еще и платная&hellip;  Да и не работает выбор бэкапа&hellip;</p></li>
<li><p><a href="http://www.icopybot.com/itunes-backup-manager.htm">iBackUpBot</a><br/>
В общем приложение хорошое, если бы не страшный дизайн и проблема, про которую я поговорю дальше, все было бы идеально. Оно быстрое, оно даже умеет показывать иконки и имена приложений. Но&hellip;<br/>
Я могу понять, почему программы не работают с русскими именами файлов, но то, почему эта программа извлекает файлы без путей, я понять не могу.
Правда все не так страшно. Ибо путь она прописывает в имени файла, заменяя &ldquo;/&rdquo; нижним подчеркиванеим.<br/>
Например, в папке приложения GarageBand есть папки Documents и Library, во второй же есть еще много папок и файлов. В самой программе все показывается весьма нормально:<br/>
<img src="http://f.cl.ly/items/2Q30242R1d16131r3j1s/4.png"><br/>
Но после распаковки:<br/>
<img src="http://f.cl.ly/items/2r0a1L0z0m2D1a2R103I/6.png"><br/>
Одно хорошо: русские имена распаковываются нормально. Но, в чем смысл такой распаковки без путей, я понять не могу. К счастью, все не сложно исправить. Вот пример имени файла:</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Library_Application Support_Documents_Ирония любви.band_Media_Audio Recorder#15</span></code></pre></td></tr></table></div></figure>


<p>То есть надо вместо &ldquo;_&rdquo; подставить &ldquo;/&rdquo;, и правильно их скопировать. В этом нам поможет маленький скрипт на Python. Приступаем:<br/>
1. Запускаем Automator, выбираем приложение. (Можно и службу, но зачем создавать лишнюю службу для одноразового действия?) Назвать можно iBackUpBotHelper.
2. Добавляем &ldquo;Утилиты=>Запустить shell-скрипт&rdquo;. В качестве shell выбираем /usr/bin/python, а ввод передаем как аргументы.
3. Добавляем скриптик:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import sys
</span><span class='line'>import shutil
</span><span class='line'>import os
</span><span class='line'>
</span><span class='line'>for f in sys.argv[1:]:
</span><span class='line'>  arr = f.split('_')
</span><span class='line'>  l = []
</span><span class='line'>  i = 0
</span><span class='line'>  for element in arr:
</span><span class='line'>      l.append(arr[i]+"/")
</span><span class='line'>      i = i + 1
</span><span class='line'>  dest = ''.join(l)
</span><span class='line'>  del(l[-1])
</span><span class='line'>  fol = ''.join(l)
</span><span class='line'>  dest = dest[:-1]
</span><span class='line'>  fol = fol[:-1]
</span><span class='line'>  mkdir = "mkdir -p \"" + fol + "\""
</span><span class='line'>  print mkdir
</span><span class='line'>  os.system(mkdir)
</span><span class='line'>  cp = "cp \"" + f + "\" \"" + dest + "\""
</span><span class='line'>  print cp
</span><span class='line'>  os.system(cp)</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Сохраняем и перетягиваем файлы на новое приложение.</li>
</ul>


<p>Почему я использовал mkdir и cp через os.system, а не родные средства питона? mkdir -p создает все дерево папок, то есть в случае <code>mkdir -p /tmp/test/temp</code> даже если папки /tmp/test или даже папки /tmp нету, создается все дерево папок. Ну а раз я уж начала создавать папки через os.system, то и скопирую через него же.</p>

<p>На выходе получаем:<br/>
<img src="http://f.cl.ly/items/361O0K2J1e1e232o381r/7.png"></p>

<p>Но все же, почему разрабы сделали экспорт через одно место, мне до сих пор очень непонятно.</p>
]]></content>
  </entry>
  
</feed>
